
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>3. Pandas data basics &#8212; Data analytics in accounting</title>
    
  <link rel="stylesheet" href="_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="_static/sphinx-book-theme.2d2078699c18a0efb88233928e1cf6ed.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.be0a4a0c39cd630af62a2fcf693f3f06.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="4. Pandas Data preprocessing" href="3_Pandas_data_preprocessing.html" />
    <link rel="prev" title="2. Introduction to Python" href="1_Intro_to_Python.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  <img src="_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Data analytics in accounting</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="book_intro.html">
   Introduction to data analytics in accounting
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Basic data analytics in accounting
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="0_installing_Python.html">
   1. Installing Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="1_Intro_to_Python.html">
   2. Introduction to Python
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   3. Pandas data basics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="3_Pandas_data_preprocessing.html">
   4. Pandas Data preprocessing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="4_Connecting_with_accounting_databases.html">
   5. Connecting with accounting databases
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="5_Visualisation_with_Python.html">
   6. Visualisations with Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="6_Basic_statistics_with_Python.html">
   7. Basic statistics with Python
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Machine learning in accounting
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="7_Introduction_to_ML_in_accounting.html">
   1. Introduction to Machine learning in accounting
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="8_Decision_making_in_accounting.html">
   2. Decision making with ML in accounting
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="9_Deep_learning_in_accounting.html">
   3. Deep learning in accounting
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="10_NLP_in_accounting.html">
   4. Introduction to natural language processing
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/2_Pandas_basics.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/2_Pandas_basics.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#standard-data-types">
   3.1. Standard data types
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#list">
     3.1.1. List
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#tuple">
     3.1.2. Tuple
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dict">
     3.1.3. Dict
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#set">
     3.1.4. Set
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#comprehensions">
     3.1.5. Comprehensions
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pandas-data-structures">
   3.2. Pandas data structures
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pandas-series">
     3.2.1. Pandas series
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dataframe">
     3.2.2. Dataframe
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#basic-pandas-functions">
   3.3. Basic Pandas functions
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="pandas-data-basics">
<h1><span class="section-number">3. </span>Pandas data basics<a class="headerlink" href="#pandas-data-basics" title="Permalink to this headline">¶</a></h1>
<p>We will mostly use Pandas dataframe as our data type. This and the next chapter will introduce the dataframe in detail. Pandas tries to pick up the best features of Numpy, spreadsheets and relational databases, and actually succeeds mostly in it. Pandas is an unbelievably powerful data manipulation tool.</p>
<p>Before we start exploring Pandas, it is good to understand how the standard data types in Python work. So, let’s begin with them.</p>
<div class="section" id="standard-data-types">
<h2><span class="section-number">3.1. </span>Standard data types<a class="headerlink" href="#standard-data-types" title="Permalink to this headline">¶</a></h2>
<div class="section" id="list">
<h3><span class="section-number">3.1.1. </span>List<a class="headerlink" href="#list" title="Permalink to this headline">¶</a></h3>
<p>A list is probably the most used data type in Python. It is a variable-length collection of items. A list can be defined in Python using either square brackets or the <strong>list</strong> function. Lists in Python are mutable. You can change the values of a list afterwards.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">example_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;three&#39;</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">example_list</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;three&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">example_list</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">example_list</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1, 2, 3, 4]
</pre></div>
</div>
</div>
</div>
<p>You can add a new element to the end of the list with <strong>append()</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">example_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">example_list</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1, 2, 3, 4, 5]
</pre></div>
</div>
</div>
</div>
<p>You can also add an item to a specific location in the list using <strong>insert()</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">example_list</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mf">3.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">example_list</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1, 2, 3, 3.5, 4, 5]
</pre></div>
</div>
</div>
</div>
<p>With <strong>pop()</strong> you can remove items from the list.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">example_list</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.5
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">example_list</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1, 2, 3, 4, 5]
</pre></div>
</div>
</div>
</div>
<p>You can remove a specific item from the list using <strong>remove()</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">example_list</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">example_list</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1, 2, 4, 5]
</pre></div>
</div>
</div>
</div>
<p>Lists are commonly used to acquire items from generators. Here is an example:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">small_gen</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span> <span class="c1"># a generator</span>
<span class="n">list_of_gen</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">small_gen</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">list_of_gen</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0, 1, 4, 9, 16, 25, 36, 49, 64, 81]
</pre></div>
</div>
</div>
</div>
<p>You can check if an item is or is not in the list with <strong>in</strong> and <strong>is not</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">16</span> <span class="ow">in</span> <span class="n">list_of_gen</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">17</span> <span class="ow">in</span> <span class="n">list_of_gen</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>False
</pre></div>
</div>
</div>
</div>
<p>With <strong>+</strong> you can combine lists.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">example_list</span> <span class="o">+</span> <span class="n">example_list</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1, 2, 4, 5, 1, 2, 4, 5]
</pre></div>
</div>
</div>
</div>
<p>You can extend a list with multiple elements with <strong>extend</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">example_list</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">example_list</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1, 2, 4, 5, 6, 7, 8]
</pre></div>
</div>
</div>
</div>
<p>You can use <strong>sort()</strong> to sort a list. It organises the original list. Pandas, in contrary, creates a new object in this kind of operations.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">unsorted_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">unsorted_list</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">unsorted_list</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2, 3, 4, 6, 7, 8]
</pre></div>
</div>
</div>
</div>
<p>Slicing is an important concept in Python. The sections of most sequency types can be selected with slice notation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">small_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">small_list</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1, 2]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">small_list</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0, 1, 2]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">small_list</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0, 1, 2]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">small_list</span><span class="p">[</span><span class="mi">3</span><span class="p">:]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[3, 4, 5, 6, 7, 8, 9]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">small_list</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">:]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[7, 8, 9]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">small_list</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">:</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[5, 6]
</pre></div>
</div>
</div>
</div>
<p><strong>Step</strong> can be used to define the frequency of slicing.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">small_list</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0, 2, 4, 6, 8]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">small_list</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">8</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1, 3, 5, 7]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">small_list</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[9, 8, 7, 6, 5, 4, 3, 2, 1, 0]
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="tuple">
<h3><span class="section-number">3.1.2. </span>Tuple<a class="headerlink" href="#tuple" title="Permalink to this headline">¶</a></h3>
<p>A tuple is an immutable sequence of Python objects. Because it is immutable, it has also a fixed length. You can create tuples using parantheses.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">small_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">40</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">small_tuple</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(10, 20, 30, 40)
</pre></div>
</div>
</div>
</div>
<p>Otherwise, tuples are very similar to lists in Python. For example, you can access elements with square brackets.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">small_tuple</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>30
</pre></div>
</div>
</div>
</div>
<p>And you can concatenate them using <strong>+</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">small_tuple</span> <span class="o">+</span> <span class="n">small_tuple</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(10, 20, 30, 40, 10, 20, 30, 40)
</pre></div>
</div>
</div>
</div>
<p>But, they are immutable. You can not change values in them.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">small_tuple</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">35</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">TypeError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">37</span><span class="o">-</span><span class="mi">19</span><span class="n">b2de519515</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">small_tuple</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">35</span>

<span class="ne">TypeError</span>: &#39;tuple&#39; object does not support item assignment
</pre></div>
</div>
</div>
</div>
<p>Python will automatically unpack the tuple, if it is fed to a collection of variables (remember how a function returns a tuple).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">d</span> <span class="o">=</span> <span class="n">small_tuple</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>10
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>20
</pre></div>
</div>
</div>
</div>
<p>Because a tuple is immutable, there are not many tuple methods. One useful is <strong>count</strong>, which counts the occurrences of a value.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">small_tuple</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="mi">40</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="dict">
<h3><span class="section-number">3.1.3. </span>Dict<a class="headerlink" href="#dict" title="Permalink to this headline">¶</a></h3>
<p><strong>Dict</strong> is the most complicated built-in data type in Python. It is a mutable collection of key-value pairs of Python objects. Dicts are created using curly braces.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">500</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span> <span class="p">:</span> <span class="mi">1000</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span> <span class="p">:</span> <span class="mi">1500</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">2000</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<p>You can access and add elements of a dict using brackes with a key inside them.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample_dict</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>500
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample_dict</span><span class="p">[</span><span class="s1">&#39;e&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2500</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample_dict</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;a&#39;: 500, &#39;b&#39;: 1000, &#39;c&#39;: 1500, &#39;d&#39;: 2000, &#39;e&#39;: 2500}
</pre></div>
</div>
</div>
</div>
<p>There is no restrction that the keys should be strings and the values should be numbers.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample_dict</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;some_text&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample_dict</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;a&#39;: 500, &#39;b&#39;: 1000, &#39;c&#39;: 1500, &#39;d&#39;: 2000, &#39;e&#39;: 2500, 6: &#39;some_text&#39;}
</pre></div>
</div>
</div>
</div>
<p>You can delete an item from a dict using <strong>del</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">del</span> <span class="n">sample_dict</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample_dict</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;a&#39;: 500, &#39;b&#39;: 1000, &#39;c&#39;: 1500, &#39;d&#39;: 2000, &#39;e&#39;: 2500}
</pre></div>
</div>
</div>
</div>
<p>The <strong>keys</strong> and <strong>values</strong> methods can be used to get iterators of the dict’s keys and values. (Remember that the list method was commonly used to extract the contents of an iterator.)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">list</span><span class="p">(</span><span class="n">sample_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;, &#39;e&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">list</span><span class="p">(</span><span class="n">sample_dict</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[500, 1000, 1500, 2000, 2500]
</pre></div>
</div>
</div>
</div>
<p>You can merge two dictionaries with <strong>update</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample_dict</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;f&#39;</span><span class="p">:</span><span class="mi">3000</span><span class="p">,</span><span class="s1">&#39;g&#39;</span><span class="p">:</span><span class="mi">3500</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample_dict</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;a&#39;: 500, &#39;b&#39;: 1000, &#39;c&#39;: 1500, &#39;d&#39;: 2000, &#39;e&#39;: 2500, &#39;f&#39;: 3000, &#39;g&#39;: 3500}
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="set">
<h3><span class="section-number">3.1.4. </span>Set<a class="headerlink" href="#set" title="Permalink to this headline">¶</a></h3>
<p>A set in Python is a collection of unique elements. They can be created with <strong>set</strong> or with curly braces.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">set</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{5, 6, 7, 8}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{4, 5, 6, 7}
</pre></div>
</div>
</div>
</div>
<p>A Python set is very similar to a mathematical set, so it has methods for mathematical set operations.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="p">{</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">}</span>
<span class="n">y</span> <span class="o">=</span> <span class="p">{</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{3, 4, 5, 6, 7, 8, 9, 10}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{6, 7, 8}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{3, 4, 5}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="o">.</span><span class="n">symmetric_difference</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{3, 4, 5, 9, 10}
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="comprehensions">
<h3><span class="section-number">3.1.5. </span>Comprehensions<a class="headerlink" href="#comprehensions" title="Permalink to this headline">¶</a></h3>
<p>Comprehensions, especially the list ones, are a great feature in Python. With them, you can efficiently create collections with a single statement. Let’s look some examples. (<strong>%</strong> is the module operator)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">squares</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="k">if</span> <span class="n">x</span><span class="o">%</span><span class="k">2</span>==0]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">squares</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0, 4, 16, 36, 64]
</pre></div>
</div>
</div>
</div>
<p>You could do exactly the same with a much longer for loop.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">squares</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">x</span><span class="o">%</span><span class="k">2</span>==0:
        <span class="n">squares</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">squares</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0, 4, 16, 36, 64]
</pre></div>
</div>
</div>
</div>
<p>Here is another example:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fd</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;quotes.txt&#39;</span><span class="p">,</span><span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">text</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span> <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">fd</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">text</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">50</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;“JAVA IS, IN MANY WAYS, C++–.”(MICHAEL FELDMAN)&#39;,
 &#39;EVERYTHING CAN BE IMPROVED.  ~CLARENCE W. BARRON&#39;,
 &quot;DON&#39;T WATER YOUR WEEDS.  ~HARVEY MACKAY&quot;,
 &#39;&quot;NECESSITY IS THE MOTHER OF INVENTION&quot; - PLATO&#39;,
 &#39;&quot;INFORMATION IS NOT KNOWLEDGE.&quot; ALBERT EINSTEIN&#39;,
 &#39;DELETED CODE IS DEBUGGED CODE.  — JEFF SICKEL&#39;,
 &#39;THE BEST CODE IS NO CODE AT ALL.&#39;,
 &#39;NO CODE IS FASTER THAN NO CODE.  — MERB MOTTO&#39;]
</pre></div>
</div>
</div>
</div>
<p>Python also has set and dict comprehensions that work similarly. Here is an example. First, we set our stream position to the beginning</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fd</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
</div>
</div>
<p>The following command creates a dict where the keys are the first five letters of each quote and the values are the lengths of the quotes (if the quote is less than 50 characters long).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span> <span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">fd</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">50</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;“Java&#39;: 48,
 &#39;Every&#39;: 49,
 &quot;Don&#39;t&quot;: 40,
 &#39;&quot;Nece&#39;: 47,
 &#39;&quot;Info&#39;: 48,
 &#39;Delet&#39;: 46,
 &#39;The b&#39;: 33,
 &#39;No co&#39;: 46}
</pre></div>
</div>
</div>
</div>
<p>Nested list comprehensions are useful, but somewhat difficult to grasp. Let’s look some examples.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fd</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
</div>
</div>
<p>In the following, we split the quotes to a list of words, creating a list of lists</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">quotes</span> <span class="o">=</span> <span class="p">[</span><span class="n">quote</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">quote</span> <span class="ow">in</span> <span class="n">fd</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">quote</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">45</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">quotes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[&quot;Don&#39;t&quot;, &#39;water&#39;, &#39;your&#39;, &#39;weeds.&#39;, &#39;&#39;, &#39;~Harvey&#39;, &#39;MacKay&#39;],
 [&#39;The&#39;, &#39;best&#39;, &#39;code&#39;, &#39;is&#39;, &#39;no&#39;, &#39;code&#39;, &#39;at&#39;, &#39;all.&#39;]]
</pre></div>
</div>
</div>
</div>
<p>Using a nested list comprehension, we can now collect individual words to a list.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">word</span> <span class="k">for</span> <span class="n">quote</span> <span class="ow">in</span> <span class="n">quotes</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">quote</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&quot;Don&#39;t&quot;,
 &#39;water&#39;,
 &#39;your&#39;,
 &#39;weeds.&#39;,
 &#39;&#39;,
 &#39;~Harvey&#39;,
 &#39;MacKay&#39;,
 &#39;The&#39;,
 &#39;best&#39;,
 &#39;code&#39;,
 &#39;is&#39;,
 &#39;no&#39;,
 &#39;code&#39;,
 &#39;at&#39;,
 &#39;all.&#39;]
</pre></div>
</div>
</div>
</div>
<p>Always remember to close the file.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fd</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="pandas-data-structures">
<h2><span class="section-number">3.2. </span>Pandas data structures<a class="headerlink" href="#pandas-data-structures" title="Permalink to this headline">¶</a></h2>
<p>Two main data structures of Pandas are <strong>Series</strong> and <strong>Dataframe</strong>. Let’s analys both of them.</p>
<div class="section" id="pandas-series">
<h3><span class="section-number">3.2.1. </span>Pandas series<a class="headerlink" href="#pandas-series" title="Permalink to this headline">¶</a></h3>
<p>Let’s start by importing Pandas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
</div>
</div>
<p>A pandas series is a one-dimensional array of Numpy-type objects, and an associated array of labels, called <strong>index</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">first_pandas</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">first_pandas</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    5
1    3
2    7
3    3
4    7
5    1
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>If we do not pass an index when defining a series, it will be given the default index of sequential values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">first_pandas</span><span class="o">.</span><span class="n">index</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>RangeIndex(start=0, stop=6, step=1)
</pre></div>
</div>
</div>
</div>
<p>You can define a custom index when creating a series.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">second_pandas</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;first&#39;</span><span class="p">,</span><span class="s1">&#39;second&#39;</span><span class="p">,</span><span class="s1">&#39;third&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">second_pandas</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>first     1
second    2
third     3
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>A pandas series works like a dict. You can use the index value to pick up a single item.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">second_pandas</span><span class="p">[</span><span class="s1">&#39;second&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2
</pre></div>
</div>
</div>
</div>
<p>You can also use boolean indexing. Notice how the following command picks up the values on index locations 0, 2 and 4.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">first_pandas</span><span class="p">[</span><span class="n">first_pandas</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    5
2    7
4    7
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>You can use Numpy operations to your Pandas series.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">first_pandas</span><span class="o">*</span><span class="mi">2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    10
1     6
2    14
3     6
4    14
5     2
dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">first_pandas</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    1.609438
1    1.098612
2    1.945910
3    1.098612
4    1.945910
5    0.000000
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>As you have noticed, Pandas Series is very similar to a Python dict. Actually, you can very easily create a Pandas series from a dict.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">500</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span> <span class="p">:</span> <span class="mi">1000</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span> <span class="p">:</span> <span class="mi">1500</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">2000</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample_series</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">sample_dict</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample_series</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>a     500
b    1000
c    1500
d    2000
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Important feature in Pandas is that everything is aligned by the index.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample_series2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span><span class="mi">200</span><span class="p">,</span><span class="mi">300</span><span class="p">,</span><span class="mi">400</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample_series</span> <span class="o">+</span> <span class="n">sample_series2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>a     700
b    1400
c    1600
d    2300
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>If you look carefully, you can see that the summing was done “index-wise”.</p>
<p>You can give a name to the values and index of your Series.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample_series</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;some_values&#39;</span>
<span class="n">sample_series</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;some_letters&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample_series</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>some_letters
a     500
b    1000
c    1500
d    2000
Name: some_values, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>You can also change your index values very easily.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample_series</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;aa&#39;</span><span class="p">,</span><span class="s1">&#39;bb&#39;</span><span class="p">,</span><span class="s1">&#39;cc&#39;</span><span class="p">,</span><span class="s1">&#39;dd&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample_series</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>aa     500
bb    1000
cc    1500
dd    2000
Name: some_values, dtype: int64
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="dataframe">
<h3><span class="section-number">3.2.2. </span>Dataframe<a class="headerlink" href="#dataframe" title="Permalink to this headline">¶</a></h3>
<p>Pandas Dataframe is a rectangular table of objects with similar features as Pandas Series. Each column can have different type of values. In a way, it is a 2-dimensional extension of Pandas Series. For example, it has both a row and a column index.</p>
<p>A dataframe can be constucted in many ways. One popular option is to use a dict of equal-length lists.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">company_data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;year&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;2015&#39;</span><span class="p">,</span><span class="s1">&#39;2016&#39;</span><span class="p">,</span><span class="s1">&#39;2017&#39;</span><span class="p">,</span><span class="s1">&#39;2018&#39;</span><span class="p">,</span><span class="s1">&#39;2019&#39;</span><span class="p">,</span><span class="s1">&#39;2020&#39;</span><span class="p">],</span>
                <span class="s1">&#39;sales&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">102000</span><span class="p">,</span> <span class="mi">101000</span><span class="p">,</span> <span class="mi">105000</span><span class="p">,</span> <span class="mi">115000</span><span class="p">,</span> <span class="mi">111000</span><span class="p">,</span> <span class="mi">109000</span><span class="p">],</span>
               <span class="s1">&#39;profit&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">5000</span><span class="p">,</span> <span class="mi">6000</span><span class="p">,</span> <span class="mi">8000</span><span class="p">,</span> <span class="mi">7000</span><span class="p">,</span> <span class="mi">9000</span><span class="p">,</span> <span class="mi">3000</span><span class="p">]}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">company_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">company_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">company_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>year</th>
      <th>sales</th>
      <th>profit</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2015</td>
      <td>102000</td>
      <td>5000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2016</td>
      <td>101000</td>
      <td>6000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2017</td>
      <td>105000</td>
      <td>8000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2018</td>
      <td>115000</td>
      <td>7000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2019</td>
      <td>111000</td>
      <td>9000</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2020</td>
      <td>109000</td>
      <td>3000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>You can define the order of columns when creating a dataframe.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">company_data</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">,</span><span class="s1">&#39;profit&#39;</span><span class="p">,</span><span class="s1">&#39;sales&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>year</th>
      <th>profit</th>
      <th>sales</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2015</td>
      <td>5000</td>
      <td>102000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2016</td>
      <td>6000</td>
      <td>101000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2017</td>
      <td>8000</td>
      <td>105000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2018</td>
      <td>7000</td>
      <td>115000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2019</td>
      <td>9000</td>
      <td>111000</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2020</td>
      <td>3000</td>
      <td>109000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>If you add a column to the list that is not included in the dict, it will be added to the dataframe with missing values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">company_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">company_data</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">,</span><span class="s1">&#39;sales&#39;</span><span class="p">,</span><span class="s1">&#39;profit&#39;</span><span class="p">,</span><span class="s1">&#39;total_assets&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">company_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>year</th>
      <th>sales</th>
      <th>profit</th>
      <th>total_assets</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2015</td>
      <td>102000</td>
      <td>5000</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2016</td>
      <td>101000</td>
      <td>6000</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2017</td>
      <td>105000</td>
      <td>8000</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2018</td>
      <td>115000</td>
      <td>7000</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2019</td>
      <td>111000</td>
      <td>9000</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2020</td>
      <td>109000</td>
      <td>3000</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>You can pick up one column from a dataframe using the usual bracket-notation. It will return the column as a Pandas series.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">company_df</span><span class="p">[</span><span class="s1">&#39;profit&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    5000
1    6000
2    8000
3    7000
4    9000
5    3000
Name: profit, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Value assignment to a dataframe is easy. You can either add one value that is repeated in every instance of a column.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">company_df</span><span class="p">[</span><span class="s1">&#39;total_assets&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">105000</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">company_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>year</th>
      <th>sales</th>
      <th>profit</th>
      <th>total_assets</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2015</td>
      <td>102000</td>
      <td>5000</td>
      <td>105000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2016</td>
      <td>101000</td>
      <td>6000</td>
      <td>105000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2017</td>
      <td>105000</td>
      <td>8000</td>
      <td>105000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2018</td>
      <td>115000</td>
      <td>7000</td>
      <td>105000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2019</td>
      <td>111000</td>
      <td>9000</td>
      <td>105000</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2020</td>
      <td>109000</td>
      <td>3000</td>
      <td>105000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Or you can add a full list of values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">company_df</span><span class="p">[</span><span class="s1">&#39;total_assets&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">105000</span><span class="p">,</span><span class="mi">120000</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">company_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>year</th>
      <th>sales</th>
      <th>profit</th>
      <th>total_assets</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2015</td>
      <td>102000</td>
      <td>5000</td>
      <td>109004</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2016</td>
      <td>101000</td>
      <td>6000</td>
      <td>109098</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2017</td>
      <td>105000</td>
      <td>8000</td>
      <td>108761</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2018</td>
      <td>115000</td>
      <td>7000</td>
      <td>113786</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2019</td>
      <td>111000</td>
      <td>9000</td>
      <td>108386</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2020</td>
      <td>109000</td>
      <td>3000</td>
      <td>112777</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Remember that if you add a Pandas series to a datarame, the values will be matched according to their index values!  For missing index values, a NaN-value will be added.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">debt_sr</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">9000</span><span class="p">,</span><span class="mi">6000</span><span class="p">,</span><span class="mi">8000</span><span class="p">,</span><span class="mi">10000</span><span class="p">],</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">debt_sr</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2     9000
0     6000
5     8000
3    10000
dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">company_df</span><span class="p">[</span><span class="s1">&#39;debt&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">debt_sr</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">company_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>year</th>
      <th>sales</th>
      <th>profit</th>
      <th>total_assets</th>
      <th>debt</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2015</td>
      <td>102000</td>
      <td>5000</td>
      <td>109004</td>
      <td>6000.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2016</td>
      <td>101000</td>
      <td>6000</td>
      <td>109098</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2017</td>
      <td>105000</td>
      <td>8000</td>
      <td>108761</td>
      <td>9000.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2018</td>
      <td>115000</td>
      <td>7000</td>
      <td>113786</td>
      <td>10000.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2019</td>
      <td>111000</td>
      <td>9000</td>
      <td>108386</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2020</td>
      <td>109000</td>
      <td>3000</td>
      <td>112777</td>
      <td>8000.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>There are many ways to remove columns. One option is to use <strong>del</strong> that works also with other Python data types.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">del</span> <span class="n">company_df</span><span class="p">[</span><span class="s1">&#39;debt&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">company_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>year</th>
      <th>sales</th>
      <th>profit</th>
      <th>total_assets</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2015</td>
      <td>102000</td>
      <td>5000</td>
      <td>109004</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2016</td>
      <td>101000</td>
      <td>6000</td>
      <td>109098</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2017</td>
      <td>105000</td>
      <td>8000</td>
      <td>108761</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2018</td>
      <td>115000</td>
      <td>7000</td>
      <td>113786</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2019</td>
      <td>111000</td>
      <td>9000</td>
      <td>108386</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2020</td>
      <td>109000</td>
      <td>3000</td>
      <td>112777</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>A dict of dicts can also by used to create a dataframe. The keys of the outer dict are the columns and the keys of the inner dict are the index values. (Btw., In real applications we are not “writing” our data. Almost always we load the data from a file, using for example, Pandas <strong>read_csv()</strong>. So, do not worry.)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">company_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;company a&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">2010</span><span class="p">:</span> <span class="mf">10.9</span><span class="p">,</span> <span class="mi">2011</span><span class="p">:</span> <span class="mf">8.7</span><span class="p">,</span> <span class="mi">2012</span><span class="p">:</span> <span class="mf">9.5</span><span class="p">},</span><span class="s1">&#39;company b&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">2010</span><span class="p">:</span> <span class="mf">11.2</span><span class="p">,</span> <span class="mi">2011</span><span class="p">:</span> <span class="mf">9.6</span><span class="p">,</span> <span class="mi">2012</span><span class="p">:</span> <span class="mf">8.8</span><span class="p">}}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">new_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">company_dict</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">new_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>company a</th>
      <th>company b</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2010</th>
      <td>10.9</td>
      <td>11.2</td>
    </tr>
    <tr>
      <th>2011</th>
      <td>8.7</td>
      <td>9.6</td>
    </tr>
    <tr>
      <th>2012</th>
      <td>9.5</td>
      <td>8.8</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Transposing data is done in the same way as in Numpy, just by adding <strong>.T</strong> after the name of the dataframe.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">new_df</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>2010</th>
      <th>2011</th>
      <th>2012</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>company a</th>
      <td>10.9</td>
      <td>8.7</td>
      <td>9.5</td>
    </tr>
    <tr>
      <th>company b</th>
      <td>11.2</td>
      <td>9.6</td>
      <td>8.8</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>There are still many other ways to construct a dataframe, and we will use some of them in the following chapters. A detailed introduction to constructing a dataframe can be found here: <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/user_guide/dsintro.html">pandas.pydata.org/pandas-docs/stable/user_guide/dsintro.html</a></p>
<p>There is actually a third data type in Pandas, <strong>Index objects</strong>. They are used to hold the labels of columns and index of a dataframe or series. A Pandas <strong>index</strong> is immutable and has similiraties with Python sets. However, the Pandas <strong>index</strong> can contain duplicate items.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">new_df</span><span class="o">.</span><span class="n">index</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Int64Index([2010, 2011, 2012], dtype=&#39;int64&#39;)
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="basic-pandas-functions">
<h2><span class="section-number">3.3. </span>Basic Pandas functions<a class="headerlink" href="#basic-pandas-functions" title="Permalink to this headline">¶</a></h2>
<p>Let’s use a more realistic data for the following examples.( More about <strong>read_csv()</strong> in the later chapters.)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">big_companies_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;big_companies.csv&#39;</span><span class="p">,</span><span class="n">index_col</span><span class="o">=</span><span class="s1">&#39;NAME&#39;</span><span class="p">,</span><span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">big_companies_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>DIVIDEND YIELD</th>
      <th>CASH FLOW/SALES</th>
      <th>RETURN ON EQUITY - TOTAL (%)</th>
      <th>RETURN ON INVESTED CAPITAL</th>
      <th>P/E - RATIO</th>
      <th>TOTAL DEBT % COMMON EQUITY</th>
    </tr>
    <tr>
      <th>NAME</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>APPLE</th>
      <td>0.71</td>
      <td>28.01</td>
      <td>55.92</td>
      <td>27.65</td>
      <td>35.4</td>
      <td>119.40</td>
    </tr>
    <tr>
      <th>SAUDI ARABIAN OIL</th>
      <td>0.21</td>
      <td>31.73</td>
      <td>32.25</td>
      <td>28.34</td>
      <td>29.5</td>
      <td>16.96</td>
    </tr>
    <tr>
      <th>MICROSOFT</th>
      <td>1.06</td>
      <td>43.46</td>
      <td>40.14</td>
      <td>24.89</td>
      <td>36.5</td>
      <td>61.56</td>
    </tr>
    <tr>
      <th>AMAZON.COM</th>
      <td>0.00</td>
      <td>14.60</td>
      <td>21.95</td>
      <td>12.97</td>
      <td>121.1</td>
      <td>83.31</td>
    </tr>
    <tr>
      <th>ALIBABA GROUP HOLDING ADR 1:8</th>
      <td>0.00</td>
      <td>31.23</td>
      <td>23.77</td>
      <td>17.39</td>
      <td>31.0</td>
      <td>16.60</td>
    </tr>
    <tr>
      <th>FACEBOOK CLASS A</th>
      <td>0.00</td>
      <td>41.11</td>
      <td>19.96</td>
      <td>19.94</td>
      <td>32.0</td>
      <td>0.47</td>
    </tr>
    <tr>
      <th>TENCENT HOLDINGS</th>
      <td>0.23</td>
      <td>35.55</td>
      <td>24.68</td>
      <td>15.92</td>
      <td>42.6</td>
      <td>53.74</td>
    </tr>
    <tr>
      <th>ALPHABET A</th>
      <td>0.00</td>
      <td>33.18</td>
      <td>18.12</td>
      <td>17.76</td>
      <td>33.2</td>
      <td>2.26</td>
    </tr>
    <tr>
      <th>TESLA</th>
      <td>0.00</td>
      <td>11.21</td>
      <td>-14.94</td>
      <td>-1.61</td>
      <td>1036.3</td>
      <td>202.77</td>
    </tr>
    <tr>
      <th>WALMART</th>
      <td>1.54</td>
      <td>4.88</td>
      <td>20.22</td>
      <td>12.55</td>
      <td>26.6</td>
      <td>72.95</td>
    </tr>
    <tr>
      <th>JOHNSON &amp; JOHNSON</th>
      <td>2.71</td>
      <td>23.83</td>
      <td>25.36</td>
      <td>17.38</td>
      <td>26.7</td>
      <td>46.57</td>
    </tr>
    <tr>
      <th>TAIWAN SEMICON.MNFG.</th>
      <td>2.31</td>
      <td>57.91</td>
      <td>20.94</td>
      <td>18.96</td>
      <td>24.7</td>
      <td>11.89</td>
    </tr>
    <tr>
      <th>NESTLE 'N'</th>
      <td>2.47</td>
      <td>16.85</td>
      <td>23.05</td>
      <td>14.21</td>
      <td>23.3</td>
      <td>71.42</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>With <strong>reindex()</strong>, you can rearrange the values of the dataframe. Let’s load Numpy.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
<p>The following command shuffles the order of the index values (company names).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">random_order</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span><span class="n">big_companies_df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">random_order</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;MICROSOFT&#39;, &#39;APPLE&#39;, &#39;WALMART&#39;, &#39;ALPHABET A&#39;, &quot;NESTLE &#39;N&#39;&quot;,
       &#39;TESLA&#39;, &#39;SAUDI ARABIAN OIL&#39;, &#39;TAIWAN SEMICON.MNFG.&#39;,
       &#39;JOHNSON &amp; JOHNSON&#39;, &#39;TENCENT HOLDINGS&#39;, &#39;AMAZON.COM&#39;,
       &#39;FACEBOOK CLASS A&#39;, &#39;ALIBABA GROUP HOLDING ADR 1:8&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">big_companies_df</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">index</span> <span class="o">=</span> <span class="n">random_order</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>DIVIDEND YIELD</th>
      <th>CASH FLOW/SALES</th>
      <th>RETURN ON EQUITY - TOTAL (%)</th>
      <th>RETURN ON INVESTED CAPITAL</th>
      <th>P/E - RATIO</th>
      <th>TOTAL DEBT % COMMON EQUITY</th>
    </tr>
    <tr>
      <th>NAME</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>MICROSOFT</th>
      <td>1.06</td>
      <td>43.46</td>
      <td>40.14</td>
      <td>24.89</td>
      <td>36.5</td>
      <td>61.56</td>
    </tr>
    <tr>
      <th>APPLE</th>
      <td>0.71</td>
      <td>28.01</td>
      <td>55.92</td>
      <td>27.65</td>
      <td>35.4</td>
      <td>119.40</td>
    </tr>
    <tr>
      <th>WALMART</th>
      <td>1.54</td>
      <td>4.88</td>
      <td>20.22</td>
      <td>12.55</td>
      <td>26.6</td>
      <td>72.95</td>
    </tr>
    <tr>
      <th>ALPHABET A</th>
      <td>0.00</td>
      <td>33.18</td>
      <td>18.12</td>
      <td>17.76</td>
      <td>33.2</td>
      <td>2.26</td>
    </tr>
    <tr>
      <th>NESTLE 'N'</th>
      <td>2.47</td>
      <td>16.85</td>
      <td>23.05</td>
      <td>14.21</td>
      <td>23.3</td>
      <td>71.42</td>
    </tr>
    <tr>
      <th>TESLA</th>
      <td>0.00</td>
      <td>11.21</td>
      <td>-14.94</td>
      <td>-1.61</td>
      <td>1036.3</td>
      <td>202.77</td>
    </tr>
    <tr>
      <th>SAUDI ARABIAN OIL</th>
      <td>0.21</td>
      <td>31.73</td>
      <td>32.25</td>
      <td>28.34</td>
      <td>29.5</td>
      <td>16.96</td>
    </tr>
    <tr>
      <th>TAIWAN SEMICON.MNFG.</th>
      <td>2.31</td>
      <td>57.91</td>
      <td>20.94</td>
      <td>18.96</td>
      <td>24.7</td>
      <td>11.89</td>
    </tr>
    <tr>
      <th>JOHNSON &amp; JOHNSON</th>
      <td>2.71</td>
      <td>23.83</td>
      <td>25.36</td>
      <td>17.38</td>
      <td>26.7</td>
      <td>46.57</td>
    </tr>
    <tr>
      <th>TENCENT HOLDINGS</th>
      <td>0.23</td>
      <td>35.55</td>
      <td>24.68</td>
      <td>15.92</td>
      <td>42.6</td>
      <td>53.74</td>
    </tr>
    <tr>
      <th>AMAZON.COM</th>
      <td>0.00</td>
      <td>14.60</td>
      <td>21.95</td>
      <td>12.97</td>
      <td>121.1</td>
      <td>83.31</td>
    </tr>
    <tr>
      <th>FACEBOOK CLASS A</th>
      <td>0.00</td>
      <td>41.11</td>
      <td>19.96</td>
      <td>19.94</td>
      <td>32.0</td>
      <td>0.47</td>
    </tr>
    <tr>
      <th>ALIBABA GROUP HOLDING ADR 1:8</th>
      <td>0.00</td>
      <td>31.23</td>
      <td>23.77</td>
      <td>17.39</td>
      <td>31.0</td>
      <td>16.60</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>You can also rearrange columns with <strong>reindex()</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">random_columns</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span><span class="n">big_companies_df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">random_columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;TOTAL DEBT % COMMON EQUITY&#39;, &#39;RETURN ON EQUITY - TOTAL (%)&#39;,
       &#39;P/E - RATIO&#39;, &#39;CASH FLOW/SALES&#39;, &#39;RETURN ON INVESTED CAPITAL&#39;,
       &#39;DIVIDEND YIELD&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">big_companies_df</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="n">random_columns</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TOTAL DEBT % COMMON EQUITY</th>
      <th>RETURN ON EQUITY - TOTAL (%)</th>
      <th>P/E - RATIO</th>
      <th>CASH FLOW/SALES</th>
      <th>RETURN ON INVESTED CAPITAL</th>
      <th>DIVIDEND YIELD</th>
    </tr>
    <tr>
      <th>NAME</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>APPLE</th>
      <td>119.40</td>
      <td>55.92</td>
      <td>35.4</td>
      <td>28.01</td>
      <td>27.65</td>
      <td>0.71</td>
    </tr>
    <tr>
      <th>SAUDI ARABIAN OIL</th>
      <td>16.96</td>
      <td>32.25</td>
      <td>29.5</td>
      <td>31.73</td>
      <td>28.34</td>
      <td>0.21</td>
    </tr>
    <tr>
      <th>MICROSOFT</th>
      <td>61.56</td>
      <td>40.14</td>
      <td>36.5</td>
      <td>43.46</td>
      <td>24.89</td>
      <td>1.06</td>
    </tr>
    <tr>
      <th>AMAZON.COM</th>
      <td>83.31</td>
      <td>21.95</td>
      <td>121.1</td>
      <td>14.60</td>
      <td>12.97</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>ALIBABA GROUP HOLDING ADR 1:8</th>
      <td>16.60</td>
      <td>23.77</td>
      <td>31.0</td>
      <td>31.23</td>
      <td>17.39</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>FACEBOOK CLASS A</th>
      <td>0.47</td>
      <td>19.96</td>
      <td>32.0</td>
      <td>41.11</td>
      <td>19.94</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>TENCENT HOLDINGS</th>
      <td>53.74</td>
      <td>24.68</td>
      <td>42.6</td>
      <td>35.55</td>
      <td>15.92</td>
      <td>0.23</td>
    </tr>
    <tr>
      <th>ALPHABET A</th>
      <td>2.26</td>
      <td>18.12</td>
      <td>33.2</td>
      <td>33.18</td>
      <td>17.76</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>TESLA</th>
      <td>202.77</td>
      <td>-14.94</td>
      <td>1036.3</td>
      <td>11.21</td>
      <td>-1.61</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>WALMART</th>
      <td>72.95</td>
      <td>20.22</td>
      <td>26.6</td>
      <td>4.88</td>
      <td>12.55</td>
      <td>1.54</td>
    </tr>
    <tr>
      <th>JOHNSON &amp; JOHNSON</th>
      <td>46.57</td>
      <td>25.36</td>
      <td>26.7</td>
      <td>23.83</td>
      <td>17.38</td>
      <td>2.71</td>
    </tr>
    <tr>
      <th>TAIWAN SEMICON.MNFG.</th>
      <td>11.89</td>
      <td>20.94</td>
      <td>24.7</td>
      <td>57.91</td>
      <td>18.96</td>
      <td>2.31</td>
    </tr>
    <tr>
      <th>NESTLE 'N'</th>
      <td>71.42</td>
      <td>23.05</td>
      <td>23.3</td>
      <td>16.85</td>
      <td>14.21</td>
      <td>2.47</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>If we have names in the reindex list that are not included in the original index/columns, these are added to the dataframe with missing values. You can prevent those missing values, for example, with <strong>ffill</strong> in the parameter <strong>method</strong> (there is also <strong>bfill</strong> and <strong>nearest</strong>).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">new_df</span> <span class="o">=</span> <span class="n">big_companies_df</span><span class="o">.</span><span class="n">reindex</span><span class="p">([</span><span class="s1">&#39;APPLE&#39;</span><span class="p">,</span><span class="s1">&#39;MICROSOFT&#39;</span><span class="p">,</span><span class="s1">&#39;TESLA&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">new_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>DIVIDEND YIELD</th>
      <th>CASH FLOW/SALES</th>
      <th>RETURN ON EQUITY - TOTAL (%)</th>
      <th>RETURN ON INVESTED CAPITAL</th>
      <th>P/E - RATIO</th>
      <th>TOTAL DEBT % COMMON EQUITY</th>
    </tr>
    <tr>
      <th>NAME</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>APPLE</th>
      <td>0.71</td>
      <td>28.01</td>
      <td>55.92</td>
      <td>27.65</td>
      <td>35.4</td>
      <td>119.40</td>
    </tr>
    <tr>
      <th>MICROSOFT</th>
      <td>1.06</td>
      <td>43.46</td>
      <td>40.14</td>
      <td>24.89</td>
      <td>36.5</td>
      <td>61.56</td>
    </tr>
    <tr>
      <th>TESLA</th>
      <td>0.00</td>
      <td>11.21</td>
      <td>-14.94</td>
      <td>-1.61</td>
      <td>1036.3</td>
      <td>202.77</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>Ffill</strong> is a forward fill. With strings, it adds the values of the original dataframe forward, according to the alphabetical order of the strings. Because <strong>APPLE</strong> is after <strong>AMAZON.COM</strong>, <strong>ALPHABET</strong> and <strong>ALIBABA…</strong> in alphabetical order, NaN values are put to these new rows.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">new_df</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">big_companies_df</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;ffill&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>DIVIDEND YIELD</th>
      <th>CASH FLOW/SALES</th>
      <th>RETURN ON EQUITY - TOTAL (%)</th>
      <th>RETURN ON INVESTED CAPITAL</th>
      <th>P/E - RATIO</th>
      <th>TOTAL DEBT % COMMON EQUITY</th>
    </tr>
    <tr>
      <th>NAME</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>APPLE</th>
      <td>0.71</td>
      <td>28.01</td>
      <td>55.92</td>
      <td>27.65</td>
      <td>35.4</td>
      <td>119.40</td>
    </tr>
    <tr>
      <th>SAUDI ARABIAN OIL</th>
      <td>1.06</td>
      <td>43.46</td>
      <td>40.14</td>
      <td>24.89</td>
      <td>36.5</td>
      <td>61.56</td>
    </tr>
    <tr>
      <th>MICROSOFT</th>
      <td>1.06</td>
      <td>43.46</td>
      <td>40.14</td>
      <td>24.89</td>
      <td>36.5</td>
      <td>61.56</td>
    </tr>
    <tr>
      <th>AMAZON.COM</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>ALIBABA GROUP HOLDING ADR 1:8</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>FACEBOOK CLASS A</th>
      <td>0.71</td>
      <td>28.01</td>
      <td>55.92</td>
      <td>27.65</td>
      <td>35.4</td>
      <td>119.40</td>
    </tr>
    <tr>
      <th>TENCENT HOLDINGS</th>
      <td>1.06</td>
      <td>43.46</td>
      <td>40.14</td>
      <td>24.89</td>
      <td>36.5</td>
      <td>61.56</td>
    </tr>
    <tr>
      <th>ALPHABET A</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>TESLA</th>
      <td>0.00</td>
      <td>11.21</td>
      <td>-14.94</td>
      <td>-1.61</td>
      <td>1036.3</td>
      <td>202.77</td>
    </tr>
    <tr>
      <th>WALMART</th>
      <td>0.00</td>
      <td>11.21</td>
      <td>-14.94</td>
      <td>-1.61</td>
      <td>1036.3</td>
      <td>202.77</td>
    </tr>
    <tr>
      <th>JOHNSON &amp; JOHNSON</th>
      <td>0.71</td>
      <td>28.01</td>
      <td>55.92</td>
      <td>27.65</td>
      <td>35.4</td>
      <td>119.40</td>
    </tr>
    <tr>
      <th>TAIWAN SEMICON.MNFG.</th>
      <td>1.06</td>
      <td>43.46</td>
      <td>40.14</td>
      <td>24.89</td>
      <td>36.5</td>
      <td>61.56</td>
    </tr>
    <tr>
      <th>NESTLE 'N'</th>
      <td>1.06</td>
      <td>43.46</td>
      <td>40.14</td>
      <td>24.89</td>
      <td>36.5</td>
      <td>61.56</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>It is easy to drop values by index values from a series/dataframe using <strong>drop()</strong>. By default, Pandas uses index. Defining <strong>axis=1</strong>, you can drop columns. Another option is to drop both using <strong>index</strong> and <strong>columns</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">big_companies_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;APPLE&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>DIVIDEND YIELD</th>
      <th>CASH FLOW/SALES</th>
      <th>RETURN ON EQUITY - TOTAL (%)</th>
      <th>RETURN ON INVESTED CAPITAL</th>
      <th>P/E - RATIO</th>
      <th>TOTAL DEBT % COMMON EQUITY</th>
    </tr>
    <tr>
      <th>NAME</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>SAUDI ARABIAN OIL</th>
      <td>0.21</td>
      <td>31.73</td>
      <td>32.25</td>
      <td>28.34</td>
      <td>29.5</td>
      <td>16.96</td>
    </tr>
    <tr>
      <th>MICROSOFT</th>
      <td>1.06</td>
      <td>43.46</td>
      <td>40.14</td>
      <td>24.89</td>
      <td>36.5</td>
      <td>61.56</td>
    </tr>
    <tr>
      <th>AMAZON.COM</th>
      <td>0.00</td>
      <td>14.60</td>
      <td>21.95</td>
      <td>12.97</td>
      <td>121.1</td>
      <td>83.31</td>
    </tr>
    <tr>
      <th>ALIBABA GROUP HOLDING ADR 1:8</th>
      <td>0.00</td>
      <td>31.23</td>
      <td>23.77</td>
      <td>17.39</td>
      <td>31.0</td>
      <td>16.60</td>
    </tr>
    <tr>
      <th>FACEBOOK CLASS A</th>
      <td>0.00</td>
      <td>41.11</td>
      <td>19.96</td>
      <td>19.94</td>
      <td>32.0</td>
      <td>0.47</td>
    </tr>
    <tr>
      <th>TENCENT HOLDINGS</th>
      <td>0.23</td>
      <td>35.55</td>
      <td>24.68</td>
      <td>15.92</td>
      <td>42.6</td>
      <td>53.74</td>
    </tr>
    <tr>
      <th>ALPHABET A</th>
      <td>0.00</td>
      <td>33.18</td>
      <td>18.12</td>
      <td>17.76</td>
      <td>33.2</td>
      <td>2.26</td>
    </tr>
    <tr>
      <th>TESLA</th>
      <td>0.00</td>
      <td>11.21</td>
      <td>-14.94</td>
      <td>-1.61</td>
      <td>1036.3</td>
      <td>202.77</td>
    </tr>
    <tr>
      <th>WALMART</th>
      <td>1.54</td>
      <td>4.88</td>
      <td>20.22</td>
      <td>12.55</td>
      <td>26.6</td>
      <td>72.95</td>
    </tr>
    <tr>
      <th>JOHNSON &amp; JOHNSON</th>
      <td>2.71</td>
      <td>23.83</td>
      <td>25.36</td>
      <td>17.38</td>
      <td>26.7</td>
      <td>46.57</td>
    </tr>
    <tr>
      <th>TAIWAN SEMICON.MNFG.</th>
      <td>2.31</td>
      <td>57.91</td>
      <td>20.94</td>
      <td>18.96</td>
      <td>24.7</td>
      <td>11.89</td>
    </tr>
    <tr>
      <th>NESTLE 'N'</th>
      <td>2.47</td>
      <td>16.85</td>
      <td>23.05</td>
      <td>14.21</td>
      <td>23.3</td>
      <td>71.42</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">big_companies_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;DIVIDEND YIELD&#39;</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CASH FLOW/SALES</th>
      <th>RETURN ON EQUITY - TOTAL (%)</th>
      <th>RETURN ON INVESTED CAPITAL</th>
      <th>P/E - RATIO</th>
      <th>TOTAL DEBT % COMMON EQUITY</th>
    </tr>
    <tr>
      <th>NAME</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>APPLE</th>
      <td>28.01</td>
      <td>55.92</td>
      <td>27.65</td>
      <td>35.4</td>
      <td>119.40</td>
    </tr>
    <tr>
      <th>SAUDI ARABIAN OIL</th>
      <td>31.73</td>
      <td>32.25</td>
      <td>28.34</td>
      <td>29.5</td>
      <td>16.96</td>
    </tr>
    <tr>
      <th>MICROSOFT</th>
      <td>43.46</td>
      <td>40.14</td>
      <td>24.89</td>
      <td>36.5</td>
      <td>61.56</td>
    </tr>
    <tr>
      <th>AMAZON.COM</th>
      <td>14.60</td>
      <td>21.95</td>
      <td>12.97</td>
      <td>121.1</td>
      <td>83.31</td>
    </tr>
    <tr>
      <th>ALIBABA GROUP HOLDING ADR 1:8</th>
      <td>31.23</td>
      <td>23.77</td>
      <td>17.39</td>
      <td>31.0</td>
      <td>16.60</td>
    </tr>
    <tr>
      <th>FACEBOOK CLASS A</th>
      <td>41.11</td>
      <td>19.96</td>
      <td>19.94</td>
      <td>32.0</td>
      <td>0.47</td>
    </tr>
    <tr>
      <th>TENCENT HOLDINGS</th>
      <td>35.55</td>
      <td>24.68</td>
      <td>15.92</td>
      <td>42.6</td>
      <td>53.74</td>
    </tr>
    <tr>
      <th>ALPHABET A</th>
      <td>33.18</td>
      <td>18.12</td>
      <td>17.76</td>
      <td>33.2</td>
      <td>2.26</td>
    </tr>
    <tr>
      <th>TESLA</th>
      <td>11.21</td>
      <td>-14.94</td>
      <td>-1.61</td>
      <td>1036.3</td>
      <td>202.77</td>
    </tr>
    <tr>
      <th>WALMART</th>
      <td>4.88</td>
      <td>20.22</td>
      <td>12.55</td>
      <td>26.6</td>
      <td>72.95</td>
    </tr>
    <tr>
      <th>JOHNSON &amp; JOHNSON</th>
      <td>23.83</td>
      <td>25.36</td>
      <td>17.38</td>
      <td>26.7</td>
      <td>46.57</td>
    </tr>
    <tr>
      <th>TAIWAN SEMICON.MNFG.</th>
      <td>57.91</td>
      <td>20.94</td>
      <td>18.96</td>
      <td>24.7</td>
      <td>11.89</td>
    </tr>
    <tr>
      <th>NESTLE 'N'</th>
      <td>16.85</td>
      <td>23.05</td>
      <td>14.21</td>
      <td>23.3</td>
      <td>71.42</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">big_companies_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;APPLE&#39;</span><span class="p">,</span><span class="s1">&#39;TESLA&#39;</span><span class="p">],</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;DIVIDEND YIELD&#39;</span><span class="p">,</span><span class="s1">&#39;P/E - RATIO&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CASH FLOW/SALES</th>
      <th>RETURN ON EQUITY - TOTAL (%)</th>
      <th>RETURN ON INVESTED CAPITAL</th>
      <th>TOTAL DEBT % COMMON EQUITY</th>
    </tr>
    <tr>
      <th>NAME</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>SAUDI ARABIAN OIL</th>
      <td>31.73</td>
      <td>32.25</td>
      <td>28.34</td>
      <td>16.96</td>
    </tr>
    <tr>
      <th>MICROSOFT</th>
      <td>43.46</td>
      <td>40.14</td>
      <td>24.89</td>
      <td>61.56</td>
    </tr>
    <tr>
      <th>AMAZON.COM</th>
      <td>14.60</td>
      <td>21.95</td>
      <td>12.97</td>
      <td>83.31</td>
    </tr>
    <tr>
      <th>ALIBABA GROUP HOLDING ADR 1:8</th>
      <td>31.23</td>
      <td>23.77</td>
      <td>17.39</td>
      <td>16.60</td>
    </tr>
    <tr>
      <th>FACEBOOK CLASS A</th>
      <td>41.11</td>
      <td>19.96</td>
      <td>19.94</td>
      <td>0.47</td>
    </tr>
    <tr>
      <th>TENCENT HOLDINGS</th>
      <td>35.55</td>
      <td>24.68</td>
      <td>15.92</td>
      <td>53.74</td>
    </tr>
    <tr>
      <th>ALPHABET A</th>
      <td>33.18</td>
      <td>18.12</td>
      <td>17.76</td>
      <td>2.26</td>
    </tr>
    <tr>
      <th>WALMART</th>
      <td>4.88</td>
      <td>20.22</td>
      <td>12.55</td>
      <td>72.95</td>
    </tr>
    <tr>
      <th>JOHNSON &amp; JOHNSON</th>
      <td>23.83</td>
      <td>25.36</td>
      <td>17.38</td>
      <td>46.57</td>
    </tr>
    <tr>
      <th>TAIWAN SEMICON.MNFG.</th>
      <td>57.91</td>
      <td>20.94</td>
      <td>18.96</td>
      <td>11.89</td>
    </tr>
    <tr>
      <th>NESTLE 'N'</th>
      <td>16.85</td>
      <td>23.05</td>
      <td>14.21</td>
      <td>71.42</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>An important thing to notice is that most of the Pandas methods are non-destructive. In the previous operations, we have made many manipulations to the big_companies_df dataframe. However, it is still the same.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">big_companies_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>DIVIDEND YIELD</th>
      <th>CASH FLOW/SALES</th>
      <th>RETURN ON EQUITY - TOTAL (%)</th>
      <th>RETURN ON INVESTED CAPITAL</th>
      <th>P/E - RATIO</th>
      <th>TOTAL DEBT % COMMON EQUITY</th>
    </tr>
    <tr>
      <th>NAME</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>APPLE</th>
      <td>0.71</td>
      <td>28.01</td>
      <td>55.92</td>
      <td>27.65</td>
      <td>35.4</td>
      <td>119.40</td>
    </tr>
    <tr>
      <th>SAUDI ARABIAN OIL</th>
      <td>0.21</td>
      <td>31.73</td>
      <td>32.25</td>
      <td>28.34</td>
      <td>29.5</td>
      <td>16.96</td>
    </tr>
    <tr>
      <th>MICROSOFT</th>
      <td>1.06</td>
      <td>43.46</td>
      <td>40.14</td>
      <td>24.89</td>
      <td>36.5</td>
      <td>61.56</td>
    </tr>
    <tr>
      <th>AMAZON.COM</th>
      <td>0.00</td>
      <td>14.60</td>
      <td>21.95</td>
      <td>12.97</td>
      <td>121.1</td>
      <td>83.31</td>
    </tr>
    <tr>
      <th>ALIBABA GROUP HOLDING ADR 1:8</th>
      <td>0.00</td>
      <td>31.23</td>
      <td>23.77</td>
      <td>17.39</td>
      <td>31.0</td>
      <td>16.60</td>
    </tr>
    <tr>
      <th>FACEBOOK CLASS A</th>
      <td>0.00</td>
      <td>41.11</td>
      <td>19.96</td>
      <td>19.94</td>
      <td>32.0</td>
      <td>0.47</td>
    </tr>
    <tr>
      <th>TENCENT HOLDINGS</th>
      <td>0.23</td>
      <td>35.55</td>
      <td>24.68</td>
      <td>15.92</td>
      <td>42.6</td>
      <td>53.74</td>
    </tr>
    <tr>
      <th>ALPHABET A</th>
      <td>0.00</td>
      <td>33.18</td>
      <td>18.12</td>
      <td>17.76</td>
      <td>33.2</td>
      <td>2.26</td>
    </tr>
    <tr>
      <th>TESLA</th>
      <td>0.00</td>
      <td>11.21</td>
      <td>-14.94</td>
      <td>-1.61</td>
      <td>1036.3</td>
      <td>202.77</td>
    </tr>
    <tr>
      <th>WALMART</th>
      <td>1.54</td>
      <td>4.88</td>
      <td>20.22</td>
      <td>12.55</td>
      <td>26.6</td>
      <td>72.95</td>
    </tr>
    <tr>
      <th>JOHNSON &amp; JOHNSON</th>
      <td>2.71</td>
      <td>23.83</td>
      <td>25.36</td>
      <td>17.38</td>
      <td>26.7</td>
      <td>46.57</td>
    </tr>
    <tr>
      <th>TAIWAN SEMICON.MNFG.</th>
      <td>2.31</td>
      <td>57.91</td>
      <td>20.94</td>
      <td>18.96</td>
      <td>24.7</td>
      <td>11.89</td>
    </tr>
    <tr>
      <th>NESTLE 'N'</th>
      <td>2.47</td>
      <td>16.85</td>
      <td>23.05</td>
      <td>14.21</td>
      <td>23.3</td>
      <td>71.42</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Pandas makes almost all manipulations so that the manipulated dataframe is returned as a new object. If you want to change the original dataframe, almost all the methods have <strong>inplace=True</strong> for that.</p>
<p>Indexing, selecting values and slicing Pandas dataframes is very similar to other Python objects. One important difference is that when using labels for slicing, the last label is inclusive.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">big_companies_df</span><span class="p">[</span><span class="s1">&#39;MICROSOFT&#39;</span><span class="p">:</span><span class="s1">&#39;TESLA&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>DIVIDEND YIELD</th>
      <th>CASH FLOW/SALES</th>
      <th>RETURN ON EQUITY - TOTAL (%)</th>
      <th>RETURN ON INVESTED CAPITAL</th>
      <th>P/E - RATIO</th>
      <th>TOTAL DEBT % COMMON EQUITY</th>
    </tr>
    <tr>
      <th>NAME</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>MICROSOFT</th>
      <td>1.06</td>
      <td>43.46</td>
      <td>40.14</td>
      <td>24.89</td>
      <td>36.5</td>
      <td>61.56</td>
    </tr>
    <tr>
      <th>AMAZON.COM</th>
      <td>0.00</td>
      <td>14.60</td>
      <td>21.95</td>
      <td>12.97</td>
      <td>121.1</td>
      <td>83.31</td>
    </tr>
    <tr>
      <th>ALIBABA GROUP HOLDING ADR 1:8</th>
      <td>0.00</td>
      <td>31.23</td>
      <td>23.77</td>
      <td>17.39</td>
      <td>31.0</td>
      <td>16.60</td>
    </tr>
    <tr>
      <th>FACEBOOK CLASS A</th>
      <td>0.00</td>
      <td>41.11</td>
      <td>19.96</td>
      <td>19.94</td>
      <td>32.0</td>
      <td>0.47</td>
    </tr>
    <tr>
      <th>TENCENT HOLDINGS</th>
      <td>0.23</td>
      <td>35.55</td>
      <td>24.68</td>
      <td>15.92</td>
      <td>42.6</td>
      <td>53.74</td>
    </tr>
    <tr>
      <th>ALPHABET A</th>
      <td>0.00</td>
      <td>33.18</td>
      <td>18.12</td>
      <td>17.76</td>
      <td>33.2</td>
      <td>2.26</td>
    </tr>
    <tr>
      <th>TESLA</th>
      <td>0.00</td>
      <td>11.21</td>
      <td>-14.94</td>
      <td>-1.61</td>
      <td>1036.3</td>
      <td>202.77</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>You can also pick up columns using double brackets, put the slicing is not possible.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">big_companies_df</span><span class="p">[[</span><span class="s1">&#39;DIVIDEND YIELD&#39;</span><span class="p">,</span><span class="s1">&#39;CASH FLOW/SALES&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>DIVIDEND YIELD</th>
      <th>CASH FLOW/SALES</th>
    </tr>
    <tr>
      <th>NAME</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>APPLE</th>
      <td>0.71</td>
      <td>28.01</td>
    </tr>
    <tr>
      <th>SAUDI ARABIAN OIL</th>
      <td>0.21</td>
      <td>31.73</td>
    </tr>
    <tr>
      <th>MICROSOFT</th>
      <td>1.06</td>
      <td>43.46</td>
    </tr>
    <tr>
      <th>AMAZON.COM</th>
      <td>0.00</td>
      <td>14.60</td>
    </tr>
    <tr>
      <th>ALIBABA GROUP HOLDING ADR 1:8</th>
      <td>0.00</td>
      <td>31.23</td>
    </tr>
    <tr>
      <th>FACEBOOK CLASS A</th>
      <td>0.00</td>
      <td>41.11</td>
    </tr>
    <tr>
      <th>TENCENT HOLDINGS</th>
      <td>0.23</td>
      <td>35.55</td>
    </tr>
    <tr>
      <th>ALPHABET A</th>
      <td>0.00</td>
      <td>33.18</td>
    </tr>
    <tr>
      <th>TESLA</th>
      <td>0.00</td>
      <td>11.21</td>
    </tr>
    <tr>
      <th>WALMART</th>
      <td>1.54</td>
      <td>4.88</td>
    </tr>
    <tr>
      <th>JOHNSON &amp; JOHNSON</th>
      <td>2.71</td>
      <td>23.83</td>
    </tr>
    <tr>
      <th>TAIWAN SEMICON.MNFG.</th>
      <td>2.31</td>
      <td>57.91</td>
    </tr>
    <tr>
      <th>NESTLE 'N'</th>
      <td>2.47</td>
      <td>16.85</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>You can also pick up values using booleans.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">big_companies_df</span><span class="p">[</span><span class="n">big_companies_df</span><span class="p">[</span><span class="s1">&#39;P/E - RATIO&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">40</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>DIVIDEND YIELD</th>
      <th>CASH FLOW/SALES</th>
      <th>RETURN ON EQUITY - TOTAL (%)</th>
      <th>RETURN ON INVESTED CAPITAL</th>
      <th>P/E - RATIO</th>
      <th>TOTAL DEBT % COMMON EQUITY</th>
    </tr>
    <tr>
      <th>NAME</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>AMAZON.COM</th>
      <td>0.00</td>
      <td>14.60</td>
      <td>21.95</td>
      <td>12.97</td>
      <td>121.1</td>
      <td>83.31</td>
    </tr>
    <tr>
      <th>TENCENT HOLDINGS</th>
      <td>0.23</td>
      <td>35.55</td>
      <td>24.68</td>
      <td>15.92</td>
      <td>42.6</td>
      <td>53.74</td>
    </tr>
    <tr>
      <th>TESLA</th>
      <td>0.00</td>
      <td>11.21</td>
      <td>-14.94</td>
      <td>-1.61</td>
      <td>1036.3</td>
      <td>202.77</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>You can build a boolean dataframe easily. In the following, we check if a value in the dataframe is larger than 10.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">big_companies_df</span> <span class="o">&gt;</span> <span class="mi">10</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>DIVIDEND YIELD</th>
      <th>CASH FLOW/SALES</th>
      <th>RETURN ON EQUITY - TOTAL (%)</th>
      <th>RETURN ON INVESTED CAPITAL</th>
      <th>P/E - RATIO</th>
      <th>TOTAL DEBT % COMMON EQUITY</th>
    </tr>
    <tr>
      <th>NAME</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>APPLE</th>
      <td>False</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>SAUDI ARABIAN OIL</th>
      <td>False</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>MICROSOFT</th>
      <td>False</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>AMAZON.COM</th>
      <td>False</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>ALIBABA GROUP HOLDING ADR 1:8</th>
      <td>False</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>FACEBOOK CLASS A</th>
      <td>False</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>False</td>
    </tr>
    <tr>
      <th>TENCENT HOLDINGS</th>
      <td>False</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>ALPHABET A</th>
      <td>False</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>False</td>
    </tr>
    <tr>
      <th>TESLA</th>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>WALMART</th>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>JOHNSON &amp; JOHNSON</th>
      <td>False</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>TAIWAN SEMICON.MNFG.</th>
      <td>False</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>NESTLE 'N'</th>
      <td>False</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>To make the indexing more clear, Pandas has operators <strong>loc</strong> and <strong>iloc</strong> that can be used to select the rows and columns from a dataframe using Numpy-like notation. <strong>loc</strong> works with labels and <strong>iloc</strong> with integer positions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">big_companies_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>DIVIDEND YIELD</th>
      <th>CASH FLOW/SALES</th>
      <th>RETURN ON EQUITY - TOTAL (%)</th>
      <th>RETURN ON INVESTED CAPITAL</th>
      <th>P/E - RATIO</th>
      <th>TOTAL DEBT % COMMON EQUITY</th>
    </tr>
    <tr>
      <th>NAME</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>APPLE</th>
      <td>0.71</td>
      <td>28.01</td>
      <td>55.92</td>
      <td>27.65</td>
      <td>35.4</td>
      <td>119.40</td>
    </tr>
    <tr>
      <th>SAUDI ARABIAN OIL</th>
      <td>0.21</td>
      <td>31.73</td>
      <td>32.25</td>
      <td>28.34</td>
      <td>29.5</td>
      <td>16.96</td>
    </tr>
    <tr>
      <th>MICROSOFT</th>
      <td>1.06</td>
      <td>43.46</td>
      <td>40.14</td>
      <td>24.89</td>
      <td>36.5</td>
      <td>61.56</td>
    </tr>
    <tr>
      <th>AMAZON.COM</th>
      <td>0.00</td>
      <td>14.60</td>
      <td>21.95</td>
      <td>12.97</td>
      <td>121.1</td>
      <td>83.31</td>
    </tr>
    <tr>
      <th>ALIBABA GROUP HOLDING ADR 1:8</th>
      <td>0.00</td>
      <td>31.23</td>
      <td>23.77</td>
      <td>17.39</td>
      <td>31.0</td>
      <td>16.60</td>
    </tr>
    <tr>
      <th>FACEBOOK CLASS A</th>
      <td>0.00</td>
      <td>41.11</td>
      <td>19.96</td>
      <td>19.94</td>
      <td>32.0</td>
      <td>0.47</td>
    </tr>
    <tr>
      <th>TENCENT HOLDINGS</th>
      <td>0.23</td>
      <td>35.55</td>
      <td>24.68</td>
      <td>15.92</td>
      <td>42.6</td>
      <td>53.74</td>
    </tr>
    <tr>
      <th>ALPHABET A</th>
      <td>0.00</td>
      <td>33.18</td>
      <td>18.12</td>
      <td>17.76</td>
      <td>33.2</td>
      <td>2.26</td>
    </tr>
    <tr>
      <th>TESLA</th>
      <td>0.00</td>
      <td>11.21</td>
      <td>-14.94</td>
      <td>-1.61</td>
      <td>1036.3</td>
      <td>202.77</td>
    </tr>
    <tr>
      <th>WALMART</th>
      <td>1.54</td>
      <td>4.88</td>
      <td>20.22</td>
      <td>12.55</td>
      <td>26.6</td>
      <td>72.95</td>
    </tr>
    <tr>
      <th>JOHNSON &amp; JOHNSON</th>
      <td>2.71</td>
      <td>23.83</td>
      <td>25.36</td>
      <td>17.38</td>
      <td>26.7</td>
      <td>46.57</td>
    </tr>
    <tr>
      <th>TAIWAN SEMICON.MNFG.</th>
      <td>2.31</td>
      <td>57.91</td>
      <td>20.94</td>
      <td>18.96</td>
      <td>24.7</td>
      <td>11.89</td>
    </tr>
    <tr>
      <th>NESTLE 'N'</th>
      <td>2.47</td>
      <td>16.85</td>
      <td>23.05</td>
      <td>14.21</td>
      <td>23.3</td>
      <td>71.42</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Notice that with <strong>loc</strong> we can use slicing also with columns.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">big_companies_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;TENCENT HOLDINGS&#39;</span><span class="p">:</span><span class="s1">&#39;TAIWAN SEMICON.MNFG.&#39;</span><span class="p">,</span><span class="s1">&#39;DIVIDEND YIELD&#39;</span><span class="p">:</span><span class="s1">&#39;P/E - RATIO&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>DIVIDEND YIELD</th>
      <th>CASH FLOW/SALES</th>
      <th>RETURN ON EQUITY - TOTAL (%)</th>
      <th>RETURN ON INVESTED CAPITAL</th>
      <th>P/E - RATIO</th>
    </tr>
    <tr>
      <th>NAME</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>TENCENT HOLDINGS</th>
      <td>0.23</td>
      <td>35.55</td>
      <td>24.68</td>
      <td>15.92</td>
      <td>42.6</td>
    </tr>
    <tr>
      <th>ALPHABET A</th>
      <td>0.00</td>
      <td>33.18</td>
      <td>18.12</td>
      <td>17.76</td>
      <td>33.2</td>
    </tr>
    <tr>
      <th>TESLA</th>
      <td>0.00</td>
      <td>11.21</td>
      <td>-14.94</td>
      <td>-1.61</td>
      <td>1036.3</td>
    </tr>
    <tr>
      <th>WALMART</th>
      <td>1.54</td>
      <td>4.88</td>
      <td>20.22</td>
      <td>12.55</td>
      <td>26.6</td>
    </tr>
    <tr>
      <th>JOHNSON &amp; JOHNSON</th>
      <td>2.71</td>
      <td>23.83</td>
      <td>25.36</td>
      <td>17.38</td>
      <td>26.7</td>
    </tr>
    <tr>
      <th>TAIWAN SEMICON.MNFG.</th>
      <td>2.31</td>
      <td>57.91</td>
      <td>20.94</td>
      <td>18.96</td>
      <td>24.7</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">big_companies_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">6</span><span class="p">:</span><span class="mi">12</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>DIVIDEND YIELD</th>
      <th>CASH FLOW/SALES</th>
      <th>RETURN ON EQUITY - TOTAL (%)</th>
      <th>RETURN ON INVESTED CAPITAL</th>
      <th>P/E - RATIO</th>
    </tr>
    <tr>
      <th>NAME</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>TENCENT HOLDINGS</th>
      <td>0.23</td>
      <td>35.55</td>
      <td>24.68</td>
      <td>15.92</td>
      <td>42.6</td>
    </tr>
    <tr>
      <th>ALPHABET A</th>
      <td>0.00</td>
      <td>33.18</td>
      <td>18.12</td>
      <td>17.76</td>
      <td>33.2</td>
    </tr>
    <tr>
      <th>TESLA</th>
      <td>0.00</td>
      <td>11.21</td>
      <td>-14.94</td>
      <td>-1.61</td>
      <td>1036.3</td>
    </tr>
    <tr>
      <th>WALMART</th>
      <td>1.54</td>
      <td>4.88</td>
      <td>20.22</td>
      <td>12.55</td>
      <td>26.6</td>
    </tr>
    <tr>
      <th>JOHNSON &amp; JOHNSON</th>
      <td>2.71</td>
      <td>23.83</td>
      <td>25.36</td>
      <td>17.38</td>
      <td>26.7</td>
    </tr>
    <tr>
      <th>TAIWAN SEMICON.MNFG.</th>
      <td>2.31</td>
      <td>57.91</td>
      <td>20.94</td>
      <td>18.96</td>
      <td>24.7</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>When adding dataframes, any index-column pairs that are missing from either dataframe, will be replaced with NaN-values. Let’s look an example. We create two dataframes with partial data. Both are missing one (different) row and one column.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">partial_data_df</span> <span class="o">=</span> <span class="n">big_companies_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">&#39;APPLE&#39;</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="s1">&#39;DIVIDEND YIELD&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">partial_data_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CASH FLOW/SALES</th>
      <th>RETURN ON EQUITY - TOTAL (%)</th>
      <th>RETURN ON INVESTED CAPITAL</th>
      <th>P/E - RATIO</th>
      <th>TOTAL DEBT % COMMON EQUITY</th>
    </tr>
    <tr>
      <th>NAME</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>SAUDI ARABIAN OIL</th>
      <td>31.73</td>
      <td>32.25</td>
      <td>28.34</td>
      <td>29.5</td>
      <td>16.96</td>
    </tr>
    <tr>
      <th>MICROSOFT</th>
      <td>43.46</td>
      <td>40.14</td>
      <td>24.89</td>
      <td>36.5</td>
      <td>61.56</td>
    </tr>
    <tr>
      <th>AMAZON.COM</th>
      <td>14.60</td>
      <td>21.95</td>
      <td>12.97</td>
      <td>121.1</td>
      <td>83.31</td>
    </tr>
    <tr>
      <th>ALIBABA GROUP HOLDING ADR 1:8</th>
      <td>31.23</td>
      <td>23.77</td>
      <td>17.39</td>
      <td>31.0</td>
      <td>16.60</td>
    </tr>
    <tr>
      <th>FACEBOOK CLASS A</th>
      <td>41.11</td>
      <td>19.96</td>
      <td>19.94</td>
      <td>32.0</td>
      <td>0.47</td>
    </tr>
    <tr>
      <th>TENCENT HOLDINGS</th>
      <td>35.55</td>
      <td>24.68</td>
      <td>15.92</td>
      <td>42.6</td>
      <td>53.74</td>
    </tr>
    <tr>
      <th>ALPHABET A</th>
      <td>33.18</td>
      <td>18.12</td>
      <td>17.76</td>
      <td>33.2</td>
      <td>2.26</td>
    </tr>
    <tr>
      <th>TESLA</th>
      <td>11.21</td>
      <td>-14.94</td>
      <td>-1.61</td>
      <td>1036.3</td>
      <td>202.77</td>
    </tr>
    <tr>
      <th>WALMART</th>
      <td>4.88</td>
      <td>20.22</td>
      <td>12.55</td>
      <td>26.6</td>
      <td>72.95</td>
    </tr>
    <tr>
      <th>JOHNSON &amp; JOHNSON</th>
      <td>23.83</td>
      <td>25.36</td>
      <td>17.38</td>
      <td>26.7</td>
      <td>46.57</td>
    </tr>
    <tr>
      <th>TAIWAN SEMICON.MNFG.</th>
      <td>57.91</td>
      <td>20.94</td>
      <td>18.96</td>
      <td>24.7</td>
      <td>11.89</td>
    </tr>
    <tr>
      <th>NESTLE 'N'</th>
      <td>16.85</td>
      <td>23.05</td>
      <td>14.21</td>
      <td>23.3</td>
      <td>71.42</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">partial_data2_df</span> <span class="o">=</span> <span class="n">big_companies_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">&#39;TESLA&#39;</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="s1">&#39;CASH FLOW/SALES&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">partial_data2_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>DIVIDEND YIELD</th>
      <th>RETURN ON EQUITY - TOTAL (%)</th>
      <th>RETURN ON INVESTED CAPITAL</th>
      <th>P/E - RATIO</th>
      <th>TOTAL DEBT % COMMON EQUITY</th>
    </tr>
    <tr>
      <th>NAME</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>APPLE</th>
      <td>0.71</td>
      <td>55.92</td>
      <td>27.65</td>
      <td>35.4</td>
      <td>119.40</td>
    </tr>
    <tr>
      <th>SAUDI ARABIAN OIL</th>
      <td>0.21</td>
      <td>32.25</td>
      <td>28.34</td>
      <td>29.5</td>
      <td>16.96</td>
    </tr>
    <tr>
      <th>MICROSOFT</th>
      <td>1.06</td>
      <td>40.14</td>
      <td>24.89</td>
      <td>36.5</td>
      <td>61.56</td>
    </tr>
    <tr>
      <th>AMAZON.COM</th>
      <td>0.00</td>
      <td>21.95</td>
      <td>12.97</td>
      <td>121.1</td>
      <td>83.31</td>
    </tr>
    <tr>
      <th>ALIBABA GROUP HOLDING ADR 1:8</th>
      <td>0.00</td>
      <td>23.77</td>
      <td>17.39</td>
      <td>31.0</td>
      <td>16.60</td>
    </tr>
    <tr>
      <th>FACEBOOK CLASS A</th>
      <td>0.00</td>
      <td>19.96</td>
      <td>19.94</td>
      <td>32.0</td>
      <td>0.47</td>
    </tr>
    <tr>
      <th>TENCENT HOLDINGS</th>
      <td>0.23</td>
      <td>24.68</td>
      <td>15.92</td>
      <td>42.6</td>
      <td>53.74</td>
    </tr>
    <tr>
      <th>ALPHABET A</th>
      <td>0.00</td>
      <td>18.12</td>
      <td>17.76</td>
      <td>33.2</td>
      <td>2.26</td>
    </tr>
    <tr>
      <th>WALMART</th>
      <td>1.54</td>
      <td>20.22</td>
      <td>12.55</td>
      <td>26.6</td>
      <td>72.95</td>
    </tr>
    <tr>
      <th>JOHNSON &amp; JOHNSON</th>
      <td>2.71</td>
      <td>25.36</td>
      <td>17.38</td>
      <td>26.7</td>
      <td>46.57</td>
    </tr>
    <tr>
      <th>TAIWAN SEMICON.MNFG.</th>
      <td>2.31</td>
      <td>20.94</td>
      <td>18.96</td>
      <td>24.7</td>
      <td>11.89</td>
    </tr>
    <tr>
      <th>NESTLE 'N'</th>
      <td>2.47</td>
      <td>23.05</td>
      <td>14.21</td>
      <td>23.3</td>
      <td>71.42</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Those cells that are found in both dataframes have their values summed. If a specific cell is only in one of the dataframes, a NaN value is inserted to that location in the resulting dataframe.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">partial_data_df</span> <span class="o">+</span> <span class="n">partial_data2_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CASH FLOW/SALES</th>
      <th>DIVIDEND YIELD</th>
      <th>P/E - RATIO</th>
      <th>RETURN ON EQUITY - TOTAL (%)</th>
      <th>RETURN ON INVESTED CAPITAL</th>
      <th>TOTAL DEBT % COMMON EQUITY</th>
    </tr>
    <tr>
      <th>NAME</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>ALIBABA GROUP HOLDING ADR 1:8</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>62.0</td>
      <td>47.54</td>
      <td>34.78</td>
      <td>33.20</td>
    </tr>
    <tr>
      <th>ALPHABET A</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>66.4</td>
      <td>36.24</td>
      <td>35.52</td>
      <td>4.52</td>
    </tr>
    <tr>
      <th>AMAZON.COM</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>242.2</td>
      <td>43.90</td>
      <td>25.94</td>
      <td>166.62</td>
    </tr>
    <tr>
      <th>APPLE</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>FACEBOOK CLASS A</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>64.0</td>
      <td>39.92</td>
      <td>39.88</td>
      <td>0.94</td>
    </tr>
    <tr>
      <th>JOHNSON &amp; JOHNSON</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>53.4</td>
      <td>50.72</td>
      <td>34.76</td>
      <td>93.14</td>
    </tr>
    <tr>
      <th>MICROSOFT</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>73.0</td>
      <td>80.28</td>
      <td>49.78</td>
      <td>123.12</td>
    </tr>
    <tr>
      <th>NESTLE 'N'</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>46.6</td>
      <td>46.10</td>
      <td>28.42</td>
      <td>142.84</td>
    </tr>
    <tr>
      <th>SAUDI ARABIAN OIL</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>59.0</td>
      <td>64.50</td>
      <td>56.68</td>
      <td>33.92</td>
    </tr>
    <tr>
      <th>TAIWAN SEMICON.MNFG.</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>49.4</td>
      <td>41.88</td>
      <td>37.92</td>
      <td>23.78</td>
    </tr>
    <tr>
      <th>TENCENT HOLDINGS</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>85.2</td>
      <td>49.36</td>
      <td>31.84</td>
      <td>107.48</td>
    </tr>
    <tr>
      <th>TESLA</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>WALMART</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>53.2</td>
      <td>40.44</td>
      <td>25.10</td>
      <td>145.90</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>If you want to have some other than NaN values to these locations, you can use the <strong>add()</strong> method with the <strong>fill_value</strong> parameter. This will  replace the missing values with a specified value. Notice how <strong>APPLE</strong> <strong>CASH FLOW/SALES</strong> and <strong>TESLA</strong>/<strong>DIVIDEND YIELD</strong> still have missing values. This is because they are missing from <strong>both</strong> partial dataframes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">partial_data_df</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">partial_data2_df</span><span class="p">,</span><span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CASH FLOW/SALES</th>
      <th>DIVIDEND YIELD</th>
      <th>P/E - RATIO</th>
      <th>RETURN ON EQUITY - TOTAL (%)</th>
      <th>RETURN ON INVESTED CAPITAL</th>
      <th>TOTAL DEBT % COMMON EQUITY</th>
    </tr>
    <tr>
      <th>NAME</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>ALIBABA GROUP HOLDING ADR 1:8</th>
      <td>31.23</td>
      <td>0.00</td>
      <td>62.0</td>
      <td>47.54</td>
      <td>34.78</td>
      <td>33.20</td>
    </tr>
    <tr>
      <th>ALPHABET A</th>
      <td>33.18</td>
      <td>0.00</td>
      <td>66.4</td>
      <td>36.24</td>
      <td>35.52</td>
      <td>4.52</td>
    </tr>
    <tr>
      <th>AMAZON.COM</th>
      <td>14.60</td>
      <td>0.00</td>
      <td>242.2</td>
      <td>43.90</td>
      <td>25.94</td>
      <td>166.62</td>
    </tr>
    <tr>
      <th>APPLE</th>
      <td>NaN</td>
      <td>0.71</td>
      <td>35.4</td>
      <td>55.92</td>
      <td>27.65</td>
      <td>119.40</td>
    </tr>
    <tr>
      <th>FACEBOOK CLASS A</th>
      <td>41.11</td>
      <td>0.00</td>
      <td>64.0</td>
      <td>39.92</td>
      <td>39.88</td>
      <td>0.94</td>
    </tr>
    <tr>
      <th>JOHNSON &amp; JOHNSON</th>
      <td>23.83</td>
      <td>2.71</td>
      <td>53.4</td>
      <td>50.72</td>
      <td>34.76</td>
      <td>93.14</td>
    </tr>
    <tr>
      <th>MICROSOFT</th>
      <td>43.46</td>
      <td>1.06</td>
      <td>73.0</td>
      <td>80.28</td>
      <td>49.78</td>
      <td>123.12</td>
    </tr>
    <tr>
      <th>NESTLE 'N'</th>
      <td>16.85</td>
      <td>2.47</td>
      <td>46.6</td>
      <td>46.10</td>
      <td>28.42</td>
      <td>142.84</td>
    </tr>
    <tr>
      <th>SAUDI ARABIAN OIL</th>
      <td>31.73</td>
      <td>0.21</td>
      <td>59.0</td>
      <td>64.50</td>
      <td>56.68</td>
      <td>33.92</td>
    </tr>
    <tr>
      <th>TAIWAN SEMICON.MNFG.</th>
      <td>57.91</td>
      <td>2.31</td>
      <td>49.4</td>
      <td>41.88</td>
      <td>37.92</td>
      <td>23.78</td>
    </tr>
    <tr>
      <th>TENCENT HOLDINGS</th>
      <td>35.55</td>
      <td>0.23</td>
      <td>85.2</td>
      <td>49.36</td>
      <td>31.84</td>
      <td>107.48</td>
    </tr>
    <tr>
      <th>TESLA</th>
      <td>11.21</td>
      <td>NaN</td>
      <td>1036.3</td>
      <td>-14.94</td>
      <td>-1.61</td>
      <td>202.77</td>
    </tr>
    <tr>
      <th>WALMART</th>
      <td>4.88</td>
      <td>1.54</td>
      <td>53.2</td>
      <td>40.44</td>
      <td>25.10</td>
      <td>145.90</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>You can also do arithmetic operations between a dataframe and a Pandas series. One thing to note is that these operations use <strong>broadcasting</strong> like Numpy arrays. Broadcasting is a very important concept in ML. You can read more about it here. <a class="reference external" href="https://numpy.org/doc/stable/user/basics.broadcasting.html">numpy.org/doc/stable/user/basics.broadcasting.html</a></p>
<p>In its simplest, broadcasting means that if we are subtracting a Series from a Dataframe, the Series is subtracted from every row (or column) of the dataframe.</p>
<p>In the following, we subtract the values of <strong>TESLA</strong> from every row of our dataframe.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample_series</span> <span class="o">=</span> <span class="n">big_companies_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;TESLA&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample_series</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>DIVIDEND YIELD                     0.00
CASH FLOW/SALES                   11.21
RETURN ON EQUITY - TOTAL (%)     -14.94
RETURN ON INVESTED CAPITAL        -1.61
P/E - RATIO                     1036.30
TOTAL DEBT % COMMON EQUITY       202.77
Name: TESLA, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>The index of the series is matched with the columns of the dataframe.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">big_companies_df</span><span class="o">-</span><span class="n">sample_series</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>DIVIDEND YIELD</th>
      <th>CASH FLOW/SALES</th>
      <th>RETURN ON EQUITY - TOTAL (%)</th>
      <th>RETURN ON INVESTED CAPITAL</th>
      <th>P/E - RATIO</th>
      <th>TOTAL DEBT % COMMON EQUITY</th>
    </tr>
    <tr>
      <th>NAME</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>APPLE</th>
      <td>0.71</td>
      <td>16.80</td>
      <td>70.86</td>
      <td>29.26</td>
      <td>-1000.9</td>
      <td>-83.37</td>
    </tr>
    <tr>
      <th>SAUDI ARABIAN OIL</th>
      <td>0.21</td>
      <td>20.52</td>
      <td>47.19</td>
      <td>29.95</td>
      <td>-1006.8</td>
      <td>-185.81</td>
    </tr>
    <tr>
      <th>MICROSOFT</th>
      <td>1.06</td>
      <td>32.25</td>
      <td>55.08</td>
      <td>26.50</td>
      <td>-999.8</td>
      <td>-141.21</td>
    </tr>
    <tr>
      <th>AMAZON.COM</th>
      <td>0.00</td>
      <td>3.39</td>
      <td>36.89</td>
      <td>14.58</td>
      <td>-915.2</td>
      <td>-119.46</td>
    </tr>
    <tr>
      <th>ALIBABA GROUP HOLDING ADR 1:8</th>
      <td>0.00</td>
      <td>20.02</td>
      <td>38.71</td>
      <td>19.00</td>
      <td>-1005.3</td>
      <td>-186.17</td>
    </tr>
    <tr>
      <th>FACEBOOK CLASS A</th>
      <td>0.00</td>
      <td>29.90</td>
      <td>34.90</td>
      <td>21.55</td>
      <td>-1004.3</td>
      <td>-202.30</td>
    </tr>
    <tr>
      <th>TENCENT HOLDINGS</th>
      <td>0.23</td>
      <td>24.34</td>
      <td>39.62</td>
      <td>17.53</td>
      <td>-993.7</td>
      <td>-149.03</td>
    </tr>
    <tr>
      <th>ALPHABET A</th>
      <td>0.00</td>
      <td>21.97</td>
      <td>33.06</td>
      <td>19.37</td>
      <td>-1003.1</td>
      <td>-200.51</td>
    </tr>
    <tr>
      <th>TESLA</th>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>WALMART</th>
      <td>1.54</td>
      <td>-6.33</td>
      <td>35.16</td>
      <td>14.16</td>
      <td>-1009.7</td>
      <td>-129.82</td>
    </tr>
    <tr>
      <th>JOHNSON &amp; JOHNSON</th>
      <td>2.71</td>
      <td>12.62</td>
      <td>40.30</td>
      <td>18.99</td>
      <td>-1009.6</td>
      <td>-156.20</td>
    </tr>
    <tr>
      <th>TAIWAN SEMICON.MNFG.</th>
      <td>2.31</td>
      <td>46.70</td>
      <td>35.88</td>
      <td>20.57</td>
      <td>-1011.6</td>
      <td>-190.88</td>
    </tr>
    <tr>
      <th>NESTLE 'N'</th>
      <td>2.47</td>
      <td>5.64</td>
      <td>37.99</td>
      <td>15.82</td>
      <td>-1013.0</td>
      <td>-131.35</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>If the index/columns do not match, the resulting dataframe is a union.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample_series</span> <span class="o">=</span> <span class="n">sample_series</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;extra row&#39;</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">big_companies_df</span><span class="o">-</span><span class="n">sample_series</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CASH FLOW/SALES</th>
      <th>DIVIDEND YIELD</th>
      <th>P/E - RATIO</th>
      <th>RETURN ON EQUITY - TOTAL (%)</th>
      <th>RETURN ON INVESTED CAPITAL</th>
      <th>TOTAL DEBT % COMMON EQUITY</th>
      <th>extra row</th>
    </tr>
    <tr>
      <th>NAME</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>APPLE</th>
      <td>16.80</td>
      <td>0.71</td>
      <td>-1000.9</td>
      <td>70.86</td>
      <td>29.26</td>
      <td>-83.37</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>SAUDI ARABIAN OIL</th>
      <td>20.52</td>
      <td>0.21</td>
      <td>-1006.8</td>
      <td>47.19</td>
      <td>29.95</td>
      <td>-185.81</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>MICROSOFT</th>
      <td>32.25</td>
      <td>1.06</td>
      <td>-999.8</td>
      <td>55.08</td>
      <td>26.50</td>
      <td>-141.21</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>AMAZON.COM</th>
      <td>3.39</td>
      <td>0.00</td>
      <td>-915.2</td>
      <td>36.89</td>
      <td>14.58</td>
      <td>-119.46</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>ALIBABA GROUP HOLDING ADR 1:8</th>
      <td>20.02</td>
      <td>0.00</td>
      <td>-1005.3</td>
      <td>38.71</td>
      <td>19.00</td>
      <td>-186.17</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>FACEBOOK CLASS A</th>
      <td>29.90</td>
      <td>0.00</td>
      <td>-1004.3</td>
      <td>34.90</td>
      <td>21.55</td>
      <td>-202.30</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>TENCENT HOLDINGS</th>
      <td>24.34</td>
      <td>0.23</td>
      <td>-993.7</td>
      <td>39.62</td>
      <td>17.53</td>
      <td>-149.03</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>ALPHABET A</th>
      <td>21.97</td>
      <td>0.00</td>
      <td>-1003.1</td>
      <td>33.06</td>
      <td>19.37</td>
      <td>-200.51</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>TESLA</th>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>WALMART</th>
      <td>-6.33</td>
      <td>1.54</td>
      <td>-1009.7</td>
      <td>35.16</td>
      <td>14.16</td>
      <td>-129.82</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>JOHNSON &amp; JOHNSON</th>
      <td>12.62</td>
      <td>2.71</td>
      <td>-1009.6</td>
      <td>40.30</td>
      <td>18.99</td>
      <td>-156.20</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>TAIWAN SEMICON.MNFG.</th>
      <td>46.70</td>
      <td>2.31</td>
      <td>-1011.6</td>
      <td>35.88</td>
      <td>20.57</td>
      <td>-190.88</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>NESTLE 'N'</th>
      <td>5.64</td>
      <td>2.47</td>
      <td>-1013.0</td>
      <td>37.99</td>
      <td>15.82</td>
      <td>-131.35</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Basically all the Numpy’s element-wise array methods work with Pandas objects.</p>
<p>Tesla looks a little bit better now (no negative returns). :)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">big_companies_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>DIVIDEND YIELD</th>
      <th>CASH FLOW/SALES</th>
      <th>RETURN ON EQUITY - TOTAL (%)</th>
      <th>RETURN ON INVESTED CAPITAL</th>
      <th>P/E - RATIO</th>
      <th>TOTAL DEBT % COMMON EQUITY</th>
    </tr>
    <tr>
      <th>NAME</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>APPLE</th>
      <td>0.71</td>
      <td>28.01</td>
      <td>55.92</td>
      <td>27.65</td>
      <td>35.4</td>
      <td>119.40</td>
    </tr>
    <tr>
      <th>SAUDI ARABIAN OIL</th>
      <td>0.21</td>
      <td>31.73</td>
      <td>32.25</td>
      <td>28.34</td>
      <td>29.5</td>
      <td>16.96</td>
    </tr>
    <tr>
      <th>MICROSOFT</th>
      <td>1.06</td>
      <td>43.46</td>
      <td>40.14</td>
      <td>24.89</td>
      <td>36.5</td>
      <td>61.56</td>
    </tr>
    <tr>
      <th>AMAZON.COM</th>
      <td>0.00</td>
      <td>14.60</td>
      <td>21.95</td>
      <td>12.97</td>
      <td>121.1</td>
      <td>83.31</td>
    </tr>
    <tr>
      <th>ALIBABA GROUP HOLDING ADR 1:8</th>
      <td>0.00</td>
      <td>31.23</td>
      <td>23.77</td>
      <td>17.39</td>
      <td>31.0</td>
      <td>16.60</td>
    </tr>
    <tr>
      <th>FACEBOOK CLASS A</th>
      <td>0.00</td>
      <td>41.11</td>
      <td>19.96</td>
      <td>19.94</td>
      <td>32.0</td>
      <td>0.47</td>
    </tr>
    <tr>
      <th>TENCENT HOLDINGS</th>
      <td>0.23</td>
      <td>35.55</td>
      <td>24.68</td>
      <td>15.92</td>
      <td>42.6</td>
      <td>53.74</td>
    </tr>
    <tr>
      <th>ALPHABET A</th>
      <td>0.00</td>
      <td>33.18</td>
      <td>18.12</td>
      <td>17.76</td>
      <td>33.2</td>
      <td>2.26</td>
    </tr>
    <tr>
      <th>TESLA</th>
      <td>0.00</td>
      <td>11.21</td>
      <td>14.94</td>
      <td>1.61</td>
      <td>1036.3</td>
      <td>202.77</td>
    </tr>
    <tr>
      <th>WALMART</th>
      <td>1.54</td>
      <td>4.88</td>
      <td>20.22</td>
      <td>12.55</td>
      <td>26.6</td>
      <td>72.95</td>
    </tr>
    <tr>
      <th>JOHNSON &amp; JOHNSON</th>
      <td>2.71</td>
      <td>23.83</td>
      <td>25.36</td>
      <td>17.38</td>
      <td>26.7</td>
      <td>46.57</td>
    </tr>
    <tr>
      <th>TAIWAN SEMICON.MNFG.</th>
      <td>2.31</td>
      <td>57.91</td>
      <td>20.94</td>
      <td>18.96</td>
      <td>24.7</td>
      <td>11.89</td>
    </tr>
    <tr>
      <th>NESTLE 'N'</th>
      <td>2.47</td>
      <td>16.85</td>
      <td>23.05</td>
      <td>14.21</td>
      <td>23.3</td>
      <td>71.42</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>If you want to apply a function to rows or columns of a dataframe, you can use <strong>apply</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">differ</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><strong>differ</strong> calculates the difference between the maximum and minimum of each column.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">big_companies_df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">differ</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>DIVIDEND YIELD                     2.71
CASH FLOW/SALES                   53.03
RETURN ON EQUITY - TOTAL (%)      70.86
RETURN ON INVESTED CAPITAL        29.95
P/E - RATIO                     1013.00
TOTAL DEBT % COMMON EQUITY       202.30
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>We can also do this row-wise.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">big_companies_df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">differ</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>NAME
APPLE                             118.69
SAUDI ARABIAN OIL                  32.04
MICROSOFT                          60.50
AMAZON.COM                        121.10
ALIBABA GROUP HOLDING ADR 1:8      31.23
FACEBOOK CLASS A                   41.11
TENCENT HOLDINGS                   53.51
ALPHABET A                         33.20
TESLA                            1051.24
WALMART                            71.41
JOHNSON &amp; JOHNSON                  43.86
TAIWAN SEMICON.MNFG.               55.60
NESTLE &#39;N&#39;                         68.95
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>For element-wise manipulations, you can use <strong>applymap()</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">big_companies_df</span><span class="o">.</span><span class="n">applymap</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="o">-</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>DIVIDEND YIELD</th>
      <th>CASH FLOW/SALES</th>
      <th>RETURN ON EQUITY - TOTAL (%)</th>
      <th>RETURN ON INVESTED CAPITAL</th>
      <th>P/E - RATIO</th>
      <th>TOTAL DEBT % COMMON EQUITY</th>
    </tr>
    <tr>
      <th>NAME</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>APPLE</th>
      <td>-0.71</td>
      <td>-28.01</td>
      <td>-55.92</td>
      <td>-27.65</td>
      <td>-35.4</td>
      <td>-119.40</td>
    </tr>
    <tr>
      <th>SAUDI ARABIAN OIL</th>
      <td>-0.21</td>
      <td>-31.73</td>
      <td>-32.25</td>
      <td>-28.34</td>
      <td>-29.5</td>
      <td>-16.96</td>
    </tr>
    <tr>
      <th>MICROSOFT</th>
      <td>-1.06</td>
      <td>-43.46</td>
      <td>-40.14</td>
      <td>-24.89</td>
      <td>-36.5</td>
      <td>-61.56</td>
    </tr>
    <tr>
      <th>AMAZON.COM</th>
      <td>-0.00</td>
      <td>-14.60</td>
      <td>-21.95</td>
      <td>-12.97</td>
      <td>-121.1</td>
      <td>-83.31</td>
    </tr>
    <tr>
      <th>ALIBABA GROUP HOLDING ADR 1:8</th>
      <td>-0.00</td>
      <td>-31.23</td>
      <td>-23.77</td>
      <td>-17.39</td>
      <td>-31.0</td>
      <td>-16.60</td>
    </tr>
    <tr>
      <th>FACEBOOK CLASS A</th>
      <td>-0.00</td>
      <td>-41.11</td>
      <td>-19.96</td>
      <td>-19.94</td>
      <td>-32.0</td>
      <td>-0.47</td>
    </tr>
    <tr>
      <th>TENCENT HOLDINGS</th>
      <td>-0.23</td>
      <td>-35.55</td>
      <td>-24.68</td>
      <td>-15.92</td>
      <td>-42.6</td>
      <td>-53.74</td>
    </tr>
    <tr>
      <th>ALPHABET A</th>
      <td>-0.00</td>
      <td>-33.18</td>
      <td>-18.12</td>
      <td>-17.76</td>
      <td>-33.2</td>
      <td>-2.26</td>
    </tr>
    <tr>
      <th>TESLA</th>
      <td>-0.00</td>
      <td>-11.21</td>
      <td>14.94</td>
      <td>1.61</td>
      <td>-1036.3</td>
      <td>-202.77</td>
    </tr>
    <tr>
      <th>WALMART</th>
      <td>-1.54</td>
      <td>-4.88</td>
      <td>-20.22</td>
      <td>-12.55</td>
      <td>-26.6</td>
      <td>-72.95</td>
    </tr>
    <tr>
      <th>JOHNSON &amp; JOHNSON</th>
      <td>-2.71</td>
      <td>-23.83</td>
      <td>-25.36</td>
      <td>-17.38</td>
      <td>-26.7</td>
      <td>-46.57</td>
    </tr>
    <tr>
      <th>TAIWAN SEMICON.MNFG.</th>
      <td>-2.31</td>
      <td>-57.91</td>
      <td>-20.94</td>
      <td>-18.96</td>
      <td>-24.7</td>
      <td>-11.89</td>
    </tr>
    <tr>
      <th>NESTLE 'N'</th>
      <td>-2.47</td>
      <td>-16.85</td>
      <td>-23.05</td>
      <td>-14.21</td>
      <td>-23.3</td>
      <td>-71.42</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>sort_index</strong> can be used for sorting.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">big_companies_df</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>DIVIDEND YIELD</th>
      <th>CASH FLOW/SALES</th>
      <th>RETURN ON EQUITY - TOTAL (%)</th>
      <th>RETURN ON INVESTED CAPITAL</th>
      <th>P/E - RATIO</th>
      <th>TOTAL DEBT % COMMON EQUITY</th>
    </tr>
    <tr>
      <th>NAME</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>ALIBABA GROUP HOLDING ADR 1:8</th>
      <td>0.00</td>
      <td>31.23</td>
      <td>23.77</td>
      <td>17.39</td>
      <td>31.0</td>
      <td>16.60</td>
    </tr>
    <tr>
      <th>ALPHABET A</th>
      <td>0.00</td>
      <td>33.18</td>
      <td>18.12</td>
      <td>17.76</td>
      <td>33.2</td>
      <td>2.26</td>
    </tr>
    <tr>
      <th>AMAZON.COM</th>
      <td>0.00</td>
      <td>14.60</td>
      <td>21.95</td>
      <td>12.97</td>
      <td>121.1</td>
      <td>83.31</td>
    </tr>
    <tr>
      <th>APPLE</th>
      <td>0.71</td>
      <td>28.01</td>
      <td>55.92</td>
      <td>27.65</td>
      <td>35.4</td>
      <td>119.40</td>
    </tr>
    <tr>
      <th>FACEBOOK CLASS A</th>
      <td>0.00</td>
      <td>41.11</td>
      <td>19.96</td>
      <td>19.94</td>
      <td>32.0</td>
      <td>0.47</td>
    </tr>
    <tr>
      <th>JOHNSON &amp; JOHNSON</th>
      <td>2.71</td>
      <td>23.83</td>
      <td>25.36</td>
      <td>17.38</td>
      <td>26.7</td>
      <td>46.57</td>
    </tr>
    <tr>
      <th>MICROSOFT</th>
      <td>1.06</td>
      <td>43.46</td>
      <td>40.14</td>
      <td>24.89</td>
      <td>36.5</td>
      <td>61.56</td>
    </tr>
    <tr>
      <th>NESTLE 'N'</th>
      <td>2.47</td>
      <td>16.85</td>
      <td>23.05</td>
      <td>14.21</td>
      <td>23.3</td>
      <td>71.42</td>
    </tr>
    <tr>
      <th>SAUDI ARABIAN OIL</th>
      <td>0.21</td>
      <td>31.73</td>
      <td>32.25</td>
      <td>28.34</td>
      <td>29.5</td>
      <td>16.96</td>
    </tr>
    <tr>
      <th>TAIWAN SEMICON.MNFG.</th>
      <td>2.31</td>
      <td>57.91</td>
      <td>20.94</td>
      <td>18.96</td>
      <td>24.7</td>
      <td>11.89</td>
    </tr>
    <tr>
      <th>TENCENT HOLDINGS</th>
      <td>0.23</td>
      <td>35.55</td>
      <td>24.68</td>
      <td>15.92</td>
      <td>42.6</td>
      <td>53.74</td>
    </tr>
    <tr>
      <th>TESLA</th>
      <td>0.00</td>
      <td>11.21</td>
      <td>-14.94</td>
      <td>-1.61</td>
      <td>1036.3</td>
      <td>202.77</td>
    </tr>
    <tr>
      <th>WALMART</th>
      <td>1.54</td>
      <td>4.88</td>
      <td>20.22</td>
      <td>12.55</td>
      <td>26.6</td>
      <td>72.95</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">big_companies_df</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CASH FLOW/SALES</th>
      <th>DIVIDEND YIELD</th>
      <th>P/E - RATIO</th>
      <th>RETURN ON EQUITY - TOTAL (%)</th>
      <th>RETURN ON INVESTED CAPITAL</th>
      <th>TOTAL DEBT % COMMON EQUITY</th>
    </tr>
    <tr>
      <th>NAME</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>APPLE</th>
      <td>28.01</td>
      <td>0.71</td>
      <td>35.4</td>
      <td>55.92</td>
      <td>27.65</td>
      <td>119.40</td>
    </tr>
    <tr>
      <th>SAUDI ARABIAN OIL</th>
      <td>31.73</td>
      <td>0.21</td>
      <td>29.5</td>
      <td>32.25</td>
      <td>28.34</td>
      <td>16.96</td>
    </tr>
    <tr>
      <th>MICROSOFT</th>
      <td>43.46</td>
      <td>1.06</td>
      <td>36.5</td>
      <td>40.14</td>
      <td>24.89</td>
      <td>61.56</td>
    </tr>
    <tr>
      <th>AMAZON.COM</th>
      <td>14.60</td>
      <td>0.00</td>
      <td>121.1</td>
      <td>21.95</td>
      <td>12.97</td>
      <td>83.31</td>
    </tr>
    <tr>
      <th>ALIBABA GROUP HOLDING ADR 1:8</th>
      <td>31.23</td>
      <td>0.00</td>
      <td>31.0</td>
      <td>23.77</td>
      <td>17.39</td>
      <td>16.60</td>
    </tr>
    <tr>
      <th>FACEBOOK CLASS A</th>
      <td>41.11</td>
      <td>0.00</td>
      <td>32.0</td>
      <td>19.96</td>
      <td>19.94</td>
      <td>0.47</td>
    </tr>
    <tr>
      <th>TENCENT HOLDINGS</th>
      <td>35.55</td>
      <td>0.23</td>
      <td>42.6</td>
      <td>24.68</td>
      <td>15.92</td>
      <td>53.74</td>
    </tr>
    <tr>
      <th>ALPHABET A</th>
      <td>33.18</td>
      <td>0.00</td>
      <td>33.2</td>
      <td>18.12</td>
      <td>17.76</td>
      <td>2.26</td>
    </tr>
    <tr>
      <th>TESLA</th>
      <td>11.21</td>
      <td>0.00</td>
      <td>1036.3</td>
      <td>-14.94</td>
      <td>-1.61</td>
      <td>202.77</td>
    </tr>
    <tr>
      <th>WALMART</th>
      <td>4.88</td>
      <td>1.54</td>
      <td>26.6</td>
      <td>20.22</td>
      <td>12.55</td>
      <td>72.95</td>
    </tr>
    <tr>
      <th>JOHNSON &amp; JOHNSON</th>
      <td>23.83</td>
      <td>2.71</td>
      <td>26.7</td>
      <td>25.36</td>
      <td>17.38</td>
      <td>46.57</td>
    </tr>
    <tr>
      <th>TAIWAN SEMICON.MNFG.</th>
      <td>57.91</td>
      <td>2.31</td>
      <td>24.7</td>
      <td>20.94</td>
      <td>18.96</td>
      <td>11.89</td>
    </tr>
    <tr>
      <th>NESTLE 'N'</th>
      <td>16.85</td>
      <td>2.47</td>
      <td>23.3</td>
      <td>23.05</td>
      <td>14.21</td>
      <td>71.42</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>If you want sort by values, you can use <strong>sort_values()</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">big_companies_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s1">&#39;P/E - RATIO&#39;</span><span class="p">,</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>DIVIDEND YIELD</th>
      <th>CASH FLOW/SALES</th>
      <th>RETURN ON EQUITY - TOTAL (%)</th>
      <th>RETURN ON INVESTED CAPITAL</th>
      <th>P/E - RATIO</th>
      <th>TOTAL DEBT % COMMON EQUITY</th>
    </tr>
    <tr>
      <th>NAME</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>TESLA</th>
      <td>0.00</td>
      <td>11.21</td>
      <td>-14.94</td>
      <td>-1.61</td>
      <td>1036.3</td>
      <td>202.77</td>
    </tr>
    <tr>
      <th>AMAZON.COM</th>
      <td>0.00</td>
      <td>14.60</td>
      <td>21.95</td>
      <td>12.97</td>
      <td>121.1</td>
      <td>83.31</td>
    </tr>
    <tr>
      <th>TENCENT HOLDINGS</th>
      <td>0.23</td>
      <td>35.55</td>
      <td>24.68</td>
      <td>15.92</td>
      <td>42.6</td>
      <td>53.74</td>
    </tr>
    <tr>
      <th>MICROSOFT</th>
      <td>1.06</td>
      <td>43.46</td>
      <td>40.14</td>
      <td>24.89</td>
      <td>36.5</td>
      <td>61.56</td>
    </tr>
    <tr>
      <th>APPLE</th>
      <td>0.71</td>
      <td>28.01</td>
      <td>55.92</td>
      <td>27.65</td>
      <td>35.4</td>
      <td>119.40</td>
    </tr>
    <tr>
      <th>ALPHABET A</th>
      <td>0.00</td>
      <td>33.18</td>
      <td>18.12</td>
      <td>17.76</td>
      <td>33.2</td>
      <td>2.26</td>
    </tr>
    <tr>
      <th>FACEBOOK CLASS A</th>
      <td>0.00</td>
      <td>41.11</td>
      <td>19.96</td>
      <td>19.94</td>
      <td>32.0</td>
      <td>0.47</td>
    </tr>
    <tr>
      <th>ALIBABA GROUP HOLDING ADR 1:8</th>
      <td>0.00</td>
      <td>31.23</td>
      <td>23.77</td>
      <td>17.39</td>
      <td>31.0</td>
      <td>16.60</td>
    </tr>
    <tr>
      <th>SAUDI ARABIAN OIL</th>
      <td>0.21</td>
      <td>31.73</td>
      <td>32.25</td>
      <td>28.34</td>
      <td>29.5</td>
      <td>16.96</td>
    </tr>
    <tr>
      <th>JOHNSON &amp; JOHNSON</th>
      <td>2.71</td>
      <td>23.83</td>
      <td>25.36</td>
      <td>17.38</td>
      <td>26.7</td>
      <td>46.57</td>
    </tr>
    <tr>
      <th>WALMART</th>
      <td>1.54</td>
      <td>4.88</td>
      <td>20.22</td>
      <td>12.55</td>
      <td>26.6</td>
      <td>72.95</td>
    </tr>
    <tr>
      <th>TAIWAN SEMICON.MNFG.</th>
      <td>2.31</td>
      <td>57.91</td>
      <td>20.94</td>
      <td>18.96</td>
      <td>24.7</td>
      <td>11.89</td>
    </tr>
    <tr>
      <th>NESTLE 'N'</th>
      <td>2.47</td>
      <td>16.85</td>
      <td>23.05</td>
      <td>14.21</td>
      <td>23.3</td>
      <td>71.42</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>You can use many colums when sorting by values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">big_companies_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;DIVIDEND YIELD&#39;</span><span class="p">,</span><span class="s1">&#39;P/E - RATIO&#39;</span><span class="p">],</span><span class="n">ascending</span><span class="o">=</span><span class="p">[</span><span class="kc">True</span><span class="p">,</span><span class="kc">False</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>DIVIDEND YIELD</th>
      <th>CASH FLOW/SALES</th>
      <th>RETURN ON EQUITY - TOTAL (%)</th>
      <th>RETURN ON INVESTED CAPITAL</th>
      <th>P/E - RATIO</th>
      <th>TOTAL DEBT % COMMON EQUITY</th>
    </tr>
    <tr>
      <th>NAME</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>TESLA</th>
      <td>0.00</td>
      <td>11.21</td>
      <td>-14.94</td>
      <td>-1.61</td>
      <td>1036.3</td>
      <td>202.77</td>
    </tr>
    <tr>
      <th>AMAZON.COM</th>
      <td>0.00</td>
      <td>14.60</td>
      <td>21.95</td>
      <td>12.97</td>
      <td>121.1</td>
      <td>83.31</td>
    </tr>
    <tr>
      <th>ALPHABET A</th>
      <td>0.00</td>
      <td>33.18</td>
      <td>18.12</td>
      <td>17.76</td>
      <td>33.2</td>
      <td>2.26</td>
    </tr>
    <tr>
      <th>FACEBOOK CLASS A</th>
      <td>0.00</td>
      <td>41.11</td>
      <td>19.96</td>
      <td>19.94</td>
      <td>32.0</td>
      <td>0.47</td>
    </tr>
    <tr>
      <th>ALIBABA GROUP HOLDING ADR 1:8</th>
      <td>0.00</td>
      <td>31.23</td>
      <td>23.77</td>
      <td>17.39</td>
      <td>31.0</td>
      <td>16.60</td>
    </tr>
    <tr>
      <th>SAUDI ARABIAN OIL</th>
      <td>0.21</td>
      <td>31.73</td>
      <td>32.25</td>
      <td>28.34</td>
      <td>29.5</td>
      <td>16.96</td>
    </tr>
    <tr>
      <th>TENCENT HOLDINGS</th>
      <td>0.23</td>
      <td>35.55</td>
      <td>24.68</td>
      <td>15.92</td>
      <td>42.6</td>
      <td>53.74</td>
    </tr>
    <tr>
      <th>APPLE</th>
      <td>0.71</td>
      <td>28.01</td>
      <td>55.92</td>
      <td>27.65</td>
      <td>35.4</td>
      <td>119.40</td>
    </tr>
    <tr>
      <th>MICROSOFT</th>
      <td>1.06</td>
      <td>43.46</td>
      <td>40.14</td>
      <td>24.89</td>
      <td>36.5</td>
      <td>61.56</td>
    </tr>
    <tr>
      <th>WALMART</th>
      <td>1.54</td>
      <td>4.88</td>
      <td>20.22</td>
      <td>12.55</td>
      <td>26.6</td>
      <td>72.95</td>
    </tr>
    <tr>
      <th>TAIWAN SEMICON.MNFG.</th>
      <td>2.31</td>
      <td>57.91</td>
      <td>20.94</td>
      <td>18.96</td>
      <td>24.7</td>
      <td>11.89</td>
    </tr>
    <tr>
      <th>NESTLE 'N'</th>
      <td>2.47</td>
      <td>16.85</td>
      <td>23.05</td>
      <td>14.21</td>
      <td>23.3</td>
      <td>71.42</td>
    </tr>
    <tr>
      <th>JOHNSON &amp; JOHNSON</th>
      <td>2.71</td>
      <td>23.83</td>
      <td>25.36</td>
      <td>17.38</td>
      <td>26.7</td>
      <td>46.57</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="1_Intro_to_Python.html" title="previous page"><span class="section-number">2. </span>Introduction to Python</a>
    <a class='right-next' id="next-link" href="3_Pandas_data_preprocessing.html" title="next page"><span class="section-number">4. </span>Pandas Data preprocessing</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Mikko Ranta<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>