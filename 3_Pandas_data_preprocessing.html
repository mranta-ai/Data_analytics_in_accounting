
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>4. Pandas Data preprocessing &#8212; Data analytics in accounting</title>
    
  <link rel="stylesheet" href="_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="_static/sphinx-book-theme.2d2078699c18a0efb88233928e1cf6ed.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.be0a4a0c39cd630af62a2fcf693f3f06.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="5. Connecting with accounting databases" href="4_Connecting_with_accounting_databases.html" />
    <link rel="prev" title="3. Pandas data basics" href="2_Pandas_basics.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  <img src="_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Data analytics in accounting</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="book_intro.html">
   Introduction to data analytics in accounting
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Basic data analytics in accounting
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="0_installing_Python.html">
   1. Installing Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="1_Intro_to_Python.html">
   2. Introduction to Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2_Pandas_basics.html">
   3. Pandas data basics
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   4. Pandas Data preprocessing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="4_Connecting_with_accounting_databases.html">
   5. Connecting with accounting databases
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="5_Visualisation_with_Python.html">
   6. Visualisations with Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="6_Basic_statistics_with_Python.html">
   7. Basic statistics with Python
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Machine learning in accounting
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="7_Introduction_to_ML_in_accounting.html">
   1. Introduction to Machine learning in accounting
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="8_Decision_making_in_accounting.html">
   2. Decision making with ML in accounting
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="9_Deep_learning_in_accounting.html">
   3. Deep learning in accounting
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="10_NLP_in_accounting.html">
   4. Introduction to natural language processing
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/3_Pandas_data_preprocessing.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/3_Pandas_data_preprocessing.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#basic-methods">
   4.1. Basic methods
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#advanced-methods">
   4.2. Advanced methods
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#merging-datasets">
   4.3. Merging datasets
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data-aggreagation">
   4.4. Data aggreagation
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#data-aggregation">
     4.4.1. Data aggregation
    </a>
   </li>
  </ul>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="pandas-data-preprocessing">
<h1><span class="section-number">4. </span>Pandas Data preprocessing<a class="headerlink" href="#pandas-data-preprocessing" title="Permalink to this headline">¶</a></h1>
<p>You might be wondering why we are talking so much about data processing and manipulation in this book. “Where are all the fancy ML methods” you might  ask. Unfortunately, most of the time in data science goes to data pre-processing. It is often reported that 80 % of a data scientist’s time goes to data preparation: cleaning, transforming, rearranging and creating suitable features (feature engineering). So, to be a succesfull data scientist, you need know how to play with data. Luckily, we have Pandas at our disposal, wich is one of the most powerful data manipulation tools available.</p>
<p>Let’s look at some of the most common preprocessing situatsions we encounter when doing data science.</p>
<div class="section" id="basic-methods">
<h2><span class="section-number">4.1. </span>Basic methods<a class="headerlink" href="#basic-methods" title="Permalink to this headline">¶</a></h2>
<p>Missing data is probably the most common issue with data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">companies_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;emissions.csv&#39;</span><span class="p">,</span><span class="n">index_col</span><span class="o">=</span><span class="s1">&#39;NAME&#39;</span><span class="p">,</span><span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">companies_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Board member compensation</th>
      <th>Total CO2 To Revenues</th>
      <th>Emission Reduction Target %</th>
    </tr>
    <tr>
      <th>NAME</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>APPLE</th>
      <td>2832025.00</td>
      <td>3.13</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>SAUDI ARABIAN OIL</th>
      <td>3220550.15</td>
      <td>175.59</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>MICROSOFT</th>
      <td>4336000.00</td>
      <td>29.16</td>
      <td>75.0</td>
    </tr>
    <tr>
      <th>AMAZON.COM</th>
      <td>6567669.00</td>
      <td>40.14</td>
      <td>50.0</td>
    </tr>
    <tr>
      <th>ALIBABA GROUP HOLDING ADR 1:8</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>FACEBOOK CLASS A</th>
      <td>2291182.00</td>
      <td>25.69</td>
      <td>75.0</td>
    </tr>
    <tr>
      <th>TENCENT HOLDINGS</th>
      <td>2681758.80</td>
      <td>15.81</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>ALPHABET A</th>
      <td>50294471.00</td>
      <td>32.22</td>
      <td>50.0</td>
    </tr>
    <tr>
      <th>TESLA</th>
      <td>17315009.00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>TAIWAN SEMICON.MNFG.</th>
      <td>12584165.55</td>
      <td>245.17</td>
      <td>18.0</td>
    </tr>
    <tr>
      <th>NESTLE 'N'</th>
      <td>12906002.11</td>
      <td>58.52</td>
      <td>35.0</td>
    </tr>
    <tr>
      <th>NVIDIA</th>
      <td>NaN</td>
      <td>7.10</td>
      <td>25.0</td>
    </tr>
    <tr>
      <th>SAMSUNG ELECTRONICS</th>
      <td>NaN</td>
      <td>69.06</td>
      <td>70.0</td>
    </tr>
    <tr>
      <th>JP MORGAN CHASE &amp; CO.</th>
      <td>4460719.00</td>
      <td>6.69</td>
      <td>50.0</td>
    </tr>
    <tr>
      <th>KWEICHOW MOUTAI 'A'</th>
      <td>40219.20</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>NETFLIX</th>
      <td>3665870.00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>Dropna</strong> can be used to filter out missing data. The <strong>how</strong> parameter defines do all/any of the values in rows/columns need to be zero for dropping.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">companies_df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Board member compensation</th>
      <th>Total CO2 To Revenues</th>
      <th>Emission Reduction Target %</th>
    </tr>
    <tr>
      <th>NAME</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>APPLE</th>
      <td>2832025.00</td>
      <td>3.13</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>SAUDI ARABIAN OIL</th>
      <td>3220550.15</td>
      <td>175.59</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>MICROSOFT</th>
      <td>4336000.00</td>
      <td>29.16</td>
      <td>75.0</td>
    </tr>
    <tr>
      <th>AMAZON.COM</th>
      <td>6567669.00</td>
      <td>40.14</td>
      <td>50.0</td>
    </tr>
    <tr>
      <th>FACEBOOK CLASS A</th>
      <td>2291182.00</td>
      <td>25.69</td>
      <td>75.0</td>
    </tr>
    <tr>
      <th>TENCENT HOLDINGS</th>
      <td>2681758.80</td>
      <td>15.81</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>ALPHABET A</th>
      <td>50294471.00</td>
      <td>32.22</td>
      <td>50.0</td>
    </tr>
    <tr>
      <th>TESLA</th>
      <td>17315009.00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>TAIWAN SEMICON.MNFG.</th>
      <td>12584165.55</td>
      <td>245.17</td>
      <td>18.0</td>
    </tr>
    <tr>
      <th>NESTLE 'N'</th>
      <td>12906002.11</td>
      <td>58.52</td>
      <td>35.0</td>
    </tr>
    <tr>
      <th>NVIDIA</th>
      <td>NaN</td>
      <td>7.10</td>
      <td>25.0</td>
    </tr>
    <tr>
      <th>SAMSUNG ELECTRONICS</th>
      <td>NaN</td>
      <td>69.06</td>
      <td>70.0</td>
    </tr>
    <tr>
      <th>JP MORGAN CHASE &amp; CO.</th>
      <td>4460719.00</td>
      <td>6.69</td>
      <td>50.0</td>
    </tr>
    <tr>
      <th>KWEICHOW MOUTAI 'A'</th>
      <td>40219.20</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>NETFLIX</th>
      <td>3665870.00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">companies_df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;any&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Board member compensation</th>
      <th>Total CO2 To Revenues</th>
      <th>Emission Reduction Target %</th>
    </tr>
    <tr>
      <th>NAME</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>MICROSOFT</th>
      <td>4336000.00</td>
      <td>29.16</td>
      <td>75.0</td>
    </tr>
    <tr>
      <th>AMAZON.COM</th>
      <td>6567669.00</td>
      <td>40.14</td>
      <td>50.0</td>
    </tr>
    <tr>
      <th>FACEBOOK CLASS A</th>
      <td>2291182.00</td>
      <td>25.69</td>
      <td>75.0</td>
    </tr>
    <tr>
      <th>ALPHABET A</th>
      <td>50294471.00</td>
      <td>32.22</td>
      <td>50.0</td>
    </tr>
    <tr>
      <th>TAIWAN SEMICON.MNFG.</th>
      <td>12584165.55</td>
      <td>245.17</td>
      <td>18.0</td>
    </tr>
    <tr>
      <th>NESTLE 'N'</th>
      <td>12906002.11</td>
      <td>58.52</td>
      <td>35.0</td>
    </tr>
    <tr>
      <th>JP MORGAN CHASE &amp; CO.</th>
      <td>4460719.00</td>
      <td>6.69</td>
      <td>50.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>You can again use the <strong>axis</strong> parameter. However, it is not meaningful to use here because every column has NaN-values (<strong>any</strong> returns an empty table), and not all values are NaN in any column (<strong>all</strong> returns the original dataframe).</p>
<p>With <strong>thresh</strong> you can define how many of the values are allowed to be NaN.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">companies_df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">thresh</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Board member compensation</th>
      <th>Total CO2 To Revenues</th>
      <th>Emission Reduction Target %</th>
    </tr>
    <tr>
      <th>NAME</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>APPLE</th>
      <td>2832025.00</td>
      <td>3.13</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>SAUDI ARABIAN OIL</th>
      <td>3220550.15</td>
      <td>175.59</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>MICROSOFT</th>
      <td>4336000.00</td>
      <td>29.16</td>
      <td>75.0</td>
    </tr>
    <tr>
      <th>AMAZON.COM</th>
      <td>6567669.00</td>
      <td>40.14</td>
      <td>50.0</td>
    </tr>
    <tr>
      <th>FACEBOOK CLASS A</th>
      <td>2291182.00</td>
      <td>25.69</td>
      <td>75.0</td>
    </tr>
    <tr>
      <th>TENCENT HOLDINGS</th>
      <td>2681758.80</td>
      <td>15.81</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>ALPHABET A</th>
      <td>50294471.00</td>
      <td>32.22</td>
      <td>50.0</td>
    </tr>
    <tr>
      <th>TAIWAN SEMICON.MNFG.</th>
      <td>12584165.55</td>
      <td>245.17</td>
      <td>18.0</td>
    </tr>
    <tr>
      <th>NESTLE 'N'</th>
      <td>12906002.11</td>
      <td>58.52</td>
      <td>35.0</td>
    </tr>
    <tr>
      <th>NVIDIA</th>
      <td>NaN</td>
      <td>7.10</td>
      <td>25.0</td>
    </tr>
    <tr>
      <th>SAMSUNG ELECTRONICS</th>
      <td>NaN</td>
      <td>69.06</td>
      <td>70.0</td>
    </tr>
    <tr>
      <th>JP MORGAN CHASE &amp; CO.</th>
      <td>4460719.00</td>
      <td>6.69</td>
      <td>50.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>You can use <strong>fillna</strong> to fill NaN values with other values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">companies_df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Board member compensation</th>
      <th>Total CO2 To Revenues</th>
      <th>Emission Reduction Target %</th>
    </tr>
    <tr>
      <th>NAME</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>APPLE</th>
      <td>2832025.00</td>
      <td>3.13</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>SAUDI ARABIAN OIL</th>
      <td>3220550.15</td>
      <td>175.59</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>MICROSOFT</th>
      <td>4336000.00</td>
      <td>29.16</td>
      <td>75.0</td>
    </tr>
    <tr>
      <th>AMAZON.COM</th>
      <td>6567669.00</td>
      <td>40.14</td>
      <td>50.0</td>
    </tr>
    <tr>
      <th>ALIBABA GROUP HOLDING ADR 1:8</th>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>FACEBOOK CLASS A</th>
      <td>2291182.00</td>
      <td>25.69</td>
      <td>75.0</td>
    </tr>
    <tr>
      <th>TENCENT HOLDINGS</th>
      <td>2681758.80</td>
      <td>15.81</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>ALPHABET A</th>
      <td>50294471.00</td>
      <td>32.22</td>
      <td>50.0</td>
    </tr>
    <tr>
      <th>TESLA</th>
      <td>17315009.00</td>
      <td>0.00</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>TAIWAN SEMICON.MNFG.</th>
      <td>12584165.55</td>
      <td>245.17</td>
      <td>18.0</td>
    </tr>
    <tr>
      <th>NESTLE 'N'</th>
      <td>12906002.11</td>
      <td>58.52</td>
      <td>35.0</td>
    </tr>
    <tr>
      <th>NVIDIA</th>
      <td>0.00</td>
      <td>7.10</td>
      <td>25.0</td>
    </tr>
    <tr>
      <th>SAMSUNG ELECTRONICS</th>
      <td>0.00</td>
      <td>69.06</td>
      <td>70.0</td>
    </tr>
    <tr>
      <th>JP MORGAN CHASE &amp; CO.</th>
      <td>4460719.00</td>
      <td>6.69</td>
      <td>50.0</td>
    </tr>
    <tr>
      <th>KWEICHOW MOUTAI 'A'</th>
      <td>40219.20</td>
      <td>0.00</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>NETFLIX</th>
      <td>3665870.00</td>
      <td>0.00</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Using a dict, you can define different fill values for different columns. A very common choice is to use the mean value of each column.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">companies_df</span><span class="o">.</span><span class="n">fillna</span><span class="p">({</span><span class="s1">&#39;Board member compensation&#39;</span><span class="p">:</span><span class="mi">1000000</span><span class="p">,</span> <span class="s1">&#39;Total CO2 To Revenues&#39;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span>
       <span class="s1">&#39;Emission Reduction Target %&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Board member compensation</th>
      <th>Total CO2 To Revenues</th>
      <th>Emission Reduction Target %</th>
    </tr>
    <tr>
      <th>NAME</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>APPLE</th>
      <td>2832025.00</td>
      <td>3.13</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>SAUDI ARABIAN OIL</th>
      <td>3220550.15</td>
      <td>175.59</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>MICROSOFT</th>
      <td>4336000.00</td>
      <td>29.16</td>
      <td>75.0</td>
    </tr>
    <tr>
      <th>AMAZON.COM</th>
      <td>6567669.00</td>
      <td>40.14</td>
      <td>50.0</td>
    </tr>
    <tr>
      <th>ALIBABA GROUP HOLDING ADR 1:8</th>
      <td>1000000.00</td>
      <td>10.00</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>FACEBOOK CLASS A</th>
      <td>2291182.00</td>
      <td>25.69</td>
      <td>75.0</td>
    </tr>
    <tr>
      <th>TENCENT HOLDINGS</th>
      <td>2681758.80</td>
      <td>15.81</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>ALPHABET A</th>
      <td>50294471.00</td>
      <td>32.22</td>
      <td>50.0</td>
    </tr>
    <tr>
      <th>TESLA</th>
      <td>17315009.00</td>
      <td>10.00</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>TAIWAN SEMICON.MNFG.</th>
      <td>12584165.55</td>
      <td>245.17</td>
      <td>18.0</td>
    </tr>
    <tr>
      <th>NESTLE 'N'</th>
      <td>12906002.11</td>
      <td>58.52</td>
      <td>35.0</td>
    </tr>
    <tr>
      <th>NVIDIA</th>
      <td>1000000.00</td>
      <td>7.10</td>
      <td>25.0</td>
    </tr>
    <tr>
      <th>SAMSUNG ELECTRONICS</th>
      <td>1000000.00</td>
      <td>69.06</td>
      <td>70.0</td>
    </tr>
    <tr>
      <th>JP MORGAN CHASE &amp; CO.</th>
      <td>4460719.00</td>
      <td>6.69</td>
      <td>50.0</td>
    </tr>
    <tr>
      <th>KWEICHOW MOUTAI 'A'</th>
      <td>40219.20</td>
      <td>10.00</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>NETFLIX</th>
      <td>3665870.00</td>
      <td>10.00</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Interpolation methods that were available for reindexing can be used with fillna.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">companies_df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;bfill&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Board member compensation</th>
      <th>Total CO2 To Revenues</th>
      <th>Emission Reduction Target %</th>
    </tr>
    <tr>
      <th>NAME</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>APPLE</th>
      <td>2832025.00</td>
      <td>3.13</td>
      <td>75.0</td>
    </tr>
    <tr>
      <th>SAUDI ARABIAN OIL</th>
      <td>3220550.15</td>
      <td>175.59</td>
      <td>75.0</td>
    </tr>
    <tr>
      <th>MICROSOFT</th>
      <td>4336000.00</td>
      <td>29.16</td>
      <td>75.0</td>
    </tr>
    <tr>
      <th>AMAZON.COM</th>
      <td>6567669.00</td>
      <td>40.14</td>
      <td>50.0</td>
    </tr>
    <tr>
      <th>ALIBABA GROUP HOLDING ADR 1:8</th>
      <td>2291182.00</td>
      <td>25.69</td>
      <td>75.0</td>
    </tr>
    <tr>
      <th>FACEBOOK CLASS A</th>
      <td>2291182.00</td>
      <td>25.69</td>
      <td>75.0</td>
    </tr>
    <tr>
      <th>TENCENT HOLDINGS</th>
      <td>2681758.80</td>
      <td>15.81</td>
      <td>50.0</td>
    </tr>
    <tr>
      <th>ALPHABET A</th>
      <td>50294471.00</td>
      <td>32.22</td>
      <td>50.0</td>
    </tr>
    <tr>
      <th>TESLA</th>
      <td>17315009.00</td>
      <td>245.17</td>
      <td>18.0</td>
    </tr>
    <tr>
      <th>TAIWAN SEMICON.MNFG.</th>
      <td>12584165.55</td>
      <td>245.17</td>
      <td>18.0</td>
    </tr>
    <tr>
      <th>NESTLE 'N'</th>
      <td>12906002.11</td>
      <td>58.52</td>
      <td>35.0</td>
    </tr>
    <tr>
      <th>NVIDIA</th>
      <td>4460719.00</td>
      <td>7.10</td>
      <td>25.0</td>
    </tr>
    <tr>
      <th>SAMSUNG ELECTRONICS</th>
      <td>4460719.00</td>
      <td>69.06</td>
      <td>70.0</td>
    </tr>
    <tr>
      <th>JP MORGAN CHASE &amp; CO.</th>
      <td>4460719.00</td>
      <td>6.69</td>
      <td>50.0</td>
    </tr>
    <tr>
      <th>KWEICHOW MOUTAI 'A'</th>
      <td>40219.20</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>NETFLIX</th>
      <td>3665870.00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>duplicated()</strong> can be used to drop duplicated rows. It drops only duplicates that are next to each other</p>
<p>More about <strong>append()</strong> later. Here we just build a new dataframe with companies_df in it twice. And then we sort the index so that every company is twice in the new dataframe.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">new_df</span> <span class="o">=</span> <span class="n">companies_df</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">companies_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">new_df</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">new_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Board member compensation</th>
      <th>Total CO2 To Revenues</th>
      <th>Emission Reduction Target %</th>
    </tr>
    <tr>
      <th>NAME</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>ALIBABA GROUP HOLDING ADR 1:8</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>ALIBABA GROUP HOLDING ADR 1:8</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>ALPHABET A</th>
      <td>50294471.00</td>
      <td>32.22</td>
      <td>50.0</td>
    </tr>
    <tr>
      <th>ALPHABET A</th>
      <td>50294471.00</td>
      <td>32.22</td>
      <td>50.0</td>
    </tr>
    <tr>
      <th>AMAZON.COM</th>
      <td>6567669.00</td>
      <td>40.14</td>
      <td>50.0</td>
    </tr>
    <tr>
      <th>AMAZON.COM</th>
      <td>6567669.00</td>
      <td>40.14</td>
      <td>50.0</td>
    </tr>
    <tr>
      <th>APPLE</th>
      <td>2832025.00</td>
      <td>3.13</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>APPLE</th>
      <td>2832025.00</td>
      <td>3.13</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>FACEBOOK CLASS A</th>
      <td>2291182.00</td>
      <td>25.69</td>
      <td>75.0</td>
    </tr>
    <tr>
      <th>FACEBOOK CLASS A</th>
      <td>2291182.00</td>
      <td>25.69</td>
      <td>75.0</td>
    </tr>
    <tr>
      <th>JP MORGAN CHASE &amp; CO.</th>
      <td>4460719.00</td>
      <td>6.69</td>
      <td>50.0</td>
    </tr>
    <tr>
      <th>JP MORGAN CHASE &amp; CO.</th>
      <td>4460719.00</td>
      <td>6.69</td>
      <td>50.0</td>
    </tr>
    <tr>
      <th>KWEICHOW MOUTAI 'A'</th>
      <td>40219.20</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>KWEICHOW MOUTAI 'A'</th>
      <td>40219.20</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>MICROSOFT</th>
      <td>4336000.00</td>
      <td>29.16</td>
      <td>75.0</td>
    </tr>
    <tr>
      <th>MICROSOFT</th>
      <td>4336000.00</td>
      <td>29.16</td>
      <td>75.0</td>
    </tr>
    <tr>
      <th>NESTLE 'N'</th>
      <td>12906002.11</td>
      <td>58.52</td>
      <td>35.0</td>
    </tr>
    <tr>
      <th>NESTLE 'N'</th>
      <td>12906002.11</td>
      <td>58.52</td>
      <td>35.0</td>
    </tr>
    <tr>
      <th>NETFLIX</th>
      <td>3665870.00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>NETFLIX</th>
      <td>3665870.00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>NVIDIA</th>
      <td>NaN</td>
      <td>7.10</td>
      <td>25.0</td>
    </tr>
    <tr>
      <th>NVIDIA</th>
      <td>NaN</td>
      <td>7.10</td>
      <td>25.0</td>
    </tr>
    <tr>
      <th>SAMSUNG ELECTRONICS</th>
      <td>NaN</td>
      <td>69.06</td>
      <td>70.0</td>
    </tr>
    <tr>
      <th>SAMSUNG ELECTRONICS</th>
      <td>NaN</td>
      <td>69.06</td>
      <td>70.0</td>
    </tr>
    <tr>
      <th>SAUDI ARABIAN OIL</th>
      <td>3220550.15</td>
      <td>175.59</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>SAUDI ARABIAN OIL</th>
      <td>3220550.15</td>
      <td>175.59</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>TAIWAN SEMICON.MNFG.</th>
      <td>12584165.55</td>
      <td>245.17</td>
      <td>18.0</td>
    </tr>
    <tr>
      <th>TAIWAN SEMICON.MNFG.</th>
      <td>12584165.55</td>
      <td>245.17</td>
      <td>18.0</td>
    </tr>
    <tr>
      <th>TENCENT HOLDINGS</th>
      <td>2681758.80</td>
      <td>15.81</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>TENCENT HOLDINGS</th>
      <td>2681758.80</td>
      <td>15.81</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>TESLA</th>
      <td>17315009.00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>TESLA</th>
      <td>17315009.00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">new_df</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>NAME
ALIBABA GROUP HOLDING ADR 1:8    False
ALIBABA GROUP HOLDING ADR 1:8     True
ALPHABET A                       False
ALPHABET A                        True
AMAZON.COM                       False
AMAZON.COM                        True
APPLE                            False
APPLE                             True
FACEBOOK CLASS A                 False
FACEBOOK CLASS A                  True
JP MORGAN CHASE &amp; CO.            False
JP MORGAN CHASE &amp; CO.             True
KWEICHOW MOUTAI &#39;A&#39;              False
KWEICHOW MOUTAI &#39;A&#39;               True
MICROSOFT                        False
MICROSOFT                         True
NESTLE &#39;N&#39;                       False
NESTLE &#39;N&#39;                        True
NETFLIX                          False
NETFLIX                           True
NVIDIA                           False
NVIDIA                            True
SAMSUNG ELECTRONICS              False
SAMSUNG ELECTRONICS               True
SAUDI ARABIAN OIL                False
SAUDI ARABIAN OIL                 True
TAIWAN SEMICON.MNFG.             False
TAIWAN SEMICON.MNFG.              True
TENCENT HOLDINGS                 False
TENCENT HOLDINGS                  True
TESLA                            False
TESLA                             True
dtype: bool
</pre></div>
</div>
</div>
</div>
<p>We can remove duplicated rows using <strong>drop_duplicated()</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">new_df</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Board member compensation</th>
      <th>Total CO2 To Revenues</th>
      <th>Emission Reduction Target %</th>
    </tr>
    <tr>
      <th>NAME</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>ALIBABA GROUP HOLDING ADR 1:8</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>ALPHABET A</th>
      <td>50294471.00</td>
      <td>32.22</td>
      <td>50.0</td>
    </tr>
    <tr>
      <th>AMAZON.COM</th>
      <td>6567669.00</td>
      <td>40.14</td>
      <td>50.0</td>
    </tr>
    <tr>
      <th>APPLE</th>
      <td>2832025.00</td>
      <td>3.13</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>FACEBOOK CLASS A</th>
      <td>2291182.00</td>
      <td>25.69</td>
      <td>75.0</td>
    </tr>
    <tr>
      <th>JP MORGAN CHASE &amp; CO.</th>
      <td>4460719.00</td>
      <td>6.69</td>
      <td>50.0</td>
    </tr>
    <tr>
      <th>KWEICHOW MOUTAI 'A'</th>
      <td>40219.20</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>MICROSOFT</th>
      <td>4336000.00</td>
      <td>29.16</td>
      <td>75.0</td>
    </tr>
    <tr>
      <th>NESTLE 'N'</th>
      <td>12906002.11</td>
      <td>58.52</td>
      <td>35.0</td>
    </tr>
    <tr>
      <th>NETFLIX</th>
      <td>3665870.00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>NVIDIA</th>
      <td>NaN</td>
      <td>7.10</td>
      <td>25.0</td>
    </tr>
    <tr>
      <th>SAMSUNG ELECTRONICS</th>
      <td>NaN</td>
      <td>69.06</td>
      <td>70.0</td>
    </tr>
    <tr>
      <th>SAUDI ARABIAN OIL</th>
      <td>3220550.15</td>
      <td>175.59</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>TAIWAN SEMICON.MNFG.</th>
      <td>12584165.55</td>
      <td>245.17</td>
      <td>18.0</td>
    </tr>
    <tr>
      <th>TENCENT HOLDINGS</th>
      <td>2681758.80</td>
      <td>15.81</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>TESLA</th>
      <td>17315009.00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>It is easy to apply function transformation to rows, columns or individual cells of a dataframe. <strong>map</strong> -metohd can be used for that.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">companies_df</span><span class="p">[</span><span class="s1">&#39;Compensation ($ millions)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">companies_df</span><span class="p">[</span><span class="s1">&#39;Board member compensation&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
    <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s2">&quot;</span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="mi">1000000</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot; M$&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">companies_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Board member compensation</th>
      <th>Total CO2 To Revenues</th>
      <th>Emission Reduction Target %</th>
      <th>Compensation ($ millions)</th>
    </tr>
    <tr>
      <th>NAME</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>APPLE</th>
      <td>2832025.00</td>
      <td>3.13</td>
      <td>NaN</td>
      <td>2.83 M$</td>
    </tr>
    <tr>
      <th>SAUDI ARABIAN OIL</th>
      <td>3220550.15</td>
      <td>175.59</td>
      <td>NaN</td>
      <td>3.22 M$</td>
    </tr>
    <tr>
      <th>MICROSOFT</th>
      <td>4336000.00</td>
      <td>29.16</td>
      <td>75.0</td>
      <td>4.34 M$</td>
    </tr>
    <tr>
      <th>AMAZON.COM</th>
      <td>6567669.00</td>
      <td>40.14</td>
      <td>50.0</td>
      <td>6.57 M$</td>
    </tr>
    <tr>
      <th>ALIBABA GROUP HOLDING ADR 1:8</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>nan M$</td>
    </tr>
    <tr>
      <th>FACEBOOK CLASS A</th>
      <td>2291182.00</td>
      <td>25.69</td>
      <td>75.0</td>
      <td>2.29 M$</td>
    </tr>
    <tr>
      <th>TENCENT HOLDINGS</th>
      <td>2681758.80</td>
      <td>15.81</td>
      <td>NaN</td>
      <td>2.68 M$</td>
    </tr>
    <tr>
      <th>ALPHABET A</th>
      <td>50294471.00</td>
      <td>32.22</td>
      <td>50.0</td>
      <td>50.29 M$</td>
    </tr>
    <tr>
      <th>TESLA</th>
      <td>17315009.00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>17.32 M$</td>
    </tr>
    <tr>
      <th>TAIWAN SEMICON.MNFG.</th>
      <td>12584165.55</td>
      <td>245.17</td>
      <td>18.0</td>
      <td>12.58 M$</td>
    </tr>
    <tr>
      <th>NESTLE 'N'</th>
      <td>12906002.11</td>
      <td>58.52</td>
      <td>35.0</td>
      <td>12.91 M$</td>
    </tr>
    <tr>
      <th>NVIDIA</th>
      <td>NaN</td>
      <td>7.10</td>
      <td>25.0</td>
      <td>nan M$</td>
    </tr>
    <tr>
      <th>SAMSUNG ELECTRONICS</th>
      <td>NaN</td>
      <td>69.06</td>
      <td>70.0</td>
      <td>nan M$</td>
    </tr>
    <tr>
      <th>JP MORGAN CHASE &amp; CO.</th>
      <td>4460719.00</td>
      <td>6.69</td>
      <td>50.0</td>
      <td>4.46 M$</td>
    </tr>
    <tr>
      <th>KWEICHOW MOUTAI 'A'</th>
      <td>40219.20</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.04 M$</td>
    </tr>
    <tr>
      <th>NETFLIX</th>
      <td>3665870.00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3.67 M$</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>Map()</strong> can also be used to transform index. The following command turns the company names backwards.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">companies_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;ELPPA&#39;, &#39;LIO NAIBARA IDUAS&#39;, &#39;TFOSORCIM&#39;, &#39;MOC.NOZAMA&#39;,
       &#39;8:1 RDA GNIDLOH PUORG ABABILA&#39;, &#39;A SSALC KOOBECAF&#39;, &#39;SGNIDLOH TNECNET&#39;,
       &#39;A TEBAHPLA&#39;, &#39;ALSET&#39;, &#39;.GFNM.NOCIMES NAWIAT&#39;, &#39;&#39;N&#39; ELTSEN&#39;, &#39;AIDIVN&#39;,
       &#39;SCINORTCELE GNUSMAS&#39;, &#39;.OC &amp; ESAHC NAGROM PJ&#39;, &#39;&#39;A&#39; IATUOM WOHCIEWK&#39;,
       &#39;XILFTEN&#39;],
      dtype=&#39;object&#39;, name=&#39;NAME&#39;)
</pre></div>
</div>
</div>
</div>
<p>Of course, you can also use <strong>rename()</strong>. Using a dictionary, <strong>rename()</strong> can also be used to change only some of the labels.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">companies_df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="nb">str</span><span class="o">.</span><span class="n">title</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Board member compensation</th>
      <th>Total CO2 To Revenues</th>
      <th>Emission Reduction Target %</th>
      <th>Compensation ($ millions)</th>
    </tr>
    <tr>
      <th>NAME</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Apple</th>
      <td>2832025.00</td>
      <td>3.13</td>
      <td>NaN</td>
      <td>2.83 M$</td>
    </tr>
    <tr>
      <th>Saudi Arabian Oil</th>
      <td>3220550.15</td>
      <td>175.59</td>
      <td>NaN</td>
      <td>3.22 M$</td>
    </tr>
    <tr>
      <th>Microsoft</th>
      <td>4336000.00</td>
      <td>29.16</td>
      <td>75.0</td>
      <td>4.34 M$</td>
    </tr>
    <tr>
      <th>Amazon.Com</th>
      <td>6567669.00</td>
      <td>40.14</td>
      <td>50.0</td>
      <td>6.57 M$</td>
    </tr>
    <tr>
      <th>Alibaba Group Holding Adr 1:8</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>nan M$</td>
    </tr>
    <tr>
      <th>Facebook Class A</th>
      <td>2291182.00</td>
      <td>25.69</td>
      <td>75.0</td>
      <td>2.29 M$</td>
    </tr>
    <tr>
      <th>Tencent Holdings</th>
      <td>2681758.80</td>
      <td>15.81</td>
      <td>NaN</td>
      <td>2.68 M$</td>
    </tr>
    <tr>
      <th>Alphabet A</th>
      <td>50294471.00</td>
      <td>32.22</td>
      <td>50.0</td>
      <td>50.29 M$</td>
    </tr>
    <tr>
      <th>Tesla</th>
      <td>17315009.00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>17.32 M$</td>
    </tr>
    <tr>
      <th>Taiwan Semicon.Mnfg.</th>
      <td>12584165.55</td>
      <td>245.17</td>
      <td>18.0</td>
      <td>12.58 M$</td>
    </tr>
    <tr>
      <th>Nestle 'N'</th>
      <td>12906002.11</td>
      <td>58.52</td>
      <td>35.0</td>
      <td>12.91 M$</td>
    </tr>
    <tr>
      <th>Nvidia</th>
      <td>NaN</td>
      <td>7.10</td>
      <td>25.0</td>
      <td>nan M$</td>
    </tr>
    <tr>
      <th>Samsung Electronics</th>
      <td>NaN</td>
      <td>69.06</td>
      <td>70.0</td>
      <td>nan M$</td>
    </tr>
    <tr>
      <th>Jp Morgan Chase &amp; Co.</th>
      <td>4460719.00</td>
      <td>6.69</td>
      <td>50.0</td>
      <td>4.46 M$</td>
    </tr>
    <tr>
      <th>Kweichow Moutai 'A'</th>
      <td>40219.20</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.04 M$</td>
    </tr>
    <tr>
      <th>Netflix</th>
      <td>3665870.00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3.67 M$</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>Replace()</strong> can be used to replace any values, not just NaN values. You can pass also dict/list, if you want to replace multiple values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">companies_df</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="o">-</span><span class="mi">999</span><span class="p">)</span> <span class="c1"># Pandas NaN is np.nan</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Board member compensation</th>
      <th>Total CO2 To Revenues</th>
      <th>Emission Reduction Target %</th>
      <th>Compensation ($ millions)</th>
    </tr>
    <tr>
      <th>NAME</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>APPLE</th>
      <td>2832025.00</td>
      <td>3.13</td>
      <td>-999.0</td>
      <td>2.83 M$</td>
    </tr>
    <tr>
      <th>SAUDI ARABIAN OIL</th>
      <td>3220550.15</td>
      <td>175.59</td>
      <td>-999.0</td>
      <td>3.22 M$</td>
    </tr>
    <tr>
      <th>MICROSOFT</th>
      <td>4336000.00</td>
      <td>29.16</td>
      <td>75.0</td>
      <td>4.34 M$</td>
    </tr>
    <tr>
      <th>AMAZON.COM</th>
      <td>6567669.00</td>
      <td>40.14</td>
      <td>50.0</td>
      <td>6.57 M$</td>
    </tr>
    <tr>
      <th>ALIBABA GROUP HOLDING ADR 1:8</th>
      <td>-999.00</td>
      <td>-999.00</td>
      <td>-999.0</td>
      <td>nan M$</td>
    </tr>
    <tr>
      <th>FACEBOOK CLASS A</th>
      <td>2291182.00</td>
      <td>25.69</td>
      <td>75.0</td>
      <td>2.29 M$</td>
    </tr>
    <tr>
      <th>TENCENT HOLDINGS</th>
      <td>2681758.80</td>
      <td>15.81</td>
      <td>-999.0</td>
      <td>2.68 M$</td>
    </tr>
    <tr>
      <th>ALPHABET A</th>
      <td>50294471.00</td>
      <td>32.22</td>
      <td>50.0</td>
      <td>50.29 M$</td>
    </tr>
    <tr>
      <th>TESLA</th>
      <td>17315009.00</td>
      <td>-999.00</td>
      <td>-999.0</td>
      <td>17.32 M$</td>
    </tr>
    <tr>
      <th>TAIWAN SEMICON.MNFG.</th>
      <td>12584165.55</td>
      <td>245.17</td>
      <td>18.0</td>
      <td>12.58 M$</td>
    </tr>
    <tr>
      <th>NESTLE 'N'</th>
      <td>12906002.11</td>
      <td>58.52</td>
      <td>35.0</td>
      <td>12.91 M$</td>
    </tr>
    <tr>
      <th>NVIDIA</th>
      <td>-999.00</td>
      <td>7.10</td>
      <td>25.0</td>
      <td>nan M$</td>
    </tr>
    <tr>
      <th>SAMSUNG ELECTRONICS</th>
      <td>-999.00</td>
      <td>69.06</td>
      <td>70.0</td>
      <td>nan M$</td>
    </tr>
    <tr>
      <th>JP MORGAN CHASE &amp; CO.</th>
      <td>4460719.00</td>
      <td>6.69</td>
      <td>50.0</td>
      <td>4.46 M$</td>
    </tr>
    <tr>
      <th>KWEICHOW MOUTAI 'A'</th>
      <td>40219.20</td>
      <td>-999.00</td>
      <td>-999.0</td>
      <td>0.04 M$</td>
    </tr>
    <tr>
      <th>NETFLIX</th>
      <td>3665870.00</td>
      <td>-999.00</td>
      <td>-999.0</td>
      <td>3.67 M$</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Dividing data to <strong>bins</strong> is a very important feature in Pandas. You can use <strong>pd.cut()</strong> (notice that it is not a dataframe method) to creata a categorical object. <strong>pd.value_counts()</strong> can be used to calculate the number of observations in each bin. With the <strong>labels</strong> parameter you can define names for different bins.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">compensation_bins</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10000</span><span class="p">,</span><span class="mi">100000</span><span class="p">,</span><span class="mi">1000000</span><span class="p">,</span><span class="mi">10000000</span><span class="p">,</span><span class="mi">100000000</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">comp_categ</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">companies_df</span><span class="p">[</span><span class="s1">&#39;Board member compensation&#39;</span><span class="p">],</span><span class="n">compensation_bins</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">comp_categ</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>NAME
APPLE                              (1000000.0, 10000000.0]
SAUDI ARABIAN OIL                  (1000000.0, 10000000.0]
MICROSOFT                          (1000000.0, 10000000.0]
AMAZON.COM                         (1000000.0, 10000000.0]
ALIBABA GROUP HOLDING ADR 1:8                          NaN
FACEBOOK CLASS A                   (1000000.0, 10000000.0]
TENCENT HOLDINGS                   (1000000.0, 10000000.0]
ALPHABET A                       (10000000.0, 100000000.0]
TESLA                            (10000000.0, 100000000.0]
TAIWAN SEMICON.MNFG.             (10000000.0, 100000000.0]
NESTLE &#39;N&#39;                       (10000000.0, 100000000.0]
NVIDIA                                                 NaN
SAMSUNG ELECTRONICS                                    NaN
JP MORGAN CHASE &amp; CO.              (1000000.0, 10000000.0]
KWEICHOW MOUTAI &#39;A&#39;                    (10000.0, 100000.0]
NETFLIX                            (1000000.0, 10000000.0]
Name: Board member compensation, dtype: category
Categories (4, interval[int64]): [(10000, 100000] &lt; (100000, 1000000] &lt; (1000000, 10000000] &lt; (10000000, 100000000]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">comp_categ</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">categories</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>IntervalIndex([(10000, 100000], (100000, 1000000], (1000000, 10000000], (10000000, 100000000]],
              closed=&#39;right&#39;,
              dtype=&#39;interval[int64]&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">comp_categ</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">codes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 2,  2,  2,  2, -1,  2,  2,  3,  3,  3,  3, -1, -1,  2,  0,  2],
      dtype=int8)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">comp_categ</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1000000, 10000000]      8
(10000000, 100000000]    4
(10000, 100000]          1
(100000, 1000000]        0
Name: Board member compensation, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">companies_df</span><span class="p">[</span><span class="s1">&#39;Board member compensation&#39;</span><span class="p">],</span>
                    <span class="n">compensation_bins</span><span class="p">,</span><span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Poor board members&#39;</span><span class="p">,</span><span class="s1">&#39;Rich board members&#39;</span><span class="p">,</span>
                                                <span class="s1">&#39;Very rich board members&#39;</span><span class="p">,</span><span class="s1">&#39;Insanely rich board members&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>NAME
APPLE                                Very rich board members
SAUDI ARABIAN OIL                    Very rich board members
MICROSOFT                            Very rich board members
AMAZON.COM                           Very rich board members
ALIBABA GROUP HOLDING ADR 1:8                            NaN
FACEBOOK CLASS A                     Very rich board members
TENCENT HOLDINGS                     Very rich board members
ALPHABET A                       Insanely rich board members
TESLA                            Insanely rich board members
TAIWAN SEMICON.MNFG.             Insanely rich board members
NESTLE &#39;N&#39;                       Insanely rich board members
NVIDIA                                                   NaN
SAMSUNG ELECTRONICS                                      NaN
JP MORGAN CHASE &amp; CO.                Very rich board members
KWEICHOW MOUTAI &#39;A&#39;                       Poor board members
NETFLIX                              Very rich board members
Name: Board member compensation, dtype: category
Categories (4, object): [&#39;Poor board members&#39; &lt; &#39;Rich board members&#39; &lt; &#39;Very rich board members&#39; &lt; &#39;Insanely rich board members&#39;]
</pre></div>
</div>
</div>
</div>
<p>If you pass a number to the <strong>bins</strong> parameter, it will return that many equal-length bins.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">companies_df</span><span class="p">[</span><span class="s1">&#39;Total CO2 To Revenues&#39;</span><span class="p">],</span><span class="mi">4</span><span class="p">,</span><span class="n">precision</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>NAME
APPLE                               (2.9, 63.6]
SAUDI ARABIAN OIL                (124.2, 184.7]
MICROSOFT                           (2.9, 63.6]
AMAZON.COM                          (2.9, 63.6]
ALIBABA GROUP HOLDING ADR 1:8               NaN
FACEBOOK CLASS A                    (2.9, 63.6]
TENCENT HOLDINGS                    (2.9, 63.6]
ALPHABET A                          (2.9, 63.6]
TESLA                                       NaN
TAIWAN SEMICON.MNFG.             (184.7, 245.2]
NESTLE &#39;N&#39;                          (2.9, 63.6]
NVIDIA                              (2.9, 63.6]
SAMSUNG ELECTRONICS               (63.6, 124.2]
JP MORGAN CHASE &amp; CO.               (2.9, 63.6]
KWEICHOW MOUTAI &#39;A&#39;                         NaN
NETFLIX                                     NaN
Name: Total CO2 To Revenues, dtype: category
Categories (4, interval[float64]): [(2.9, 63.6] &lt; (63.6, 124.2] &lt; (124.2, 184.7] &lt; (184.7, 245.2]]
</pre></div>
</div>
</div>
</div>
<p>For many purposes, <strong>qcut()</strong> is more useful as it bins the data based on sample quantiles. Therefore, every bins has approximately the same number of observations. You can also pass specific quantiles as a list to the function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">qcut</span><span class="p">(</span><span class="n">companies_df</span><span class="p">[</span><span class="s1">&#39;Total CO2 To Revenues&#39;</span><span class="p">],</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>NAME
APPLE                             (3.129, 13.632]
SAUDI ARABIAN OIL                (61.155, 245.17]
MICROSOFT                         (13.632, 30.69]
AMAZON.COM                        (30.69, 61.155]
ALIBABA GROUP HOLDING ADR 1:8                 NaN
FACEBOOK CLASS A                  (13.632, 30.69]
TENCENT HOLDINGS                  (13.632, 30.69]
ALPHABET A                        (30.69, 61.155]
TESLA                                         NaN
TAIWAN SEMICON.MNFG.             (61.155, 245.17]
NESTLE &#39;N&#39;                        (30.69, 61.155]
NVIDIA                            (3.129, 13.632]
SAMSUNG ELECTRONICS              (61.155, 245.17]
JP MORGAN CHASE &amp; CO.             (3.129, 13.632]
KWEICHOW MOUTAI &#39;A&#39;                           NaN
NETFLIX                                       NaN
Name: Total CO2 To Revenues, dtype: category
Categories (4, interval[float64]): [(3.129, 13.632] &lt; (13.632, 30.69] &lt; (30.69, 61.155] &lt; (61.155, 245.17]]
</pre></div>
</div>
</div>
</div>
<p>Detecting and filtering outliers is easy with boolean dataframes</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">companies_df</span><span class="p">[</span><span class="n">companies_df</span><span class="p">[</span><span class="s1">&#39;Board member compensation&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">10000000</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Board member compensation</th>
      <th>Total CO2 To Revenues</th>
      <th>Emission Reduction Target %</th>
      <th>Compensation ($ millions)</th>
    </tr>
    <tr>
      <th>NAME</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>APPLE</th>
      <td>2832025.00</td>
      <td>3.13</td>
      <td>NaN</td>
      <td>2.83 M$</td>
    </tr>
    <tr>
      <th>SAUDI ARABIAN OIL</th>
      <td>3220550.15</td>
      <td>175.59</td>
      <td>NaN</td>
      <td>3.22 M$</td>
    </tr>
    <tr>
      <th>MICROSOFT</th>
      <td>4336000.00</td>
      <td>29.16</td>
      <td>75.0</td>
      <td>4.34 M$</td>
    </tr>
    <tr>
      <th>AMAZON.COM</th>
      <td>6567669.00</td>
      <td>40.14</td>
      <td>50.0</td>
      <td>6.57 M$</td>
    </tr>
    <tr>
      <th>FACEBOOK CLASS A</th>
      <td>2291182.00</td>
      <td>25.69</td>
      <td>75.0</td>
      <td>2.29 M$</td>
    </tr>
    <tr>
      <th>TENCENT HOLDINGS</th>
      <td>2681758.80</td>
      <td>15.81</td>
      <td>NaN</td>
      <td>2.68 M$</td>
    </tr>
    <tr>
      <th>JP MORGAN CHASE &amp; CO.</th>
      <td>4460719.00</td>
      <td>6.69</td>
      <td>50.0</td>
      <td>4.46 M$</td>
    </tr>
    <tr>
      <th>KWEICHOW MOUTAI 'A'</th>
      <td>40219.20</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.04 M$</td>
    </tr>
    <tr>
      <th>NETFLIX</th>
      <td>3665870.00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3.67 M$</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Filtering is also possible with the summary statistics of variables. The following command picks up cases where the values of <strong>all</strong> variables deviate from the mean less than two standard deviations.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">companies_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;Compensation ($ millions)&#39;</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">companies_df</span><span class="p">[(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">companies_df</span><span class="o">-</span><span class="n">companies_df</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="o">*</span><span class="n">companies_df</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="mi">1</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Board member compensation</th>
      <th>Total CO2 To Revenues</th>
      <th>Emission Reduction Target %</th>
    </tr>
    <tr>
      <th>NAME</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>MICROSOFT</th>
      <td>4336000.00</td>
      <td>29.16</td>
      <td>75.0</td>
    </tr>
    <tr>
      <th>AMAZON.COM</th>
      <td>6567669.00</td>
      <td>40.14</td>
      <td>50.0</td>
    </tr>
    <tr>
      <th>FACEBOOK CLASS A</th>
      <td>2291182.00</td>
      <td>25.69</td>
      <td>75.0</td>
    </tr>
    <tr>
      <th>NESTLE 'N'</th>
      <td>12906002.11</td>
      <td>58.52</td>
      <td>35.0</td>
    </tr>
    <tr>
      <th>JP MORGAN CHASE &amp; CO.</th>
      <td>4460719.00</td>
      <td>6.69</td>
      <td>50.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Winsorising is another common procedure in practical econometrics. In that method, the most extreme values are moved to specific quantiles, usually 1% and 99% quantiles. It is easiest to implement with the <strong>clip()</strong> method. Notice how the following command winsorise all the variables.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">companies_df</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">lower</span> <span class="o">=</span> <span class="n">companies_df</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.1</span><span class="p">),</span> <span class="n">upper</span> <span class="o">=</span> <span class="n">companies_df</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.9</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Board member compensation</th>
      <th>Total CO2 To Revenues</th>
      <th>Emission Reduction Target %</th>
    </tr>
    <tr>
      <th>NAME</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>APPLE</th>
      <td>2.832025e+06</td>
      <td>6.731</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>SAUDI ARABIAN OIL</th>
      <td>3.220550e+06</td>
      <td>164.937</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>MICROSOFT</th>
      <td>4.336000e+06</td>
      <td>29.160</td>
      <td>75.0</td>
    </tr>
    <tr>
      <th>AMAZON.COM</th>
      <td>6.567669e+06</td>
      <td>40.140</td>
      <td>50.0</td>
    </tr>
    <tr>
      <th>ALIBABA GROUP HOLDING ADR 1:8</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>FACEBOOK CLASS A</th>
      <td>2.369297e+06</td>
      <td>25.690</td>
      <td>75.0</td>
    </tr>
    <tr>
      <th>TENCENT HOLDINGS</th>
      <td>2.681759e+06</td>
      <td>15.810</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>ALPHABET A</th>
      <td>1.643321e+07</td>
      <td>32.220</td>
      <td>50.0</td>
    </tr>
    <tr>
      <th>TESLA</th>
      <td>1.643321e+07</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>TAIWAN SEMICON.MNFG.</th>
      <td>1.258417e+07</td>
      <td>164.937</td>
      <td>23.6</td>
    </tr>
    <tr>
      <th>NESTLE 'N'</th>
      <td>1.290600e+07</td>
      <td>58.520</td>
      <td>35.0</td>
    </tr>
    <tr>
      <th>NVIDIA</th>
      <td>NaN</td>
      <td>7.100</td>
      <td>25.0</td>
    </tr>
    <tr>
      <th>SAMSUNG ELECTRONICS</th>
      <td>NaN</td>
      <td>69.060</td>
      <td>70.0</td>
    </tr>
    <tr>
      <th>JP MORGAN CHASE &amp; CO.</th>
      <td>4.460719e+06</td>
      <td>6.731</td>
      <td>50.0</td>
    </tr>
    <tr>
      <th>KWEICHOW MOUTAI 'A'</th>
      <td>2.369297e+06</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>NETFLIX</th>
      <td>3.665870e+06</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Random sampling from data is easy. You can use the <strong>sample()</strong> method for that. It is also possible to sample with replacement that is needed in many numerical statistical methods.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">companies_df</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Board member compensation</th>
      <th>Total CO2 To Revenues</th>
      <th>Emission Reduction Target %</th>
    </tr>
    <tr>
      <th>NAME</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>SAUDI ARABIAN OIL</th>
      <td>3220550.15</td>
      <td>175.59</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>TENCENT HOLDINGS</th>
      <td>2681758.80</td>
      <td>15.81</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>FACEBOOK CLASS A</th>
      <td>2291182.00</td>
      <td>25.69</td>
      <td>75.0</td>
    </tr>
    <tr>
      <th>TENCENT HOLDINGS</th>
      <td>2681758.80</td>
      <td>15.81</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>NVIDIA</th>
      <td>NaN</td>
      <td>7.10</td>
      <td>25.0</td>
    </tr>
    <tr>
      <th>NETFLIX</th>
      <td>3665870.00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>NETFLIX</th>
      <td>3665870.00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>MICROSOFT</th>
      <td>4336000.00</td>
      <td>29.16</td>
      <td>75.0</td>
    </tr>
    <tr>
      <th>ALPHABET A</th>
      <td>50294471.00</td>
      <td>32.22</td>
      <td>50.0</td>
    </tr>
    <tr>
      <th>TENCENT HOLDINGS</th>
      <td>2681758.80</td>
      <td>15.81</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>If you want to randomise the order of values in a dataframe, you can use Numpy’s <strong>random.permutation()</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">permut_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">companies_df</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">companies_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">permut_index</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Board member compensation</th>
      <th>Total CO2 To Revenues</th>
      <th>Emission Reduction Target %</th>
    </tr>
    <tr>
      <th>NAME</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>ALIBABA GROUP HOLDING ADR 1:8</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>SAMSUNG ELECTRONICS</th>
      <td>NaN</td>
      <td>69.06</td>
      <td>70.0</td>
    </tr>
    <tr>
      <th>TENCENT HOLDINGS</th>
      <td>2681758.80</td>
      <td>15.81</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>ALPHABET A</th>
      <td>50294471.00</td>
      <td>32.22</td>
      <td>50.0</td>
    </tr>
    <tr>
      <th>FACEBOOK CLASS A</th>
      <td>2291182.00</td>
      <td>25.69</td>
      <td>75.0</td>
    </tr>
    <tr>
      <th>JP MORGAN CHASE &amp; CO.</th>
      <td>4460719.00</td>
      <td>6.69</td>
      <td>50.0</td>
    </tr>
    <tr>
      <th>SAUDI ARABIAN OIL</th>
      <td>3220550.15</td>
      <td>175.59</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>MICROSOFT</th>
      <td>4336000.00</td>
      <td>29.16</td>
      <td>75.0</td>
    </tr>
    <tr>
      <th>TAIWAN SEMICON.MNFG.</th>
      <td>12584165.55</td>
      <td>245.17</td>
      <td>18.0</td>
    </tr>
    <tr>
      <th>APPLE</th>
      <td>2832025.00</td>
      <td>3.13</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>NETFLIX</th>
      <td>3665870.00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>NESTLE 'N'</th>
      <td>12906002.11</td>
      <td>58.52</td>
      <td>35.0</td>
    </tr>
    <tr>
      <th>KWEICHOW MOUTAI 'A'</th>
      <td>40219.20</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>NVIDIA</th>
      <td>NaN</td>
      <td>7.10</td>
      <td>25.0</td>
    </tr>
    <tr>
      <th>AMAZON.COM</th>
      <td>6567669.00</td>
      <td>40.14</td>
      <td>50.0</td>
    </tr>
    <tr>
      <th>TESLA</th>
      <td>17315009.00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Very often in econometrics, you need to transform your categorical variables to a collection of dummy variables. It easily done in Pandas using the <strong>get_dummies()</strong> function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">companies_df</span><span class="p">[</span><span class="s1">&#39;Emission Reduction Target %&#39;</span><span class="p">],</span><span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;Emiss_&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Emiss__18.0</th>
      <th>Emiss__25.0</th>
      <th>Emiss__35.0</th>
      <th>Emiss__50.0</th>
      <th>Emiss__70.0</th>
      <th>Emiss__75.0</th>
    </tr>
    <tr>
      <th>NAME</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>APPLE</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>SAUDI ARABIAN OIL</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>MICROSOFT</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>AMAZON.COM</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>ALIBABA GROUP HOLDING ADR 1:8</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>FACEBOOK CLASS A</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>TENCENT HOLDINGS</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>ALPHABET A</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>TESLA</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>TAIWAN SEMICON.MNFG.</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>NESTLE 'N'</th>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>NVIDIA</th>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>SAMSUNG ELECTRONICS</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>JP MORGAN CHASE &amp; CO.</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>KWEICHOW MOUTAI 'A'</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>NETFLIX</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Pandas has efficient methods to manipulate strings in a dataframe. Due to this, Pandas is very popular among researchers that need to use string data in their analysis. This makes it also a very important tool for accounting data analysis. All the Python string object’s built-in methods can be used to manipulate strings in a dataframe. We already discussed string-methods in Chapter 1.</p>
<p>Regular expressions can also be used to manipulate string-dataframes. Regular expressions is a very broad topic, and it takes time to master it. Let’s look at some very simple examples. If we want to split a sentence to a words-list, repeated whitespaces make the process difficult with the standard string-methods. However, it is very easy with regular expressions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">re</span>
</pre></div>
</div>
</div>
</div>
<p>The regex for multiple whitespaces is <strong>\s+</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">splitter</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">&#39;\s+&#39;</span><span class="p">)</span>
<span class="n">splitter</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;This    is   a    sample        text.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;This&#39;, &#39;is&#39;, &#39;a&#39;, &#39;sample&#39;, &#39;text.&#39;]
</pre></div>
</div>
</div>
</div>
<p>Regular experssions is a powerful tool, but very complex. You can search email-addresses from a text with the following regex-command.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reg_pattern</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">email_search</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">reg_pattern</span><span class="p">,</span> <span class="n">flags</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">example</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;The general format of an email address is local-part@domain,</span>
<span class="s2">and a specific example is jsmith@example.com. An address consists of two parts. </span>
<span class="s2">The part before the @ symbol (local part) identifies the name of a mailbox. </span>
<span class="s2">This is often the username of the recipient, e.g., jsmith. </span>
<span class="s2">The part after the @ symbol (domain) is a domain name that represents </span>
<span class="s2">the administrative realm for the mail box, e.g., a company&#39;s domain name, example.com.&quot;&quot;&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">email_search</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">example</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;jsmith@example.com&#39;]
</pre></div>
</div>
</div>
</div>
<p>We do not go into regular expression more at this point. But we will see some applications of them in the following chapters. If you want to learn more about regular expressions, here is a good website: <a class="reference external" href="https://www.regular-expressions.info/index.html">www.regular-expressions.info/index.html</a></p>
<p>If your string data contains missing values, usually the standard string methods will not work. Then you need to use the dataframe string methods.</p>
<p>You can slice strings normally.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">companies_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;APPLE&#39;, &#39;SAUDI&#39;, &#39;MICRO&#39;, &#39;AMAZO&#39;, &#39;ALIBA&#39;, &#39;FACEB&#39;, &#39;TENCE&#39;, &#39;ALPHA&#39;,
       &#39;TESLA&#39;, &#39;TAIWA&#39;, &#39;NESTL&#39;, &#39;NVIDI&#39;, &#39;SAMSU&#39;, &#39;JP MO&#39;, &#39;KWEIC&#39;, &#39;NETFL&#39;],
      dtype=&#39;object&#39;, name=&#39;NAME&#39;)
</pre></div>
</div>
</div>
</div>
<p>And you can use regular experssions, for example, to search strings.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">companies_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;am&#39;</span><span class="p">,</span> <span class="n">flags</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([[], [], [], [&#39;AM&#39;], [], [], [], [], [], [], [], [], [&#39;AM&#39;], [], [], []], dtype=&#39;object&#39;, name=&#39;NAME&#39;)
</pre></div>
</div>
</div>
</div>
<p>Here is a good introduction to Pandas string methods. <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/user_guide/text.html">pandas.pydata.org/pandas-docs/stable/user_guide/text.html</a>. If you scroll down, there is a full list methods.</p>
</div>
<div class="section" id="advanced-methods">
<h2><span class="section-number">4.2. </span>Advanced methods<a class="headerlink" href="#advanced-methods" title="Permalink to this headline">¶</a></h2>
<p>Let’s look some more advanced methods of Pandas next. We need a new dataset for that.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">electricity_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;https://vincentarelbundock.github.io/Rdatasets/csv/AER/USAirlines.csv&#39;</span><span class="p">,</span><span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">electricity_df</span><span class="p">[</span><span class="s1">&#39;firm&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="mi">3</span><span class="p">:</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="mi">4</span><span class="p">:</span><span class="s1">&#39;D&#39;</span><span class="p">,</span><span class="mi">5</span><span class="p">:</span><span class="s1">&#39;E&#39;</span><span class="p">,</span><span class="mi">6</span><span class="p">:</span><span class="s1">&#39;F&#39;</span><span class="p">},</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The cost function of electricity producers.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">electricity_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>firm</th>
      <th>year</th>
      <th>output</th>
      <th>cost</th>
      <th>price</th>
      <th>load</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>A</td>
      <td>1970</td>
      <td>0.952757</td>
      <td>1140640</td>
      <td>106650</td>
      <td>0.534487</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A</td>
      <td>1971</td>
      <td>0.986757</td>
      <td>1215690</td>
      <td>110307</td>
      <td>0.532328</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A</td>
      <td>1972</td>
      <td>1.091980</td>
      <td>1309570</td>
      <td>110574</td>
      <td>0.547736</td>
    </tr>
    <tr>
      <th>4</th>
      <td>A</td>
      <td>1973</td>
      <td>1.175780</td>
      <td>1511530</td>
      <td>121974</td>
      <td>0.540846</td>
    </tr>
    <tr>
      <th>5</th>
      <td>A</td>
      <td>1974</td>
      <td>1.160170</td>
      <td>1676730</td>
      <td>196606</td>
      <td>0.591167</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>86</th>
      <td>F</td>
      <td>1980</td>
      <td>0.112640</td>
      <td>381478</td>
      <td>874818</td>
      <td>0.517766</td>
    </tr>
    <tr>
      <th>87</th>
      <td>F</td>
      <td>1981</td>
      <td>0.154154</td>
      <td>506969</td>
      <td>1013170</td>
      <td>0.580049</td>
    </tr>
    <tr>
      <th>88</th>
      <td>F</td>
      <td>1982</td>
      <td>0.186461</td>
      <td>633388</td>
      <td>930477</td>
      <td>0.556024</td>
    </tr>
    <tr>
      <th>89</th>
      <td>F</td>
      <td>1983</td>
      <td>0.246847</td>
      <td>804388</td>
      <td>851676</td>
      <td>0.537791</td>
    </tr>
    <tr>
      <th>90</th>
      <td>F</td>
      <td>1984</td>
      <td>0.304013</td>
      <td>1009500</td>
      <td>819476</td>
      <td>0.525775</td>
    </tr>
  </tbody>
</table>
<p>90 rows × 6 columns</p>
</div></div></div>
</div>
<p>There are many tools to deal with data that has more than two dimensions. The basic idea is to use hierarchical indexing in a two dimensional dataframe. For example, we can index the data by firm-years using <strong>set_index()</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">electricity_df</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="s1">&#39;firm&#39;</span><span class="p">,</span><span class="s1">&#39;year&#39;</span><span class="p">],</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">electricity_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>output</th>
      <th>cost</th>
      <th>price</th>
      <th>load</th>
    </tr>
    <tr>
      <th>firm</th>
      <th>year</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">A</th>
      <th>1970</th>
      <td>0.952757</td>
      <td>1140640</td>
      <td>106650</td>
      <td>0.534487</td>
    </tr>
    <tr>
      <th>1971</th>
      <td>0.986757</td>
      <td>1215690</td>
      <td>110307</td>
      <td>0.532328</td>
    </tr>
    <tr>
      <th>1972</th>
      <td>1.091980</td>
      <td>1309570</td>
      <td>110574</td>
      <td>0.547736</td>
    </tr>
    <tr>
      <th>1973</th>
      <td>1.175780</td>
      <td>1511530</td>
      <td>121974</td>
      <td>0.540846</td>
    </tr>
    <tr>
      <th>1974</th>
      <td>1.160170</td>
      <td>1676730</td>
      <td>196606</td>
      <td>0.591167</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">F</th>
      <th>1980</th>
      <td>0.112640</td>
      <td>381478</td>
      <td>874818</td>
      <td>0.517766</td>
    </tr>
    <tr>
      <th>1981</th>
      <td>0.154154</td>
      <td>506969</td>
      <td>1013170</td>
      <td>0.580049</td>
    </tr>
    <tr>
      <th>1982</th>
      <td>0.186461</td>
      <td>633388</td>
      <td>930477</td>
      <td>0.556024</td>
    </tr>
    <tr>
      <th>1983</th>
      <td>0.246847</td>
      <td>804388</td>
      <td>851676</td>
      <td>0.537791</td>
    </tr>
    <tr>
      <th>1984</th>
      <td>0.304013</td>
      <td>1009500</td>
      <td>819476</td>
      <td>0.525775</td>
    </tr>
  </tbody>
</table>
<p>90 rows × 4 columns</p>
</div></div></div>
</div>
<p>Now the values are sorted so that all the years of a certain company are in adjacent rows. With <strong>sort_index</strong> you can order the values according to years.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">electricity_df</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>output</th>
      <th>cost</th>
      <th>price</th>
      <th>load</th>
    </tr>
    <tr>
      <th>firm</th>
      <th>year</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>A</th>
      <th>1970</th>
      <td>0.952757</td>
      <td>1140640</td>
      <td>106650</td>
      <td>0.534487</td>
    </tr>
    <tr>
      <th>B</th>
      <th>1970</th>
      <td>0.520635</td>
      <td>569292</td>
      <td>103795</td>
      <td>0.490851</td>
    </tr>
    <tr>
      <th>C</th>
      <th>1970</th>
      <td>0.262424</td>
      <td>286298</td>
      <td>118788</td>
      <td>0.524334</td>
    </tr>
    <tr>
      <th>D</th>
      <th>1970</th>
      <td>0.086393</td>
      <td>145167</td>
      <td>114987</td>
      <td>0.432066</td>
    </tr>
    <tr>
      <th>E</th>
      <th>1970</th>
      <td>0.051028</td>
      <td>91361</td>
      <td>118222</td>
      <td>0.442875</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>B</th>
      <th>1984</th>
      <td>1.389740</td>
      <td>4209390</td>
      <td>821361</td>
      <td>0.528775</td>
    </tr>
    <tr>
      <th>C</th>
      <th>1984</th>
      <td>0.493317</td>
      <td>1170470</td>
      <td>844079</td>
      <td>0.577078</td>
    </tr>
    <tr>
      <th>D</th>
      <th>1984</th>
      <td>0.421411</td>
      <td>1436970</td>
      <td>831374</td>
      <td>0.585525</td>
    </tr>
    <tr>
      <th>E</th>
      <th>1984</th>
      <td>0.213279</td>
      <td>610257</td>
      <td>844622</td>
      <td>0.635545</td>
    </tr>
    <tr>
      <th>F</th>
      <th>1984</th>
      <td>0.304013</td>
      <td>1009500</td>
      <td>819476</td>
      <td>0.525775</td>
    </tr>
  </tbody>
</table>
<p>90 rows × 4 columns</p>
</div></div></div>
</div>
<p>Two-level indexing enables an easy way to pick subgroups from the data. For a series, you can just use the standard indexing style of Python.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">electricity_df</span><span class="p">[</span><span class="s1">&#39;output&#39;</span><span class="p">][</span><span class="s1">&#39;A&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>year
1970    0.952757
1971    0.986757
1972    1.091980
1973    1.175780
1974    1.160170
1975    1.173760
1976    1.290510
1977    1.390670
1978    1.612730
1979    1.825440
1980    1.546040
1981    1.527900
1982    1.660200
1983    1.822310
1984    1.936460
Name: output, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">electricity_df</span><span class="p">[</span><span class="s1">&#39;output&#39;</span><span class="p">][:,</span><span class="mi">1975</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>firm
A    1.173760
B    0.852892
C    0.367517
D    0.164272
E    0.073961
F    0.052462
Name: output, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>With multi-index dataframes, you have to be a little bit more careful, because the subgroups are dataframes themselves. For example, you need to use <strong>loc</strong> to pick up the subgroups.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">electricity_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>output</th>
      <th>cost</th>
      <th>price</th>
      <th>load</th>
    </tr>
    <tr>
      <th>year</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1970</th>
      <td>0.952757</td>
      <td>1140640</td>
      <td>106650</td>
      <td>0.534487</td>
    </tr>
    <tr>
      <th>1971</th>
      <td>0.986757</td>
      <td>1215690</td>
      <td>110307</td>
      <td>0.532328</td>
    </tr>
    <tr>
      <th>1972</th>
      <td>1.091980</td>
      <td>1309570</td>
      <td>110574</td>
      <td>0.547736</td>
    </tr>
    <tr>
      <th>1973</th>
      <td>1.175780</td>
      <td>1511530</td>
      <td>121974</td>
      <td>0.540846</td>
    </tr>
    <tr>
      <th>1974</th>
      <td>1.160170</td>
      <td>1676730</td>
      <td>196606</td>
      <td>0.591167</td>
    </tr>
    <tr>
      <th>1975</th>
      <td>1.173760</td>
      <td>1823740</td>
      <td>265609</td>
      <td>0.575417</td>
    </tr>
    <tr>
      <th>1976</th>
      <td>1.290510</td>
      <td>2022890</td>
      <td>263451</td>
      <td>0.594495</td>
    </tr>
    <tr>
      <th>1977</th>
      <td>1.390670</td>
      <td>2314760</td>
      <td>316411</td>
      <td>0.597409</td>
    </tr>
    <tr>
      <th>1978</th>
      <td>1.612730</td>
      <td>2639160</td>
      <td>384110</td>
      <td>0.638522</td>
    </tr>
    <tr>
      <th>1979</th>
      <td>1.825440</td>
      <td>3247620</td>
      <td>569251</td>
      <td>0.676287</td>
    </tr>
    <tr>
      <th>1980</th>
      <td>1.546040</td>
      <td>3787750</td>
      <td>871636</td>
      <td>0.605735</td>
    </tr>
    <tr>
      <th>1981</th>
      <td>1.527900</td>
      <td>3867750</td>
      <td>997239</td>
      <td>0.614360</td>
    </tr>
    <tr>
      <th>1982</th>
      <td>1.660200</td>
      <td>3996020</td>
      <td>938002</td>
      <td>0.633366</td>
    </tr>
    <tr>
      <th>1983</th>
      <td>1.822310</td>
      <td>4282880</td>
      <td>859572</td>
      <td>0.650117</td>
    </tr>
    <tr>
      <th>1984</th>
      <td>1.936460</td>
      <td>4748320</td>
      <td>823411</td>
      <td>0.625603</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">electricity_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">1970</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>output         0.520635
cost      569292.000000
price     103795.000000
load           0.490851
Name: 1970, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>If you want to pick values of a certain year, you change the order of indices using <strong>swaplevel</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">electricity_df</span><span class="o">.</span><span class="n">swaplevel</span><span class="p">(</span><span class="s1">&#39;firm&#39;</span><span class="p">,</span><span class="s1">&#39;year&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">1975</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>output</th>
      <th>cost</th>
      <th>price</th>
      <th>load</th>
    </tr>
    <tr>
      <th>firm</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>A</th>
      <td>1.173760</td>
      <td>1823740</td>
      <td>265609</td>
      <td>0.575417</td>
    </tr>
    <tr>
      <th>B</th>
      <td>0.852892</td>
      <td>1358100</td>
      <td>281704</td>
      <td>0.558133</td>
    </tr>
    <tr>
      <th>C</th>
      <td>0.367517</td>
      <td>510412</td>
      <td>278721</td>
      <td>0.607270</td>
    </tr>
    <tr>
      <th>D</th>
      <td>0.164272</td>
      <td>373941</td>
      <td>263148</td>
      <td>0.532723</td>
    </tr>
    <tr>
      <th>E</th>
      <td>0.073961</td>
      <td>156228</td>
      <td>277930</td>
      <td>0.556181</td>
    </tr>
    <tr>
      <th>F</th>
      <td>0.052462</td>
      <td>133161</td>
      <td>307923</td>
      <td>0.495361</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>You can easily calculate descriptive statistics at multiple levels. Most of the stat functions in Pandas include a <strong>level</strong> parameter for that.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">electricity_df</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>output    4.904952e+01
cost      1.010271e+08
price     4.245147e+07
load      5.044141e+01
dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">electricity_df</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>output</th>
      <th>cost</th>
      <th>price</th>
      <th>load</th>
    </tr>
    <tr>
      <th>firm</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>A</th>
      <td>21.153464</td>
      <td>39585050</td>
      <td>6934803</td>
      <td>8.957875</td>
    </tr>
    <tr>
      <th>B</th>
      <td>15.250419</td>
      <td>31918255</td>
      <td>6994301</td>
      <td>8.206419</td>
    </tr>
    <tr>
      <th>C</th>
      <td>6.185664</td>
      <td>10847838</td>
      <td>7145233</td>
      <td>8.768038</td>
    </tr>
    <tr>
      <th>D</th>
      <td>3.188515</td>
      <td>9571326</td>
      <td>7100522</td>
      <td>8.215159</td>
    </tr>
    <tr>
      <th>E</th>
      <td>1.707548</td>
      <td>4399139</td>
      <td>7171182</td>
      <td>8.497289</td>
    </tr>
    <tr>
      <th>F</th>
      <td>1.563908</td>
      <td>4705537</td>
      <td>7105430</td>
      <td>7.796634</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">electricity_df</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>output</th>
      <th>cost</th>
      <th>price</th>
      <th>load</th>
    </tr>
    <tr>
      <th>year</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1970</th>
      <td>1.910919</td>
      <td>2301736</td>
      <td>679554</td>
      <td>2.873152</td>
    </tr>
    <tr>
      <th>1971</th>
      <td>1.976987</td>
      <td>2506118</td>
      <td>701726</td>
      <td>2.920993</td>
    </tr>
    <tr>
      <th>1972</th>
      <td>2.295394</td>
      <td>2858803</td>
      <td>705968</td>
      <td>3.141480</td>
    </tr>
    <tr>
      <th>1973</th>
      <td>2.579854</td>
      <td>3408925</td>
      <td>747634</td>
      <td>3.146692</td>
    </tr>
    <tr>
      <th>1974</th>
      <td>2.647980</td>
      <td>3941906</td>
      <td>1280945</td>
      <td>3.381160</td>
    </tr>
    <tr>
      <th>1975</th>
      <td>2.684864</td>
      <td>4355582</td>
      <td>1675035</td>
      <td>3.325085</td>
    </tr>
    <tr>
      <th>1976</th>
      <td>2.936119</td>
      <td>4848733</td>
      <td>1832425</td>
      <td>3.364455</td>
    </tr>
    <tr>
      <th>1977</th>
      <td>3.173497</td>
      <td>5548301</td>
      <td>2106566</td>
      <td>3.402352</td>
    </tr>
    <tr>
      <th>1978</th>
      <td>3.731864</td>
      <td>6454748</td>
      <td>2310525</td>
      <td>3.707459</td>
    </tr>
    <tr>
      <th>1979</th>
      <td>4.190756</td>
      <td>8020356</td>
      <td>3347542</td>
      <td>3.740366</td>
    </tr>
    <tr>
      <th>1980</th>
      <td>3.853406</td>
      <td>9661270</td>
      <td>5148943</td>
      <td>3.481546</td>
    </tr>
    <tr>
      <th>1981</th>
      <td>3.800075</td>
      <td>10634533</td>
      <td>6046129</td>
      <td>3.513746</td>
    </tr>
    <tr>
      <th>1982</th>
      <td>4.016458</td>
      <td>11167822</td>
      <td>5675129</td>
      <td>3.481910</td>
    </tr>
    <tr>
      <th>1983</th>
      <td>4.493125</td>
      <td>12133405</td>
      <td>5209027</td>
      <td>3.482717</td>
    </tr>
    <tr>
      <th>1984</th>
      <td>4.758220</td>
      <td>13184907</td>
      <td>4984323</td>
      <td>3.478301</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>If we want to remove multi-index, we can use <strong>reset_index()</strong>. With the <strong>level</strong> parameter, you can decide how many levels from the multi-index are removed.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">electricity_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>year</th>
      <th>output</th>
      <th>cost</th>
      <th>price</th>
      <th>load</th>
    </tr>
    <tr>
      <th>firm</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>A</th>
      <td>1970</td>
      <td>0.952757</td>
      <td>1140640</td>
      <td>106650</td>
      <td>0.534487</td>
    </tr>
    <tr>
      <th>A</th>
      <td>1971</td>
      <td>0.986757</td>
      <td>1215690</td>
      <td>110307</td>
      <td>0.532328</td>
    </tr>
    <tr>
      <th>A</th>
      <td>1972</td>
      <td>1.091980</td>
      <td>1309570</td>
      <td>110574</td>
      <td>0.547736</td>
    </tr>
    <tr>
      <th>A</th>
      <td>1973</td>
      <td>1.175780</td>
      <td>1511530</td>
      <td>121974</td>
      <td>0.540846</td>
    </tr>
    <tr>
      <th>A</th>
      <td>1974</td>
      <td>1.160170</td>
      <td>1676730</td>
      <td>196606</td>
      <td>0.591167</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>F</th>
      <td>1980</td>
      <td>0.112640</td>
      <td>381478</td>
      <td>874818</td>
      <td>0.517766</td>
    </tr>
    <tr>
      <th>F</th>
      <td>1981</td>
      <td>0.154154</td>
      <td>506969</td>
      <td>1013170</td>
      <td>0.580049</td>
    </tr>
    <tr>
      <th>F</th>
      <td>1982</td>
      <td>0.186461</td>
      <td>633388</td>
      <td>930477</td>
      <td>0.556024</td>
    </tr>
    <tr>
      <th>F</th>
      <td>1983</td>
      <td>0.246847</td>
      <td>804388</td>
      <td>851676</td>
      <td>0.537791</td>
    </tr>
    <tr>
      <th>F</th>
      <td>1984</td>
      <td>0.304013</td>
      <td>1009500</td>
      <td>819476</td>
      <td>0.525775</td>
    </tr>
  </tbody>
</table>
<p>90 rows × 5 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">electricity_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Summary statistics can also be calculated using the <strong>groupby</strong> method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">electricity_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;firm&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>output</th>
      <th>cost</th>
      <th>price</th>
      <th>load</th>
    </tr>
    <tr>
      <th>firm</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>A</th>
      <td>1.410231</td>
      <td>2.639003e+06</td>
      <td>462320.200000</td>
      <td>0.597192</td>
    </tr>
    <tr>
      <th>B</th>
      <td>1.016695</td>
      <td>2.127884e+06</td>
      <td>466286.733333</td>
      <td>0.547095</td>
    </tr>
    <tr>
      <th>C</th>
      <td>0.412378</td>
      <td>7.231892e+05</td>
      <td>476348.866667</td>
      <td>0.584536</td>
    </tr>
    <tr>
      <th>D</th>
      <td>0.212568</td>
      <td>6.380884e+05</td>
      <td>473368.133333</td>
      <td>0.547677</td>
    </tr>
    <tr>
      <th>E</th>
      <td>0.113837</td>
      <td>2.932759e+05</td>
      <td>478078.800000</td>
      <td>0.566486</td>
    </tr>
    <tr>
      <th>F</th>
      <td>0.104261</td>
      <td>3.137025e+05</td>
      <td>473695.333333</td>
      <td>0.519776</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">electricity_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;firm&#39;</span><span class="p">,</span><span class="s1">&#39;year&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="c1"># The mean of single values</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>output</th>
      <th>cost</th>
      <th>price</th>
      <th>load</th>
    </tr>
    <tr>
      <th>firm</th>
      <th>year</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">A</th>
      <th>1970</th>
      <td>0.952757</td>
      <td>1140640</td>
      <td>106650</td>
      <td>0.534487</td>
    </tr>
    <tr>
      <th>1971</th>
      <td>0.986757</td>
      <td>1215690</td>
      <td>110307</td>
      <td>0.532328</td>
    </tr>
    <tr>
      <th>1972</th>
      <td>1.091980</td>
      <td>1309570</td>
      <td>110574</td>
      <td>0.547736</td>
    </tr>
    <tr>
      <th>1973</th>
      <td>1.175780</td>
      <td>1511530</td>
      <td>121974</td>
      <td>0.540846</td>
    </tr>
    <tr>
      <th>1974</th>
      <td>1.160170</td>
      <td>1676730</td>
      <td>196606</td>
      <td>0.591167</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">F</th>
      <th>1980</th>
      <td>0.112640</td>
      <td>381478</td>
      <td>874818</td>
      <td>0.517766</td>
    </tr>
    <tr>
      <th>1981</th>
      <td>0.154154</td>
      <td>506969</td>
      <td>1013170</td>
      <td>0.580049</td>
    </tr>
    <tr>
      <th>1982</th>
      <td>0.186461</td>
      <td>633388</td>
      <td>930477</td>
      <td>0.556024</td>
    </tr>
    <tr>
      <th>1983</th>
      <td>0.246847</td>
      <td>804388</td>
      <td>851676</td>
      <td>0.537791</td>
    </tr>
    <tr>
      <th>1984</th>
      <td>0.304013</td>
      <td>1009500</td>
      <td>819476</td>
      <td>0.525775</td>
    </tr>
  </tbody>
</table>
<p>90 rows × 4 columns</p>
</div></div></div>
</div>
<p><strong>stack</strong> and <strong>unstack</strong> can be used to reshape hierarchical index dataframes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">electricity_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">electricity_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>firm</th>
      <th>year</th>
      <th>output</th>
      <th>cost</th>
      <th>price</th>
      <th>load</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A</td>
      <td>1970</td>
      <td>0.952757</td>
      <td>1140640</td>
      <td>106650</td>
      <td>0.534487</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A</td>
      <td>1971</td>
      <td>0.986757</td>
      <td>1215690</td>
      <td>110307</td>
      <td>0.532328</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A</td>
      <td>1972</td>
      <td>1.091980</td>
      <td>1309570</td>
      <td>110574</td>
      <td>0.547736</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A</td>
      <td>1973</td>
      <td>1.175780</td>
      <td>1511530</td>
      <td>121974</td>
      <td>0.540846</td>
    </tr>
    <tr>
      <th>4</th>
      <td>A</td>
      <td>1974</td>
      <td>1.160170</td>
      <td>1676730</td>
      <td>196606</td>
      <td>0.591167</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>85</th>
      <td>F</td>
      <td>1980</td>
      <td>0.112640</td>
      <td>381478</td>
      <td>874818</td>
      <td>0.517766</td>
    </tr>
    <tr>
      <th>86</th>
      <td>F</td>
      <td>1981</td>
      <td>0.154154</td>
      <td>506969</td>
      <td>1013170</td>
      <td>0.580049</td>
    </tr>
    <tr>
      <th>87</th>
      <td>F</td>
      <td>1982</td>
      <td>0.186461</td>
      <td>633388</td>
      <td>930477</td>
      <td>0.556024</td>
    </tr>
    <tr>
      <th>88</th>
      <td>F</td>
      <td>1983</td>
      <td>0.246847</td>
      <td>804388</td>
      <td>851676</td>
      <td>0.537791</td>
    </tr>
    <tr>
      <th>89</th>
      <td>F</td>
      <td>1984</td>
      <td>0.304013</td>
      <td>1009500</td>
      <td>819476</td>
      <td>0.525775</td>
    </tr>
  </tbody>
</table>
<p>90 rows × 6 columns</p>
</div></div></div>
</div>
<p><strong>Stack</strong> turns a dataframe into a series.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_series</span><span class="o">=</span> <span class="n">electricity_df</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_series</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0   firm             A
    year          1970
    output    0.952757
    cost       1140640
    price       106650
                ...   
89  year          1984
    output    0.304013
    cost       1009500
    price       819476
    load      0.525775
Length: 540, dtype: object
</pre></div>
</div>
</div>
</div>
<p><strong>unstack()</strong> can be used to rearragne data back to a dataframe.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_series</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>firm</th>
      <th>year</th>
      <th>output</th>
      <th>cost</th>
      <th>price</th>
      <th>load</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A</td>
      <td>1970</td>
      <td>0.952757</td>
      <td>1140640</td>
      <td>106650</td>
      <td>0.534487</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A</td>
      <td>1971</td>
      <td>0.986757</td>
      <td>1215690</td>
      <td>110307</td>
      <td>0.532328</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A</td>
      <td>1972</td>
      <td>1.09198</td>
      <td>1309570</td>
      <td>110574</td>
      <td>0.547736</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A</td>
      <td>1973</td>
      <td>1.17578</td>
      <td>1511530</td>
      <td>121974</td>
      <td>0.540846</td>
    </tr>
    <tr>
      <th>4</th>
      <td>A</td>
      <td>1974</td>
      <td>1.16017</td>
      <td>1676730</td>
      <td>196606</td>
      <td>0.591167</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>85</th>
      <td>F</td>
      <td>1980</td>
      <td>0.11264</td>
      <td>381478</td>
      <td>874818</td>
      <td>0.517766</td>
    </tr>
    <tr>
      <th>86</th>
      <td>F</td>
      <td>1981</td>
      <td>0.154154</td>
      <td>506969</td>
      <td>1013170</td>
      <td>0.580049</td>
    </tr>
    <tr>
      <th>87</th>
      <td>F</td>
      <td>1982</td>
      <td>0.186461</td>
      <td>633388</td>
      <td>930477</td>
      <td>0.556024</td>
    </tr>
    <tr>
      <th>88</th>
      <td>F</td>
      <td>1983</td>
      <td>0.246847</td>
      <td>804388</td>
      <td>851676</td>
      <td>0.537791</td>
    </tr>
    <tr>
      <th>89</th>
      <td>F</td>
      <td>1984</td>
      <td>0.304013</td>
      <td>1009500</td>
      <td>819476</td>
      <td>0.525775</td>
    </tr>
  </tbody>
</table>
<p>90 rows × 6 columns</p>
</div></div></div>
</div>
<p>Yet another tool to reorganise data is <strong>pivot_table</strong>. More of it later.</p>
</div>
<div class="section" id="merging-datasets">
<h2><span class="section-number">4.3. </span>Merging datasets<a class="headerlink" href="#merging-datasets" title="Permalink to this headline">¶</a></h2>
<p>Merging dataframes is often difficult for Pandas beginners. It can be a hassle. The usual cause of difficulties is to forget the importance of index with Pandas datatypes. Merging dataframes is not about gluing tables together. The merging is done according to indices.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gasoline_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;https://vincentarelbundock.github.io/Rdatasets/csv/Ecdat/Gasoline.csv&#39;</span><span class="p">,</span><span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gasoline_df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;country&#39;</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gasoline_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>year</th>
      <th>lgaspcar</th>
      <th>lincomep</th>
      <th>lrpmg</th>
      <th>lcarpcap</th>
    </tr>
    <tr>
      <th>country</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>AUSTRIA</th>
      <td>1960</td>
      <td>4.173244</td>
      <td>-6.474277</td>
      <td>-0.334548</td>
      <td>-9.766840</td>
    </tr>
    <tr>
      <th>AUSTRIA</th>
      <td>1961</td>
      <td>4.100989</td>
      <td>-6.426006</td>
      <td>-0.351328</td>
      <td>-9.608622</td>
    </tr>
    <tr>
      <th>AUSTRIA</th>
      <td>1962</td>
      <td>4.073177</td>
      <td>-6.407308</td>
      <td>-0.379518</td>
      <td>-9.457257</td>
    </tr>
    <tr>
      <th>AUSTRIA</th>
      <td>1963</td>
      <td>4.059509</td>
      <td>-6.370679</td>
      <td>-0.414251</td>
      <td>-9.343155</td>
    </tr>
    <tr>
      <th>AUSTRIA</th>
      <td>1964</td>
      <td>4.037689</td>
      <td>-6.322247</td>
      <td>-0.445335</td>
      <td>-9.237739</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>U.S.A.</th>
      <td>1974</td>
      <td>4.798626</td>
      <td>-5.328694</td>
      <td>-1.231467</td>
      <td>-7.617558</td>
    </tr>
    <tr>
      <th>U.S.A.</th>
      <td>1975</td>
      <td>4.804932</td>
      <td>-5.346190</td>
      <td>-1.200377</td>
      <td>-7.607010</td>
    </tr>
    <tr>
      <th>U.S.A.</th>
      <td>1976</td>
      <td>4.814891</td>
      <td>-5.297946</td>
      <td>-1.154682</td>
      <td>-7.574748</td>
    </tr>
    <tr>
      <th>U.S.A.</th>
      <td>1977</td>
      <td>4.811032</td>
      <td>-5.256606</td>
      <td>-1.175910</td>
      <td>-7.553458</td>
    </tr>
    <tr>
      <th>U.S.A.</th>
      <td>1978</td>
      <td>4.818454</td>
      <td>-5.221232</td>
      <td>-1.212062</td>
      <td>-7.536176</td>
    </tr>
  </tbody>
</table>
<p>342 rows × 5 columns</p>
</div></div></div>
</div>
<p>Let’s split the data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gaso2_df</span> <span class="o">=</span> <span class="n">gasoline_df</span><span class="p">[[</span><span class="s1">&#39;lrpmg&#39;</span><span class="p">,</span><span class="s1">&#39;lcarpcap&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gasoline_df</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;lrpmg&#39;</span><span class="p">,</span><span class="s1">&#39;lcarpcap&#39;</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gasoline_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>year</th>
      <th>lgaspcar</th>
      <th>lincomep</th>
    </tr>
    <tr>
      <th>country</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>AUSTRIA</th>
      <td>1960</td>
      <td>4.173244</td>
      <td>-6.474277</td>
    </tr>
    <tr>
      <th>AUSTRIA</th>
      <td>1961</td>
      <td>4.100989</td>
      <td>-6.426006</td>
    </tr>
    <tr>
      <th>AUSTRIA</th>
      <td>1962</td>
      <td>4.073177</td>
      <td>-6.407308</td>
    </tr>
    <tr>
      <th>AUSTRIA</th>
      <td>1963</td>
      <td>4.059509</td>
      <td>-6.370679</td>
    </tr>
    <tr>
      <th>AUSTRIA</th>
      <td>1964</td>
      <td>4.037689</td>
      <td>-6.322247</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>U.S.A.</th>
      <td>1974</td>
      <td>4.798626</td>
      <td>-5.328694</td>
    </tr>
    <tr>
      <th>U.S.A.</th>
      <td>1975</td>
      <td>4.804932</td>
      <td>-5.346190</td>
    </tr>
    <tr>
      <th>U.S.A.</th>
      <td>1976</td>
      <td>4.814891</td>
      <td>-5.297946</td>
    </tr>
    <tr>
      <th>U.S.A.</th>
      <td>1977</td>
      <td>4.811032</td>
      <td>-5.256606</td>
    </tr>
    <tr>
      <th>U.S.A.</th>
      <td>1978</td>
      <td>4.818454</td>
      <td>-5.221232</td>
    </tr>
  </tbody>
</table>
<p>342 rows × 3 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gaso2_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>lrpmg</th>
      <th>lcarpcap</th>
    </tr>
    <tr>
      <th>country</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>AUSTRIA</th>
      <td>-0.334548</td>
      <td>-9.766840</td>
    </tr>
    <tr>
      <th>AUSTRIA</th>
      <td>-0.351328</td>
      <td>-9.608622</td>
    </tr>
    <tr>
      <th>AUSTRIA</th>
      <td>-0.379518</td>
      <td>-9.457257</td>
    </tr>
    <tr>
      <th>AUSTRIA</th>
      <td>-0.414251</td>
      <td>-9.343155</td>
    </tr>
    <tr>
      <th>AUSTRIA</th>
      <td>-0.445335</td>
      <td>-9.237739</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>U.S.A.</th>
      <td>-1.231467</td>
      <td>-7.617558</td>
    </tr>
    <tr>
      <th>U.S.A.</th>
      <td>-1.200377</td>
      <td>-7.607010</td>
    </tr>
    <tr>
      <th>U.S.A.</th>
      <td>-1.154682</td>
      <td>-7.574748</td>
    </tr>
    <tr>
      <th>U.S.A.</th>
      <td>-1.175910</td>
      <td>-7.553458</td>
    </tr>
    <tr>
      <th>U.S.A.</th>
      <td>-1.212062</td>
      <td>-7.536176</td>
    </tr>
  </tbody>
</table>
<p>342 rows × 2 columns</p>
</div></div></div>
</div>
<p><strong>Merge</strong> combindes according to the index values</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">gasoline_df</span><span class="p">,</span><span class="n">gaso2_df</span><span class="p">,</span><span class="n">on</span><span class="o">=</span><span class="s1">&#39;country&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>year</th>
      <th>lgaspcar</th>
      <th>lincomep</th>
      <th>lrpmg</th>
      <th>lcarpcap</th>
    </tr>
    <tr>
      <th>country</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>AUSTRIA</th>
      <td>1960</td>
      <td>4.173244</td>
      <td>-6.474277</td>
      <td>-0.334548</td>
      <td>-9.766840</td>
    </tr>
    <tr>
      <th>AUSTRIA</th>
      <td>1960</td>
      <td>4.173244</td>
      <td>-6.474277</td>
      <td>-0.351328</td>
      <td>-9.608622</td>
    </tr>
    <tr>
      <th>AUSTRIA</th>
      <td>1960</td>
      <td>4.173244</td>
      <td>-6.474277</td>
      <td>-0.379518</td>
      <td>-9.457257</td>
    </tr>
    <tr>
      <th>AUSTRIA</th>
      <td>1960</td>
      <td>4.173244</td>
      <td>-6.474277</td>
      <td>-0.414251</td>
      <td>-9.343155</td>
    </tr>
    <tr>
      <th>AUSTRIA</th>
      <td>1960</td>
      <td>4.173244</td>
      <td>-6.474277</td>
      <td>-0.445335</td>
      <td>-9.237739</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>U.S.A.</th>
      <td>1978</td>
      <td>4.818454</td>
      <td>-5.221232</td>
      <td>-1.231467</td>
      <td>-7.617558</td>
    </tr>
    <tr>
      <th>U.S.A.</th>
      <td>1978</td>
      <td>4.818454</td>
      <td>-5.221232</td>
      <td>-1.200377</td>
      <td>-7.607010</td>
    </tr>
    <tr>
      <th>U.S.A.</th>
      <td>1978</td>
      <td>4.818454</td>
      <td>-5.221232</td>
      <td>-1.154682</td>
      <td>-7.574748</td>
    </tr>
    <tr>
      <th>U.S.A.</th>
      <td>1978</td>
      <td>4.818454</td>
      <td>-5.221232</td>
      <td>-1.175910</td>
      <td>-7.553458</td>
    </tr>
    <tr>
      <th>U.S.A.</th>
      <td>1978</td>
      <td>4.818454</td>
      <td>-5.221232</td>
      <td>-1.212062</td>
      <td>-7.536176</td>
    </tr>
  </tbody>
</table>
<p>6498 rows × 5 columns</p>
</div></div></div>
</div>
<p>You could also do this by <em>activating</em> both indices for merging.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">gasoline_df</span><span class="p">,</span><span class="n">gaso2_df</span><span class="p">,</span><span class="n">left_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">right_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>year</th>
      <th>lgaspcar</th>
      <th>lincomep</th>
      <th>lrpmg</th>
      <th>lcarpcap</th>
    </tr>
    <tr>
      <th>country</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>AUSTRIA</th>
      <td>1960</td>
      <td>4.173244</td>
      <td>-6.474277</td>
      <td>-0.334548</td>
      <td>-9.766840</td>
    </tr>
    <tr>
      <th>AUSTRIA</th>
      <td>1960</td>
      <td>4.173244</td>
      <td>-6.474277</td>
      <td>-0.351328</td>
      <td>-9.608622</td>
    </tr>
    <tr>
      <th>AUSTRIA</th>
      <td>1960</td>
      <td>4.173244</td>
      <td>-6.474277</td>
      <td>-0.379518</td>
      <td>-9.457257</td>
    </tr>
    <tr>
      <th>AUSTRIA</th>
      <td>1960</td>
      <td>4.173244</td>
      <td>-6.474277</td>
      <td>-0.414251</td>
      <td>-9.343155</td>
    </tr>
    <tr>
      <th>AUSTRIA</th>
      <td>1960</td>
      <td>4.173244</td>
      <td>-6.474277</td>
      <td>-0.445335</td>
      <td>-9.237739</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>U.S.A.</th>
      <td>1978</td>
      <td>4.818454</td>
      <td>-5.221232</td>
      <td>-1.231467</td>
      <td>-7.617558</td>
    </tr>
    <tr>
      <th>U.S.A.</th>
      <td>1978</td>
      <td>4.818454</td>
      <td>-5.221232</td>
      <td>-1.200377</td>
      <td>-7.607010</td>
    </tr>
    <tr>
      <th>U.S.A.</th>
      <td>1978</td>
      <td>4.818454</td>
      <td>-5.221232</td>
      <td>-1.154682</td>
      <td>-7.574748</td>
    </tr>
    <tr>
      <th>U.S.A.</th>
      <td>1978</td>
      <td>4.818454</td>
      <td>-5.221232</td>
      <td>-1.175910</td>
      <td>-7.553458</td>
    </tr>
    <tr>
      <th>U.S.A.</th>
      <td>1978</td>
      <td>4.818454</td>
      <td>-5.221232</td>
      <td>-1.212062</td>
      <td>-7.536176</td>
    </tr>
  </tbody>
</table>
<p>6498 rows × 5 columns</p>
</div></div></div>
</div>
<p>You can also use <strong>join</strong>. It uses the index values for merging by default.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gasoline_df</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">gaso2_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>year</th>
      <th>lgaspcar</th>
      <th>lincomep</th>
      <th>lrpmg</th>
      <th>lcarpcap</th>
    </tr>
    <tr>
      <th>country</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>AUSTRIA</th>
      <td>1960</td>
      <td>4.173244</td>
      <td>-6.474277</td>
      <td>-0.334548</td>
      <td>-9.766840</td>
    </tr>
    <tr>
      <th>AUSTRIA</th>
      <td>1960</td>
      <td>4.173244</td>
      <td>-6.474277</td>
      <td>-0.351328</td>
      <td>-9.608622</td>
    </tr>
    <tr>
      <th>AUSTRIA</th>
      <td>1960</td>
      <td>4.173244</td>
      <td>-6.474277</td>
      <td>-0.379518</td>
      <td>-9.457257</td>
    </tr>
    <tr>
      <th>AUSTRIA</th>
      <td>1960</td>
      <td>4.173244</td>
      <td>-6.474277</td>
      <td>-0.414251</td>
      <td>-9.343155</td>
    </tr>
    <tr>
      <th>AUSTRIA</th>
      <td>1960</td>
      <td>4.173244</td>
      <td>-6.474277</td>
      <td>-0.445335</td>
      <td>-9.237739</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>U.S.A.</th>
      <td>1978</td>
      <td>4.818454</td>
      <td>-5.221232</td>
      <td>-1.231467</td>
      <td>-7.617558</td>
    </tr>
    <tr>
      <th>U.S.A.</th>
      <td>1978</td>
      <td>4.818454</td>
      <td>-5.221232</td>
      <td>-1.200377</td>
      <td>-7.607010</td>
    </tr>
    <tr>
      <th>U.S.A.</th>
      <td>1978</td>
      <td>4.818454</td>
      <td>-5.221232</td>
      <td>-1.154682</td>
      <td>-7.574748</td>
    </tr>
    <tr>
      <th>U.S.A.</th>
      <td>1978</td>
      <td>4.818454</td>
      <td>-5.221232</td>
      <td>-1.175910</td>
      <td>-7.553458</td>
    </tr>
    <tr>
      <th>U.S.A.</th>
      <td>1978</td>
      <td>4.818454</td>
      <td>-5.221232</td>
      <td>-1.212062</td>
      <td>-7.536176</td>
    </tr>
  </tbody>
</table>
<p>6498 rows × 5 columns</p>
</div></div></div>
</div>
<p><strong>Concat</strong> is a more general tool for merging data. It is easiest to understand how it works, if we use very simple datasets. Let’s create three simple Pandas Series.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">20</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">40</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">])</span>
<span class="n">x2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">50</span><span class="p">,</span><span class="mi">60</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;e&#39;</span><span class="p">,</span><span class="s1">&#39;f&#39;</span><span class="p">])</span>
<span class="n">x3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">70</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="mi">90</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;h&#39;</span><span class="p">,</span><span class="s1">&#39;i&#39;</span><span class="p">,</span><span class="s1">&#39;j&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>If we just feed them to <strong>concat</strong>, they are joined together as a longer Series.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">x3</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>a    20
b    30
c    40
e    50
f    60
h    70
i    80
j    90
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>If you change the axis, the result will be a dataframe, because there are no overlapping index values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">x3</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>20.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>b</th>
      <td>30.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>c</th>
      <td>40.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>e</th>
      <td>NaN</td>
      <td>50.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>f</th>
      <td>NaN</td>
      <td>60.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>h</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>70.0</td>
    </tr>
    <tr>
      <th>i</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>80.0</td>
    </tr>
    <tr>
      <th>j</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>90.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x4</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">x4</span><span class="p">,</span><span class="n">x2</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>20</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>b</th>
      <td>30</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>c</th>
      <td>40</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>e</th>
      <td>50</td>
      <td>50.0</td>
    </tr>
    <tr>
      <th>f</th>
      <td>60</td>
      <td>60.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>If you just want to keep the intersction of the series, you can use <strong>join=’inner’</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">x4</span><span class="p">,</span><span class="n">x2</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">join</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>e</th>
      <td>50</td>
      <td>50</td>
    </tr>
    <tr>
      <th>f</th>
      <td>60</td>
      <td>60</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="data-aggreagation">
<h2><span class="section-number">4.4. </span>Data aggreagation<a class="headerlink" href="#data-aggreagation" title="Permalink to this headline">¶</a></h2>
<p>Data aggregation is one the most important steps in data preprocessing. Pandas has many tools for that.</p>
<p><strong>Groupby</strong> is an important tool in aggragation. Let’s load a new dataset for this.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">comp_returns_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;comp_returns.csv&#39;</span><span class="p">,</span><span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">comp_returns_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>NAME</th>
      <th>ISO COUNTRY CODE</th>
      <th>RETURN ON EQUITY - TOTAL (%)</th>
      <th>TOTAL DEBT % COMMON EQUITY</th>
      <th>RESEARCH &amp; DEVELOPMENT/SALES -</th>
      <th>ACCOUNTING STANDARDS FOLLOWED</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>APPLE</td>
      <td>US</td>
      <td>55.92</td>
      <td>119.40</td>
      <td>4.95</td>
      <td>US standards (GAAP)</td>
    </tr>
    <tr>
      <th>1</th>
      <td>SAUDI ARABIAN OIL</td>
      <td>SA</td>
      <td>32.25</td>
      <td>16.96</td>
      <td>NaN</td>
      <td>IFRS</td>
    </tr>
    <tr>
      <th>2</th>
      <td>MICROSOFT</td>
      <td>US</td>
      <td>40.14</td>
      <td>61.56</td>
      <td>13.59</td>
      <td>US standards (GAAP)</td>
    </tr>
    <tr>
      <th>3</th>
      <td>AMAZON.COM</td>
      <td>US</td>
      <td>21.95</td>
      <td>83.31</td>
      <td>12.29</td>
      <td>US standards (GAAP)</td>
    </tr>
    <tr>
      <th>4</th>
      <td>FACEBOOK CLASS A</td>
      <td>US</td>
      <td>19.96</td>
      <td>0.47</td>
      <td>21.00</td>
      <td>US standards (GAAP)</td>
    </tr>
    <tr>
      <th>5</th>
      <td>TENCENT HOLDINGS</td>
      <td>HK</td>
      <td>24.68</td>
      <td>53.74</td>
      <td>7.72</td>
      <td>IFRS</td>
    </tr>
    <tr>
      <th>6</th>
      <td>ALPHABET A</td>
      <td>US</td>
      <td>18.12</td>
      <td>2.26</td>
      <td>15.71</td>
      <td>US standards (GAAP)</td>
    </tr>
    <tr>
      <th>7</th>
      <td>TESLA</td>
      <td>US</td>
      <td>-14.94</td>
      <td>202.77</td>
      <td>10.73</td>
      <td>US standards (GAAP)</td>
    </tr>
    <tr>
      <th>8</th>
      <td>WALMART</td>
      <td>US</td>
      <td>20.22</td>
      <td>72.95</td>
      <td>NaN</td>
      <td>US standards (GAAP)</td>
    </tr>
    <tr>
      <th>9</th>
      <td>JOHNSON &amp; JOHNSON</td>
      <td>US</td>
      <td>25.36</td>
      <td>46.57</td>
      <td>13.28</td>
      <td>US standards (GAAP)</td>
    </tr>
    <tr>
      <th>10</th>
      <td>TAIWAN SEMICON.MNFG.</td>
      <td>TW</td>
      <td>20.94</td>
      <td>11.89</td>
      <td>8.08</td>
      <td>IFRS</td>
    </tr>
    <tr>
      <th>11</th>
      <td>NESTLE 'N'</td>
      <td>CH</td>
      <td>23.05</td>
      <td>71.42</td>
      <td>1.88</td>
      <td>IFRS</td>
    </tr>
    <tr>
      <th>12</th>
      <td>PROCTER &amp; GAMBLE</td>
      <td>US</td>
      <td>27.78</td>
      <td>76.10</td>
      <td>2.79</td>
      <td>US standards (GAAP)</td>
    </tr>
    <tr>
      <th>13</th>
      <td>VISA 'A'</td>
      <td>US</td>
      <td>40.34</td>
      <td>57.25</td>
      <td>NaN</td>
      <td>US standards (GAAP)</td>
    </tr>
    <tr>
      <th>14</th>
      <td>MASTERCARD</td>
      <td>US</td>
      <td>143.83</td>
      <td>144.70</td>
      <td>NaN</td>
      <td>US standards (GAAP)</td>
    </tr>
    <tr>
      <th>15</th>
      <td>NVIDIA</td>
      <td>US</td>
      <td>25.95</td>
      <td>16.31</td>
      <td>22.49</td>
      <td>US standards (GAAP)</td>
    </tr>
    <tr>
      <th>16</th>
      <td>3I GROUP</td>
      <td>GB</td>
      <td>2.73</td>
      <td>7.67</td>
      <td>NaN</td>
      <td>IFRS</td>
    </tr>
    <tr>
      <th>17</th>
      <td>JP MORGAN CHASE &amp; CO.</td>
      <td>US</td>
      <td>14.91</td>
      <td>220.24</td>
      <td>NaN</td>
      <td>US standards (GAAP)</td>
    </tr>
    <tr>
      <th>18</th>
      <td>HOME DEPOT</td>
      <td>US</td>
      <td>NaN</td>
      <td>-1010.37</td>
      <td>NaN</td>
      <td>US standards (GAAP)</td>
    </tr>
    <tr>
      <th>19</th>
      <td>KWEICHOW MOUTAI 'A'</td>
      <td>CN</td>
      <td>33.12</td>
      <td>9.14</td>
      <td>0.85</td>
      <td>Local standards</td>
    </tr>
    <tr>
      <th>20</th>
      <td>SAMSUNG ELECTRONICS</td>
      <td>KR</td>
      <td>8.69</td>
      <td>7.22</td>
      <td>7.39</td>
      <td>IFRS</td>
    </tr>
    <tr>
      <th>21</th>
      <td>UNITEDHEALTH GROUP</td>
      <td>US</td>
      <td>25.40</td>
      <td>71.33</td>
      <td>NaN</td>
      <td>US standards (GAAP)</td>
    </tr>
    <tr>
      <th>22</th>
      <td>ROCHE HOLDING</td>
      <td>CH</td>
      <td>44.71</td>
      <td>47.58</td>
      <td>19.38</td>
      <td>IFRS</td>
    </tr>
    <tr>
      <th>23</th>
      <td>VERIZON COMMUNICATIONS</td>
      <td>US</td>
      <td>33.64</td>
      <td>181.59</td>
      <td>NaN</td>
      <td>US standards (GAAP)</td>
    </tr>
    <tr>
      <th>24</th>
      <td>LVMH</td>
      <td>FR</td>
      <td>20.82</td>
      <td>68.97</td>
      <td>0.28</td>
      <td>IFRS</td>
    </tr>
    <tr>
      <th>25</th>
      <td>NETFLIX</td>
      <td>US</td>
      <td>29.12</td>
      <td>204.38</td>
      <td>8.73</td>
      <td>US standards (GAAP)</td>
    </tr>
    <tr>
      <th>26</th>
      <td>ADOBE (NAS)</td>
      <td>US</td>
      <td>29.67</td>
      <td>39.30</td>
      <td>17.15</td>
      <td>US standards (GAAP)</td>
    </tr>
    <tr>
      <th>27</th>
      <td>TOYOTA MOTOR</td>
      <td>JP</td>
      <td>10.45</td>
      <td>102.45</td>
      <td>3.66</td>
      <td>US standards (GAAP)</td>
    </tr>
    <tr>
      <th>28</th>
      <td>PAYPAL HOLDINGS</td>
      <td>US</td>
      <td>15.24</td>
      <td>29.48</td>
      <td>8.49</td>
      <td>US standards (GAAP)</td>
    </tr>
    <tr>
      <th>29</th>
      <td>SALESFORCE.COM</td>
      <td>US</td>
      <td>0.51</td>
      <td>9.04</td>
      <td>14.76</td>
      <td>US standards (GAAP)</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Now, we can group data by the accounting standards variable and calculate the mean. Notice how Pandas automatically drops the country variable, because you cannot calculate a mean from strings:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">comp_returns_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;ACCOUNTING STANDARDS FOLLOWED&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>RETURN ON EQUITY - TOTAL (%)</th>
      <th>TOTAL DEBT % COMMON EQUITY</th>
      <th>RESEARCH &amp; DEVELOPMENT/SALES -</th>
    </tr>
    <tr>
      <th>ACCOUNTING STANDARDS FOLLOWED</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>IFRS</th>
      <td>22.23375</td>
      <td>35.68125</td>
      <td>7.455000</td>
    </tr>
    <tr>
      <th>Local standards</th>
      <td>33.12000</td>
      <td>9.14000</td>
      <td>0.850000</td>
    </tr>
    <tr>
      <th>US standards (GAAP)</th>
      <td>29.17850</td>
      <td>34.81381</td>
      <td>12.115714</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>You can make a two-level grouping by adding a list of columns to <strong>groupby</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">comp_returns_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;ISO COUNTRY CODE&#39;</span><span class="p">,</span><span class="s1">&#39;ACCOUNTING STANDARDS FOLLOWED&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>RETURN ON EQUITY - TOTAL (%)</th>
      <th>TOTAL DEBT % COMMON EQUITY</th>
      <th>RESEARCH &amp; DEVELOPMENT/SALES -</th>
    </tr>
    <tr>
      <th>ISO COUNTRY CODE</th>
      <th>ACCOUNTING STANDARDS FOLLOWED</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>CH</th>
      <th>IFRS</th>
      <td>33.880000</td>
      <td>59.500</td>
      <td>10.630000</td>
    </tr>
    <tr>
      <th>CN</th>
      <th>Local standards</th>
      <td>33.120000</td>
      <td>9.140</td>
      <td>0.850000</td>
    </tr>
    <tr>
      <th>FR</th>
      <th>IFRS</th>
      <td>20.820000</td>
      <td>68.970</td>
      <td>0.280000</td>
    </tr>
    <tr>
      <th>GB</th>
      <th>IFRS</th>
      <td>2.730000</td>
      <td>7.670</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>HK</th>
      <th>IFRS</th>
      <td>24.680000</td>
      <td>53.740</td>
      <td>7.720000</td>
    </tr>
    <tr>
      <th>JP</th>
      <th>US standards (GAAP)</th>
      <td>10.450000</td>
      <td>102.450</td>
      <td>3.660000</td>
    </tr>
    <tr>
      <th>KR</th>
      <th>IFRS</th>
      <td>8.690000</td>
      <td>7.220</td>
      <td>7.390000</td>
    </tr>
    <tr>
      <th>SA</th>
      <th>IFRS</th>
      <td>32.250000</td>
      <td>16.960</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>TW</th>
      <th>IFRS</th>
      <td>20.940000</td>
      <td>11.890</td>
      <td>8.080000</td>
    </tr>
    <tr>
      <th>US</th>
      <th>US standards (GAAP)</th>
      <td>30.164211</td>
      <td>31.432</td>
      <td>12.766154</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>There are many other groupby-methods, like <strong>size()</strong>. The full list of <strong>groupby</strong> -methods are here: <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/groupby.html">pandas.pydata.org/pandas-docs/stable/reference/groupby.html</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">comp_returns_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;ISO COUNTRY CODE&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ISO COUNTRY CODE
CH     2
CN     1
FR     1
GB     1
HK     1
JP     1
KR     1
SA     1
TW     1
US    20
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>If we just use the <strong>groupby</strong> method without a following method, it will return a Pandas groupby object.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">comp_returns_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;ISO COUNTRY CODE&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pandas.core.groupby.generic.DataFrameGroupBy object at 0x00000160F39C3B80&gt;
</pre></div>
</div>
</div>
</div>
<p>This object can be used for iteration.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">name</span><span class="p">,</span><span class="n">group</span> <span class="ow">in</span> <span class="n">comp_returns_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;ISO COUNTRY CODE&#39;</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">group</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CH
2
CN
1
FR
1
GB
1
HK
1
JP
1
KR
1
SA
1
TW
1
US
20
</pre></div>
</div>
</div>
</div>
<p>You could also group data according to columns using <strong>axis=1</strong>. It makes not much sense with this data, so we skip that example.</p>
<p>You can easily pick up just one column from a groupby object.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">comp_returns_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;ISO COUNTRY CODE&#39;</span><span class="p">)[</span><span class="s1">&#39;RETURN ON EQUITY - TOTAL (%)&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ISO COUNTRY CODE
CH    33.880000
CN    33.120000
FR    20.820000
GB     2.730000
HK    24.680000
JP    10.450000
KR     8.690000
SA    32.250000
TW    20.940000
US    30.164211
Name: RETURN ON EQUITY - TOTAL (%), dtype: float64
</pre></div>
</div>
</div>
</div>
<p>You could group data by defining a dict, a function etc. We do not go to these advanced methods here.</p>
<div class="section" id="data-aggregation">
<h3><span class="section-number">4.4.1. </span>Data aggregation<a class="headerlink" href="#data-aggregation" title="Permalink to this headline">¶</a></h3>
<p>Now that we know the basics of <strong>groupby</strong>, we can analyse more how it can be used to aggregate data. The methods of <strong>groupby</strong> are <strong>count, sum, mean, median, std, var, min, max, prod, first and last</strong>. These are opitmised for groupby objects, but many other methods work too. Actually, you can define your own functions with <strong>groupby.agg()</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">mean_median</span><span class="p">(</span><span class="n">arr</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">arr</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">-</span><span class="n">arr</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">comp_returns_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;ACCOUNTING STANDARDS FOLLOWED&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">mean_median</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>RETURN ON EQUITY - TOTAL (%)</th>
      <th>TOTAL DEBT % COMMON EQUITY</th>
      <th>RESEARCH &amp; DEVELOPMENT/SALES -</th>
    </tr>
    <tr>
      <th>ACCOUNTING STANDARDS FOLLOWED</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>IFRS</th>
      <td>0.23875</td>
      <td>3.41125</td>
      <td>-0.100000</td>
    </tr>
    <tr>
      <th>Local standards</th>
      <td>0.00000</td>
      <td>0.00000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>US standards (GAAP)</th>
      <td>3.79850</td>
      <td>-36.51619</td>
      <td>-0.669286</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Basically, those Pandas methods will work with <strong>groupby</strong> that are some kind of aggregations. For example, quantile can be used</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">comp_returns_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;ACCOUNTING STANDARDS FOLLOWED&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.9</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>RETURN ON EQUITY - TOTAL (%)</th>
      <th>TOTAL DEBT % COMMON EQUITY</th>
      <th>RESEARCH &amp; DEVELOPMENT/SALES -</th>
    </tr>
    <tr>
      <th>ACCOUNTING STANDARDS FOLLOWED</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>IFRS</th>
      <td>35.988</td>
      <td>69.705</td>
      <td>13.730</td>
    </tr>
    <tr>
      <th>Local standards</th>
      <td>33.120</td>
      <td>9.140</td>
      <td>0.850</td>
    </tr>
    <tr>
      <th>US standards (GAAP)</th>
      <td>41.898</td>
      <td>202.770</td>
      <td>19.845</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Even though <strong>describe</strong> is not an aggregating function, it will also work.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">comp_returns_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;ACCOUNTING STANDARDS FOLLOWED&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="8" halign="left">RETURN ON EQUITY - TOTAL (%)</th>
      <th colspan="5" halign="left">TOTAL DEBT % COMMON EQUITY</th>
      <th colspan="8" halign="left">RESEARCH &amp; DEVELOPMENT/SALES -</th>
    </tr>
    <tr>
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
      <th>count</th>
      <th>mean</th>
      <th>...</th>
      <th>75%</th>
      <th>max</th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
    <tr>
      <th>ACCOUNTING STANDARDS FOLLOWED</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>IFRS</th>
      <td>8.0</td>
      <td>22.23375</td>
      <td>12.981632</td>
      <td>2.73</td>
      <td>17.7875</td>
      <td>21.995</td>
      <td>26.5725</td>
      <td>44.71</td>
      <td>8.0</td>
      <td>35.68125</td>
      <td>...</td>
      <td>57.5475</td>
      <td>71.42</td>
      <td>6.0</td>
      <td>7.455000</td>
      <td>6.711661</td>
      <td>0.28</td>
      <td>3.2575</td>
      <td>7.555</td>
      <td>7.9900</td>
      <td>19.38</td>
    </tr>
    <tr>
      <th>Local standards</th>
      <td>1.0</td>
      <td>33.12000</td>
      <td>NaN</td>
      <td>33.12</td>
      <td>33.1200</td>
      <td>33.120</td>
      <td>33.1200</td>
      <td>33.12</td>
      <td>1.0</td>
      <td>9.14000</td>
      <td>...</td>
      <td>9.1400</td>
      <td>9.14</td>
      <td>1.0</td>
      <td>0.850000</td>
      <td>NaN</td>
      <td>0.85</td>
      <td>0.8500</td>
      <td>0.850</td>
      <td>0.8500</td>
      <td>0.85</td>
    </tr>
    <tr>
      <th>US standards (GAAP)</th>
      <td>20.0</td>
      <td>29.17850</td>
      <td>30.798945</td>
      <td>-14.94</td>
      <td>17.4000</td>
      <td>25.380</td>
      <td>30.6625</td>
      <td>143.83</td>
      <td>21.0</td>
      <td>34.81381</td>
      <td>...</td>
      <td>119.4000</td>
      <td>220.24</td>
      <td>14.0</td>
      <td>12.115714</td>
      <td>6.023770</td>
      <td>2.79</td>
      <td>8.5500</td>
      <td>12.785</td>
      <td>15.4725</td>
      <td>22.49</td>
    </tr>
  </tbody>
</table>
<p>3 rows × 24 columns</p>
</div></div></div>
</div>
<p>You can make the previous table more readable by unstacking it.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">comp_returns_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;ACCOUNTING STANDARDS FOLLOWED&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                       ACCOUNTING STANDARDS FOLLOWED
RETURN ON EQUITY - TOTAL (%)    count  IFRS                              8.00000
                                       Local standards                   1.00000
                                       US standards (GAAP)              20.00000
                                mean   IFRS                             22.23375
                                       Local standards                  33.12000
                                                                          ...   
RESEARCH &amp; DEVELOPMENT/SALES -  75%    Local standards                   0.85000
                                       US standards (GAAP)              15.47250
                                max    IFRS                             19.38000
                                       Local standards                   0.85000
                                       US standards (GAAP)              22.49000
Length: 72, dtype: float64
</pre></div>
</div>
</div>
</div>
<p><strong>Apply()</strong> is the most versatile method to use with groupby objects.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">medalists</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="n">var</span> <span class="o">=</span> <span class="s1">&#39;RETURN ON EQUITY - TOTAL (%)&#39;</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="n">var</span><span class="p">)[</span><span class="o">-</span><span class="mi">3</span><span class="p">:]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">comp_returns_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;ACCOUNTING STANDARDS FOLLOWED&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">medalists</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>NAME</th>
      <th>ISO COUNTRY CODE</th>
      <th>RETURN ON EQUITY - TOTAL (%)</th>
      <th>TOTAL DEBT % COMMON EQUITY</th>
      <th>RESEARCH &amp; DEVELOPMENT/SALES -</th>
      <th>ACCOUNTING STANDARDS FOLLOWED</th>
    </tr>
    <tr>
      <th>ACCOUNTING STANDARDS FOLLOWED</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="3" valign="top">IFRS</th>
      <th>5</th>
      <td>TENCENT HOLDINGS</td>
      <td>HK</td>
      <td>24.68</td>
      <td>53.74</td>
      <td>7.72</td>
      <td>IFRS</td>
    </tr>
    <tr>
      <th>1</th>
      <td>SAUDI ARABIAN OIL</td>
      <td>SA</td>
      <td>32.25</td>
      <td>16.96</td>
      <td>NaN</td>
      <td>IFRS</td>
    </tr>
    <tr>
      <th>22</th>
      <td>ROCHE HOLDING</td>
      <td>CH</td>
      <td>44.71</td>
      <td>47.58</td>
      <td>19.38</td>
      <td>IFRS</td>
    </tr>
    <tr>
      <th>Local standards</th>
      <th>19</th>
      <td>KWEICHOW MOUTAI 'A'</td>
      <td>CN</td>
      <td>33.12</td>
      <td>9.14</td>
      <td>0.85</td>
      <td>Local standards</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">US standards (GAAP)</th>
      <th>0</th>
      <td>APPLE</td>
      <td>US</td>
      <td>55.92</td>
      <td>119.40</td>
      <td>4.95</td>
      <td>US standards (GAAP)</td>
    </tr>
    <tr>
      <th>14</th>
      <td>MASTERCARD</td>
      <td>US</td>
      <td>143.83</td>
      <td>144.70</td>
      <td>NaN</td>
      <td>US standards (GAAP)</td>
    </tr>
    <tr>
      <th>18</th>
      <td>HOME DEPOT</td>
      <td>US</td>
      <td>NaN</td>
      <td>-1010.37</td>
      <td>NaN</td>
      <td>US standards (GAAP)</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>It  is also possible to use the bins created with <strong>cut</strong> or <strong>qcut</strong> as a grouping criteria in <strong>groupby</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ROE_quartiles</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">qcut</span><span class="p">(</span><span class="n">comp_returns_df</span><span class="p">[</span><span class="s1">&#39;RETURN ON EQUITY - TOTAL (%)&#39;</span><span class="p">],</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">comp_returns_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">ROE_quartiles</span><span class="p">)</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>RETURN ON EQUITY - TOTAL (%)
(-14.940999999999999, 18.12]    8
(18.12, 24.68]                  7
(24.68, 32.25]                  7
(32.25, 143.83]                 7
dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">comp_returns_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">ROE_quartiles</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>RETURN ON EQUITY - TOTAL (%)</th>
      <th>TOTAL DEBT % COMMON EQUITY</th>
      <th>RESEARCH &amp; DEVELOPMENT/SALES -</th>
    </tr>
    <tr>
      <th>RETURN ON EQUITY - TOTAL (%)</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>(-14.940999999999999, 18.12]</th>
      <td>6.963750</td>
      <td>72.641250</td>
      <td>10.123333</td>
    </tr>
    <tr>
      <th>(18.12, 24.68]</th>
      <td>21.660000</td>
      <td>51.821429</td>
      <td>8.541667</td>
    </tr>
    <tr>
      <th>(24.68, 32.25]</th>
      <td>27.932857</td>
      <td>67.278571</td>
      <td>12.888000</td>
    </tr>
    <tr>
      <th>(32.25, 143.83]</th>
      <td>55.957143</td>
      <td>88.745714</td>
      <td>9.692500</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Pivot tables are another option to organise data with Pandas. They are very popular in spreadsheet softwares, like Excel.It is very similar to cross-tabs that we use in statistics. Pandas has a specific function for pivot tables.</p>
<p>Let’s load a new data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">large_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;large_table.csv&#39;</span><span class="p">,</span><span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">large_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;Type&#39;</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">large_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>NAME</th>
      <th>ISO COUNTRY CODE</th>
      <th>RETURN ON EQUITY - TOTAL (%)</th>
      <th>TOTAL DEBT % COMMON EQUITY</th>
      <th>RESEARCH &amp; DEVELOPMENT/SALES -</th>
      <th>INDUSTRY GROUP</th>
      <th>ACCOUNTING STANDARDS FOLLOWED</th>
      <th>CSR Sustainability External Audit</th>
      <th>Audit Committee</th>
      <th>CSR Sustainability Committee</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>APPLE</td>
      <td>US</td>
      <td>55.92</td>
      <td>119.40</td>
      <td>4.95</td>
      <td>34</td>
      <td>US standards (GAAP)</td>
      <td>Y</td>
      <td>Y</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>1</th>
      <td>SAUDI ARABIAN OIL</td>
      <td>SA</td>
      <td>32.25</td>
      <td>16.96</td>
      <td>NaN</td>
      <td>97</td>
      <td>IFRS</td>
      <td>NaN</td>
      <td>Y</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>2</th>
      <td>MICROSOFT</td>
      <td>US</td>
      <td>40.14</td>
      <td>61.56</td>
      <td>13.59</td>
      <td>58</td>
      <td>US standards (GAAP)</td>
      <td>NaN</td>
      <td>Y</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>3</th>
      <td>AMAZON.COM</td>
      <td>US</td>
      <td>21.95</td>
      <td>83.31</td>
      <td>12.29</td>
      <td>87</td>
      <td>US standards (GAAP)</td>
      <td>Y</td>
      <td>Y</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>4</th>
      <td>FACEBOOK CLASS A</td>
      <td>US</td>
      <td>19.96</td>
      <td>0.47</td>
      <td>21.00</td>
      <td>151</td>
      <td>US standards (GAAP)</td>
      <td>Y</td>
      <td>Y</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>100</th>
      <td>CHINA MERCHANTS BANK 'A'</td>
      <td>CN</td>
      <td>16.84</td>
      <td>301.52</td>
      <td>NaN</td>
      <td>102</td>
      <td>IFRS</td>
      <td>Y</td>
      <td>Y</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>101</th>
      <td>ENEL</td>
      <td>IT</td>
      <td>7.00</td>
      <td>202.46</td>
      <td>NaN</td>
      <td>169</td>
      <td>IFRS</td>
      <td>Y</td>
      <td>Y</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>102</th>
      <td>JD COM ADR 1:2</td>
      <td>CN</td>
      <td>17.28</td>
      <td>12.28</td>
      <td>2.18</td>
      <td>87</td>
      <td>US standards (GAAP)</td>
      <td>NaN</td>
      <td>Y</td>
      <td>N</td>
    </tr>
    <tr>
      <th>103</th>
      <td>KEYENCE</td>
      <td>JP</td>
      <td>11.84</td>
      <td>0.00</td>
      <td>2.76</td>
      <td>214</td>
      <td>Local standards</td>
      <td>NaN</td>
      <td>N</td>
      <td>N</td>
    </tr>
    <tr>
      <th>104</th>
      <td>HSBC HOLDINGS</td>
      <td>GB</td>
      <td>3.71</td>
      <td>328.78</td>
      <td>NaN</td>
      <td>102</td>
      <td>IFRS</td>
      <td>Y</td>
      <td>Y</td>
      <td>Y</td>
    </tr>
  </tbody>
</table>
<p>105 rows × 10 columns</p>
</div></div></div>
</div>
<p>The default <strong>pivot_table</strong> aggregation type is mean.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">large_df</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;NAME&#39;, &#39;ISO COUNTRY CODE&#39;, &#39;RETURN ON EQUITY - TOTAL (%)&#39;,
       &#39;TOTAL DEBT % COMMON EQUITY&#39;, &#39;RESEARCH &amp; DEVELOPMENT/SALES -&#39;,
       &#39;INDUSTRY GROUP&#39;, &#39;ACCOUNTING STANDARDS FOLLOWED&#39;,
       &#39;CSR Sustainability External Audit&#39;, &#39;Audit Committee&#39;,
       &#39;CSR Sustainability Committee&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">large_df</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="s1">&#39;RETURN ON EQUITY - TOTAL (%)&#39;</span><span class="p">,</span>
                     <span class="n">index</span><span class="o">=</span><span class="s1">&#39;CSR Sustainability External Audit&#39;</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="s1">&#39;ACCOUNTING STANDARDS FOLLOWED&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>ACCOUNTING STANDARDS FOLLOWED</th>
      <th>IFRS</th>
      <th>Local standards</th>
      <th>US standards (GAAP)</th>
    </tr>
    <tr>
      <th>CSR Sustainability External Audit</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>N</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>22.380000</td>
    </tr>
    <tr>
      <th>Y</th>
      <td>18.968333</td>
      <td>23.315</td>
      <td>46.280556</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>You can use hierarchical index and add marginal sums to the table.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">large_df</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="s1">&#39;RETURN ON EQUITY - TOTAL (%)&#39;</span><span class="p">,</span>
                     <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;CSR Sustainability External Audit&#39;</span><span class="p">,</span><span class="s1">&#39;Audit Committee&#39;</span><span class="p">],</span>
                     <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;ACCOUNTING STANDARDS FOLLOWED&#39;</span><span class="p">,</span><span class="n">margins</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ACCOUNTING STANDARDS FOLLOWED</th>
      <th>IFRS</th>
      <th>Local standards</th>
      <th>US standards (GAAP)</th>
      <th>All</th>
    </tr>
    <tr>
      <th>CSR Sustainability External Audit</th>
      <th>Audit Committee</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>N</th>
      <th>Y</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>22.380000</td>
      <td>22.380000</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Y</th>
      <th>N</th>
      <td>24.660000</td>
      <td>NaN</td>
      <td>10.450000</td>
      <td>17.555000</td>
    </tr>
    <tr>
      <th>Y</th>
      <td>18.720870</td>
      <td>23.315</td>
      <td>47.304286</td>
      <td>35.547667</td>
    </tr>
    <tr>
      <th>All</th>
      <th></th>
      <td>18.968333</td>
      <td>23.315</td>
      <td>44.442051</td>
      <td>34.386308</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>You can also use hierarchical columns</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">large_df</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="s1">&#39;RESEARCH &amp; DEVELOPMENT/SALES -&#39;</span><span class="p">,</span>
                     <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;CSR Sustainability Committee&#39;</span><span class="p">,</span><span class="s1">&#39;Audit Committee&#39;</span><span class="p">],</span>
                     <span class="n">index</span><span class="o">=</span><span class="s1">&#39;ISO COUNTRY CODE&#39;</span><span class="p">,</span><span class="n">margins</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th>CSR Sustainability Committee</th>
      <th colspan="2" halign="left">N</th>
      <th colspan="2" halign="left">Y</th>
      <th>All</th>
    </tr>
    <tr>
      <th>Audit Committee</th>
      <th>N</th>
      <th>Y</th>
      <th>N</th>
      <th>Y</th>
      <th></th>
    </tr>
    <tr>
      <th>ISO COUNTRY CODE</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>CA</th>
      <td>NaN</td>
      <td>19.890000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>19.890000</td>
    </tr>
    <tr>
      <th>CH</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>12.720000</td>
      <td>12.720000</td>
    </tr>
    <tr>
      <th>CN</th>
      <td>0.850</td>
      <td>2.180000</td>
      <td>0.280000</td>
      <td>NaN</td>
      <td>1.103333</td>
    </tr>
    <tr>
      <th>DE</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>10.315000</td>
      <td>10.315000</td>
    </tr>
    <tr>
      <th>DK</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>11.850000</td>
      <td>11.850000</td>
    </tr>
    <tr>
      <th>FR</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>4.902500</td>
      <td>4.902500</td>
    </tr>
    <tr>
      <th>GB</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>18.015000</td>
      <td>18.015000</td>
    </tr>
    <tr>
      <th>HK</th>
      <td>NaN</td>
      <td>15.420000</td>
      <td>NaN</td>
      <td>7.720000</td>
      <td>11.570000</td>
    </tr>
    <tr>
      <th>IN</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.220000</td>
      <td>0.220000</td>
    </tr>
    <tr>
      <th>JP</th>
      <td>2.760</td>
      <td>NaN</td>
      <td>2.505000</td>
      <td>1.890000</td>
      <td>2.415000</td>
    </tr>
    <tr>
      <th>KR</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>7.390000</td>
      <td>7.390000</td>
    </tr>
    <tr>
      <th>NL</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>14.710000</td>
      <td>14.710000</td>
    </tr>
    <tr>
      <th>TW</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>8.080000</td>
      <td>8.080000</td>
    </tr>
    <tr>
      <th>US</th>
      <td>NaN</td>
      <td>13.755000</td>
      <td>NaN</td>
      <td>10.564242</td>
      <td>11.055128</td>
    </tr>
    <tr>
      <th>All</th>
      <td>1.805</td>
      <td>13.335556</td>
      <td>1.763333</td>
      <td>9.906346</td>
      <td>9.758333</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Cross-tabs are a special case of pivot tables, where the values are frequencies.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">large_df</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s1">&#39;CSR Sustainability Committee&#39;</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="s1">&#39;ISO COUNTRY CODE&#39;</span><span class="p">,</span>
                     <span class="n">aggfunc</span><span class="o">=</span><span class="s1">&#39;count&#39;</span><span class="p">,</span><span class="n">margins</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="3" halign="left">ACCOUNTING STANDARDS FOLLOWED</th>
      <th colspan="3" halign="left">Audit Committee</th>
      <th colspan="3" halign="left">CSR Sustainability External Audit</th>
      <th>INDUSTRY GROUP</th>
      <th>...</th>
      <th>NAME</th>
      <th colspan="3" halign="left">RESEARCH &amp; DEVELOPMENT/SALES -</th>
      <th colspan="3" halign="left">RETURN ON EQUITY - TOTAL (%)</th>
      <th colspan="3" halign="left">TOTAL DEBT % COMMON EQUITY</th>
    </tr>
    <tr>
      <th>CSR Sustainability Committee</th>
      <th>N</th>
      <th>Y</th>
      <th>All</th>
      <th>N</th>
      <th>Y</th>
      <th>All</th>
      <th>N</th>
      <th>Y</th>
      <th>All</th>
      <th>N</th>
      <th>...</th>
      <th>All</th>
      <th>N</th>
      <th>Y</th>
      <th>All</th>
      <th>N</th>
      <th>Y</th>
      <th>All</th>
      <th>N</th>
      <th>Y</th>
      <th>All</th>
    </tr>
    <tr>
      <th>ISO COUNTRY CODE</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>CA</th>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>CH</th>
      <td>NaN</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>NaN</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>NaN</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>NaN</td>
      <td>...</td>
      <td>3.0</td>
      <td>NaN</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>NaN</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>NaN</td>
      <td>3.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>CN</th>
      <td>3.0</td>
      <td>6.0</td>
      <td>NaN</td>
      <td>3.0</td>
      <td>6.0</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>NaN</td>
      <td>3.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>3.0</td>
      <td>6.0</td>
      <td>NaN</td>
      <td>3.0</td>
      <td>6.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>DE</th>
      <td>NaN</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>...</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>DK</th>
      <td>NaN</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>...</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>FR</th>
      <td>NaN</td>
      <td>4.0</td>
      <td>4.0</td>
      <td>NaN</td>
      <td>4.0</td>
      <td>4.0</td>
      <td>NaN</td>
      <td>4.0</td>
      <td>4.0</td>
      <td>NaN</td>
      <td>...</td>
      <td>4.0</td>
      <td>NaN</td>
      <td>4.0</td>
      <td>4.0</td>
      <td>NaN</td>
      <td>4.0</td>
      <td>4.0</td>
      <td>NaN</td>
      <td>4.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>GB</th>
      <td>NaN</td>
      <td>3.0</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>3.0</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>3.0</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>...</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>3.0</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>3.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>HK</th>
      <td>1.0</td>
      <td>3.0</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>IN</th>
      <td>NaN</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>...</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>IT</th>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>JP</th>
      <td>1.0</td>
      <td>3.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>...</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>KR</th>
      <td>NaN</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>...</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>NL</th>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>...</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>SA</th>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>TW</th>
      <td>NaN</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>...</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>US</th>
      <td>11.0</td>
      <td>55.0</td>
      <td>23.0</td>
      <td>11.0</td>
      <td>55.0</td>
      <td>23.0</td>
      <td>4.0</td>
      <td>34.0</td>
      <td>23.0</td>
      <td>11.0</td>
      <td>...</td>
      <td>23.0</td>
      <td>6.0</td>
      <td>33.0</td>
      <td>23.0</td>
      <td>11.0</td>
      <td>51.0</td>
      <td>23.0</td>
      <td>11.0</td>
      <td>55.0</td>
      <td>23.0</td>
    </tr>
    <tr>
      <th>All</th>
      <td>2.0</td>
      <td>40.0</td>
      <td>42.0</td>
      <td>2.0</td>
      <td>40.0</td>
      <td>42.0</td>
      <td>2.0</td>
      <td>40.0</td>
      <td>42.0</td>
      <td>2.0</td>
      <td>...</td>
      <td>42.0</td>
      <td>2.0</td>
      <td>40.0</td>
      <td>42.0</td>
      <td>2.0</td>
      <td>40.0</td>
      <td>42.0</td>
      <td>2.0</td>
      <td>40.0</td>
      <td>42.0</td>
    </tr>
  </tbody>
</table>
<p>17 rows × 24 columns</p>
</div></div></div>
</div>
<p>As you can see, it will return values for all variables. Therefore it is more convenient to use <strong>crosstab</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">large_df</span><span class="p">[</span><span class="s1">&#39;CSR Sustainability External Audit&#39;</span><span class="p">],</span><span class="n">large_df</span><span class="p">[</span><span class="s1">&#39;ISO COUNTRY CODE&#39;</span><span class="p">],</span><span class="n">margins</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>ISO COUNTRY CODE</th>
      <th>CH</th>
      <th>CN</th>
      <th>DE</th>
      <th>DK</th>
      <th>FR</th>
      <th>GB</th>
      <th>HK</th>
      <th>IN</th>
      <th>IT</th>
      <th>JP</th>
      <th>KR</th>
      <th>NL</th>
      <th>TW</th>
      <th>US</th>
      <th>All</th>
    </tr>
    <tr>
      <th>CSR Sustainability External Audit</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>N</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>3</td>
    </tr>
    <tr>
      <th>Y</th>
      <td>3</td>
      <td>5</td>
      <td>2</td>
      <td>1</td>
      <td>4</td>
      <td>3</td>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>35</td>
      <td>63</td>
    </tr>
    <tr>
      <th>All</th>
      <td>3</td>
      <td>5</td>
      <td>2</td>
      <td>1</td>
      <td>4</td>
      <td>3</td>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>38</td>
      <td>66</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="2_Pandas_basics.html" title="previous page"><span class="section-number">3. </span>Pandas data basics</a>
    <a class='right-next' id="next-link" href="4_Connecting_with_accounting_databases.html" title="next page"><span class="section-number">5. </span>Connecting with accounting databases</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Mikko Ranta<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>