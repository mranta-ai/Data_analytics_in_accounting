

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>5. Connecting with accounting databases &#8212; Data analytics in accounting</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=ac02cc09edc035673794" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=ac02cc09edc035673794" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=ac02cc09edc035673794" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=ac02cc09edc035673794" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=ac02cc09edc035673794" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=ac02cc09edc035673794" />
  <script src="_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=ac02cc09edc035673794"></script>

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '4_Connecting_with_accounting_databases';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="6. Visualisations with Python" href="5_Visualisation_with_Python.html" />
    <link rel="prev" title="4. Pandas Data preprocessing" href="3_Pandas_data_preprocessing.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="book_intro.html">
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="book_intro.html">
                    Introduction to data analytics in accounting
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Basic data analytics in accounting</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="0_installing_Python.html">1. Installing Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="1_Intro_to_Python.html">2. Introduction to Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="2_Pandas_basics.html">3. Pandas data basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="3_Pandas_data_preprocessing.html">4. Pandas Data preprocessing</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">5. Connecting with accounting databases</a></li>
<li class="toctree-l1"><a class="reference internal" href="5_Visualisation_with_Python.html">6. Visualisations with Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="6_Basic_statistics_with_Python.html">7. Basic statistics and time series analysis with Python</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Machine learning in accounting</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="7.1_ML_for_structured_data-classification.html">8. Machine learning for structured data - Classification</a></li>
<li class="toctree-l1"><a class="reference internal" href="7.2_ML_for_structured_data-regression.html">9. Machine learning for structured data - Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="7.3_ML_for_structured_data-xgboost_example.html">10. Example - Xgboost, state-of-the-art ensemble method for structured data</a></li>
<li class="toctree-l1"><a class="reference internal" href="7.4_ML_for_structured_data-example.html">11. Example of grid-search</a></li>
<li class="toctree-l1"><a class="reference internal" href="8_Decision_making_in_accounting.html">12. Decision making with ML in accounting</a></li>
<li class="toctree-l1"><a class="reference internal" href="9_Deep_learning_in_accounting.html">13. Deep learning in accounting</a></li>
<li class="toctree-l1"><a class="reference internal" href="9.1_Bonus_example.html">14. Bonus example - starting from scratch</a></li>
<li class="toctree-l1"><a class="reference internal" href="9.2_AccFin_example.html">15. Deep learning example from Accounting/Finance</a></li>
<li class="toctree-l1"><a class="reference internal" href="10_NLP_in_accounting.html">16. Introduction to natural language processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="10.1_LDA_bonus_example.html">17. Basic LDA example - An analysis of ~200 scientific articles</a></li>
<li class="toctree-l1"><a class="reference internal" href="10.2_Advanced_NLP_accfin.html">18. Advanced NLP and Accounting/Finance</a></li>
<li class="toctree-l1"><a class="reference internal" href="11_Neural_NLP_methods.html">19. Neural NLP models</a></li>
<li class="toctree-l1"><a class="reference internal" href="11.1_Neural_NLP_and_accfin.html">20. Neural NLP and accounting/finance</a></li>
<li class="toctree-l1"><a class="reference internal" href="11.2_Transformers_examples.html">21. Transformers examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="12_BONUS-processing_unstructured_data.html">22. Processing unstructured data</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/4_Connecting_with_accounting_databases.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Connecting with accounting databases</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#power-bi">5.1. Power BI</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mysql-sap-and-others">5.2. MySQL, SAP and others</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sqlite">5.3. Sqlite</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#other-sources-of-accounting-data">5.4. Other sources of accounting data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pandas-datareader">5.4.1. Pandas Datareader</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="connecting-with-accounting-databases">
<h1><span class="section-number">5. </span>Connecting with accounting databases<a class="headerlink" href="#connecting-with-accounting-databases" title="Permalink to this heading">#</a></h1>
<section id="power-bi">
<h2><span class="section-number">5.1. </span>Power BI<a class="headerlink" href="#power-bi" title="Permalink to this heading">#</a></h2>
<p>The easiest way to exploit the Python ecosystem in Power BI is to enable Python scripting inside Power BI. For that, you need to have Python installed in your system.</p>
<p>In Power BI, check from <strong>Options - Global - Python scripting</strong> that you have correct folders for your Python and IDE. Power BI should detect the folders automatically, but it is good to check.</p>
<p>Furthermore, you need to have at least Pandas, Matplotlib and Numpy installed.</p>
<p>You can run Python scripts inside Power BI using <strong>Get Data - Other - Python script</strong>. However, it is a good habit to check in your Python environment that the script is working.</p>
<p>There are a few limitations with the connection between Power BI/Python:</p>
<ul class="simple">
<li><p>If you want to import data, it should be represented in a Pandas data frame.</p></li>
<li><p>The maximum run time of a script is 30 minutes.</p></li>
<li><p>You must use full directory paths in your code, not relative paths.</p></li>
<li><p>Nested tables are not supported.</p></li>
</ul>
<p>Otherwise, implementing Python in Power BI is very similar to doing analysis purely inside Python. The good thing is, of course, that you have the tools of both Python and Power BI at your disposal.</p>
</section>
<section id="mysql-sap-and-others">
<h2><span class="section-number">5.2. </span>MySQL, SAP and others<a class="headerlink" href="#mysql-sap-and-others" title="Permalink to this heading">#</a></h2>
<p>There are good libraries for connecting to MySQL, for example, MySQLdb: <a class="reference external" href="https://pypi.org/project/MySQL-python/">pypi.org/project/MySQL-python/</a>. If you want, you can use your MySQL database to go through the examples, instead of SQlite.</p>
<p>SAP HANA is used to connect with Python to a SAP database. Here are the instructions on how to connect Python to SAP: <a class="reference external" href="https://developers.sap.com/tutorials/hana-clients-python.html">developers.sap.com/tutorials/hana-clients-python.html</a>.
The task is quite difficult, and we are not doing that in this course.</p>
</section>
<section id="sqlite">
<h2><span class="section-number">5.3. </span>Sqlite<a class="headerlink" href="#sqlite" title="Permalink to this heading">#</a></h2>
<p>In the following, we will analyse our example database purely in Python. For that, we use an example company database that is available here: <a class="reference external" href="https://github.com/jpwhite3/northwind-SQLite3">github.com/jpwhite3/northwind-SQLite3</a></p>
<p><img alt="Northwind" src="_images/Northwind.png" /></p>
<p>This demo-database has originally been published to Microsoft Access 2000. We analyse it using Sqlite3. However, keep in mind that you can repeat the following analysis by connecting to many other databases, like SAP. In the following, we use some basic SQL statements. However, this course is not about SQL, so we do not go deeper in that direction.</p>
<p>Sqlite3 is included in the standard library. So, you do not need to install any additional libraries. Let’s start by importing the library.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sqlite3</span>
</pre></div>
</div>
</div>
</div>
<p>We can create a connection to the example database with <strong>connect()</strong>. You need to have the <strong>Northwind_large.sqlite</strong> file in your work folder for the following command to work.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">connection</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;Northwind_large.sqlite&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><strong>cursor()</strong> returns a cursor for the connection. A cursor -object has many useful methods to execute SQL statements.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cursor</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>The tables of the database can be collected with the following commands. <strong>execute()</strong> is used for a SQL statement and <strong>fetchall()</strong> collects all the rows from the result.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT name FROM sqlite_master WHERE type=&#39;table&#39;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(&#39;Employees&#39;,), (&#39;Categories&#39;,), (&#39;Customers&#39;,), (&#39;Shippers&#39;,), (&#39;Suppliers&#39;,), (&#39;Orders&#39;,), (&#39;Products&#39;,), (&#39;OrderDetails&#39;,), (&#39;CustomerCustomerDemo&#39;,), (&#39;CustomerDemographics&#39;,), (&#39;Region&#39;,), (&#39;Territories&#39;,), (&#39;EmployeeTerritories&#39;,)]
</pre></div>
</div>
</div>
</div>
<p>We check the fields of the <strong>Employees</strong>, <strong>OrderDetails</strong>, <strong>Orders</strong> and <strong>Products</strong> tables. The outpus are messy lists of tuples. The name of a field is always the second item in a tuple.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;PRAGMA table_info(Employees)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(0, &#39;Id&#39;, &#39;INTEGER&#39;, 0, None, 1), (1, &#39;LastName&#39;, &#39;VARCHAR(8000)&#39;, 0, None, 0), (2, &#39;FirstName&#39;, &#39;VARCHAR(8000)&#39;, 0, None, 0), (3, &#39;Title&#39;, &#39;VARCHAR(8000)&#39;, 0, None, 0), (4, &#39;TitleOfCourtesy&#39;, &#39;VARCHAR(8000)&#39;, 0, None, 0), (5, &#39;BirthDate&#39;, &#39;VARCHAR(8000)&#39;, 0, None, 0), (6, &#39;HireDate&#39;, &#39;VARCHAR(8000)&#39;, 0, None, 0), (7, &#39;Address&#39;, &#39;VARCHAR(8000)&#39;, 0, None, 0), (8, &#39;City&#39;, &#39;VARCHAR(8000)&#39;, 0, None, 0), (9, &#39;Region&#39;, &#39;VARCHAR(8000)&#39;, 0, None, 0), (10, &#39;PostalCode&#39;, &#39;VARCHAR(8000)&#39;, 0, None, 0), (11, &#39;Country&#39;, &#39;VARCHAR(8000)&#39;, 0, None, 0), (12, &#39;HomePhone&#39;, &#39;VARCHAR(8000)&#39;, 0, None, 0), (13, &#39;Extension&#39;, &#39;VARCHAR(8000)&#39;, 0, None, 0), (14, &#39;Photo&#39;, &#39;BLOB&#39;, 0, None, 0), (15, &#39;Notes&#39;, &#39;VARCHAR(8000)&#39;, 0, None, 0), (16, &#39;ReportsTo&#39;, &#39;INTEGER&#39;, 0, None, 0), (17, &#39;PhotoPath&#39;, &#39;VARCHAR(8000)&#39;, 0, None, 0)]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;PRAGMA table_info(OrderDetails)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(0, &#39;Id&#39;, &#39;VARCHAR(8000)&#39;, 0, None, 1), (1, &#39;OrderId&#39;, &#39;INTEGER&#39;, 1, None, 0), (2, &#39;ProductId&#39;, &#39;INTEGER&#39;, 1, None, 0), (3, &#39;UnitPrice&#39;, &#39;DECIMAL&#39;, 1, None, 0), (4, &#39;Quantity&#39;, &#39;INTEGER&#39;, 1, None, 0), (5, &#39;Discount&#39;, &#39;DOUBLE&#39;, 1, None, 0)]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;PRAGMA table_info(Orders)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(0, &#39;Id&#39;, &#39;INTEGER&#39;, 0, None, 1), (1, &#39;CustomerId&#39;, &#39;VARCHAR(8000)&#39;, 0, None, 0), (2, &#39;EmployeeId&#39;, &#39;INTEGER&#39;, 1, None, 0), (3, &#39;OrderDate&#39;, &#39;VARCHAR(8000)&#39;, 0, None, 0), (4, &#39;RequiredDate&#39;, &#39;VARCHAR(8000)&#39;, 0, None, 0), (5, &#39;ShippedDate&#39;, &#39;VARCHAR(8000)&#39;, 0, None, 0), (6, &#39;ShipVia&#39;, &#39;INTEGER&#39;, 0, None, 0), (7, &#39;Freight&#39;, &#39;DECIMAL&#39;, 1, None, 0), (8, &#39;ShipName&#39;, &#39;VARCHAR(8000)&#39;, 0, None, 0), (9, &#39;ShipAddress&#39;, &#39;VARCHAR(8000)&#39;, 0, None, 0), (10, &#39;ShipCity&#39;, &#39;VARCHAR(8000)&#39;, 0, None, 0), (11, &#39;ShipRegion&#39;, &#39;VARCHAR(8000)&#39;, 0, None, 0), (12, &#39;ShipPostalCode&#39;, &#39;VARCHAR(8000)&#39;, 0, None, 0), (13, &#39;ShipCountry&#39;, &#39;VARCHAR(8000)&#39;, 0, None, 0)]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;PRAGMA table_info(Products)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(0, &#39;Id&#39;, &#39;INTEGER&#39;, 0, None, 1), (1, &#39;ProductName&#39;, &#39;VARCHAR(8000)&#39;, 0, None, 0), (2, &#39;SupplierId&#39;, &#39;INTEGER&#39;, 1, None, 0), (3, &#39;CategoryId&#39;, &#39;INTEGER&#39;, 1, None, 0), (4, &#39;QuantityPerUnit&#39;, &#39;VARCHAR(8000)&#39;, 0, None, 0), (5, &#39;UnitPrice&#39;, &#39;DECIMAL&#39;, 1, None, 0), (6, &#39;UnitsInStock&#39;, &#39;INTEGER&#39;, 1, None, 0), (7, &#39;UnitsOnOrder&#39;, &#39;INTEGER&#39;, 1, None, 0), (8, &#39;ReorderLevel&#39;, &#39;INTEGER&#39;, 1, None, 0), (9, &#39;Discontinued&#39;, &#39;INTEGER&#39;, 1, None, 0)]
</pre></div>
</div>
</div>
</div>
<p>Pandas has a very convenient function, <strong>read_sql_query</strong>, to load SQL queries to dataframes. Let’s start by loading Pandas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
</div>
</div>
<p>SQL queries are a whole new world, and we use only the essential. The following code picks up <strong>LastName</strong> from the <strong>Employees</strong> table, <strong>UnitPrice</strong> and <strong>Quantity</strong> from the <strong>OrderDetails</strong>, <strong>OrderDate</strong> and <strong>ShipCountry</strong> from <strong>Orders</strong>, <strong>CategoryName</strong> from <strong>Categories</strong>, and <strong>ProductName</strong> from <strong>Products</strong>. The next part of the code is important. The <strong>JOIN</strong> commands connect the data in different tables in a correct way. Notice how we qive our sqlite3 database connection -object as a paramter to the function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">query_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;SELECT Employees.LastName, OrderDetails.UnitPrice, </span>
<span class="s2">OrderDetails.Quantity, Orders.OrderDate, Orders.ShipCountry, Categories.CategoryName, Products.ProductName</span>
<span class="s2">FROM OrderDetails</span>
<span class="s2">JOIN Orders ON Orders.Id=OrderDetails.OrderID</span>
<span class="s2">JOIN Employees ON Employees.Id=Orders.EmployeeId</span>
<span class="s2">JOIN Products ON Products.ID=OrderDetails.ProductId</span>
<span class="s2">JOIN Categories ON Categories.ID=Products.CategoryID&quot;&quot;&quot;</span><span class="p">,</span> <span class="n">connection</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">query_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>LastName</th>
      <th>UnitPrice</th>
      <th>Quantity</th>
      <th>OrderDate</th>
      <th>ShipCountry</th>
      <th>CategoryName</th>
      <th>ProductName</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Buchanan</td>
      <td>14.00</td>
      <td>12</td>
      <td>2012-07-04</td>
      <td>France</td>
      <td>Dairy Products</td>
      <td>Queso Cabrales</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Buchanan</td>
      <td>9.80</td>
      <td>10</td>
      <td>2012-07-04</td>
      <td>France</td>
      <td>Grains/Cereals</td>
      <td>Singaporean Hokkien Fried Mee</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Buchanan</td>
      <td>34.80</td>
      <td>5</td>
      <td>2012-07-04</td>
      <td>France</td>
      <td>Dairy Products</td>
      <td>Mozzarella di Giovanni</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Suyama</td>
      <td>18.60</td>
      <td>9</td>
      <td>2012-07-05</td>
      <td>Germany</td>
      <td>Produce</td>
      <td>Tofu</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Suyama</td>
      <td>42.40</td>
      <td>40</td>
      <td>2012-07-05</td>
      <td>Germany</td>
      <td>Produce</td>
      <td>Manjimup Dried Apples</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>621878</th>
      <td>Davolio</td>
      <td>21.00</td>
      <td>20</td>
      <td>2013-08-31 02:59:28</td>
      <td>Venezuela</td>
      <td>Grains/Cereals</td>
      <td>Gustaf's Knäckebröd</td>
    </tr>
    <tr>
      <th>621879</th>
      <td>Davolio</td>
      <td>13.00</td>
      <td>11</td>
      <td>2013-08-31 02:59:28</td>
      <td>Venezuela</td>
      <td>Condiments</td>
      <td>Original Frankfurter grüne Soße</td>
    </tr>
    <tr>
      <th>621880</th>
      <td>Davolio</td>
      <td>39.00</td>
      <td>45</td>
      <td>2013-08-31 02:59:28</td>
      <td>Venezuela</td>
      <td>Meat/Poultry</td>
      <td>Alice Mutton</td>
    </tr>
    <tr>
      <th>621881</th>
      <td>Davolio</td>
      <td>25.00</td>
      <td>7</td>
      <td>2013-08-31 02:59:28</td>
      <td>Venezuela</td>
      <td>Condiments</td>
      <td>Grandma's Boysenberry Spread</td>
    </tr>
    <tr>
      <th>621882</th>
      <td>Davolio</td>
      <td>21.05</td>
      <td>27</td>
      <td>2013-08-31 02:59:28</td>
      <td>Venezuela</td>
      <td>Condiments</td>
      <td>Louisiana Fiery Hot Pepper Sauce</td>
    </tr>
  </tbody>
</table>
<p>621883 rows × 7 columns</p>
</div></div></div>
</div>
<p>Now that we have everything neatly in a Pandas dataframe, we can do many kinds of analyses. The other chapters focus more on the Pandas functionality, but let’s try something that we can do.</p>
<p>For example, to analyse trends, we can change <strong>OrderDate</strong> to a datetime object with <strong>to_datetime()</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">query_df</span><span class="p">[</span><span class="s1">&#39;OrderDate&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">query_df</span><span class="p">[</span><span class="s1">&#39;OrderDate&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">query_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>LastName</th>
      <th>UnitPrice</th>
      <th>Quantity</th>
      <th>OrderDate</th>
      <th>ShipCountry</th>
      <th>CategoryName</th>
      <th>ProductName</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Buchanan</td>
      <td>14.00</td>
      <td>12</td>
      <td>2012-07-04 00:00:00</td>
      <td>France</td>
      <td>Dairy Products</td>
      <td>Queso Cabrales</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Buchanan</td>
      <td>9.80</td>
      <td>10</td>
      <td>2012-07-04 00:00:00</td>
      <td>France</td>
      <td>Grains/Cereals</td>
      <td>Singaporean Hokkien Fried Mee</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Buchanan</td>
      <td>34.80</td>
      <td>5</td>
      <td>2012-07-04 00:00:00</td>
      <td>France</td>
      <td>Dairy Products</td>
      <td>Mozzarella di Giovanni</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Suyama</td>
      <td>18.60</td>
      <td>9</td>
      <td>2012-07-05 00:00:00</td>
      <td>Germany</td>
      <td>Produce</td>
      <td>Tofu</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Suyama</td>
      <td>42.40</td>
      <td>40</td>
      <td>2012-07-05 00:00:00</td>
      <td>Germany</td>
      <td>Produce</td>
      <td>Manjimup Dried Apples</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>621878</th>
      <td>Davolio</td>
      <td>21.00</td>
      <td>20</td>
      <td>2013-08-31 02:59:28</td>
      <td>Venezuela</td>
      <td>Grains/Cereals</td>
      <td>Gustaf's Knäckebröd</td>
    </tr>
    <tr>
      <th>621879</th>
      <td>Davolio</td>
      <td>13.00</td>
      <td>11</td>
      <td>2013-08-31 02:59:28</td>
      <td>Venezuela</td>
      <td>Condiments</td>
      <td>Original Frankfurter grüne Soße</td>
    </tr>
    <tr>
      <th>621880</th>
      <td>Davolio</td>
      <td>39.00</td>
      <td>45</td>
      <td>2013-08-31 02:59:28</td>
      <td>Venezuela</td>
      <td>Meat/Poultry</td>
      <td>Alice Mutton</td>
    </tr>
    <tr>
      <th>621881</th>
      <td>Davolio</td>
      <td>25.00</td>
      <td>7</td>
      <td>2013-08-31 02:59:28</td>
      <td>Venezuela</td>
      <td>Condiments</td>
      <td>Grandma's Boysenberry Spread</td>
    </tr>
    <tr>
      <th>621882</th>
      <td>Davolio</td>
      <td>21.05</td>
      <td>27</td>
      <td>2013-08-31 02:59:28</td>
      <td>Venezuela</td>
      <td>Condiments</td>
      <td>Louisiana Fiery Hot Pepper Sauce</td>
    </tr>
  </tbody>
</table>
<p>621883 rows × 7 columns</p>
</div></div></div>
</div>
<p>Next, we can change our datetime object as index.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">query_df</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">query_df</span><span class="p">[</span><span class="s1">&#39;OrderDate&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">query_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>LastName</th>
      <th>UnitPrice</th>
      <th>Quantity</th>
      <th>OrderDate</th>
      <th>ShipCountry</th>
      <th>CategoryName</th>
      <th>ProductName</th>
    </tr>
    <tr>
      <th>OrderDate</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2012-07-04 00:00:00</th>
      <td>Buchanan</td>
      <td>14.00</td>
      <td>12</td>
      <td>2012-07-04 00:00:00</td>
      <td>France</td>
      <td>Dairy Products</td>
      <td>Queso Cabrales</td>
    </tr>
    <tr>
      <th>2012-07-04 00:00:00</th>
      <td>Buchanan</td>
      <td>9.80</td>
      <td>10</td>
      <td>2012-07-04 00:00:00</td>
      <td>France</td>
      <td>Grains/Cereals</td>
      <td>Singaporean Hokkien Fried Mee</td>
    </tr>
    <tr>
      <th>2012-07-04 00:00:00</th>
      <td>Buchanan</td>
      <td>34.80</td>
      <td>5</td>
      <td>2012-07-04 00:00:00</td>
      <td>France</td>
      <td>Dairy Products</td>
      <td>Mozzarella di Giovanni</td>
    </tr>
    <tr>
      <th>2012-07-05 00:00:00</th>
      <td>Suyama</td>
      <td>18.60</td>
      <td>9</td>
      <td>2012-07-05 00:00:00</td>
      <td>Germany</td>
      <td>Produce</td>
      <td>Tofu</td>
    </tr>
    <tr>
      <th>2012-07-05 00:00:00</th>
      <td>Suyama</td>
      <td>42.40</td>
      <td>40</td>
      <td>2012-07-05 00:00:00</td>
      <td>Germany</td>
      <td>Produce</td>
      <td>Manjimup Dried Apples</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2013-08-31 02:59:28</th>
      <td>Davolio</td>
      <td>21.00</td>
      <td>20</td>
      <td>2013-08-31 02:59:28</td>
      <td>Venezuela</td>
      <td>Grains/Cereals</td>
      <td>Gustaf's Knäckebröd</td>
    </tr>
    <tr>
      <th>2013-08-31 02:59:28</th>
      <td>Davolio</td>
      <td>13.00</td>
      <td>11</td>
      <td>2013-08-31 02:59:28</td>
      <td>Venezuela</td>
      <td>Condiments</td>
      <td>Original Frankfurter grüne Soße</td>
    </tr>
    <tr>
      <th>2013-08-31 02:59:28</th>
      <td>Davolio</td>
      <td>39.00</td>
      <td>45</td>
      <td>2013-08-31 02:59:28</td>
      <td>Venezuela</td>
      <td>Meat/Poultry</td>
      <td>Alice Mutton</td>
    </tr>
    <tr>
      <th>2013-08-31 02:59:28</th>
      <td>Davolio</td>
      <td>25.00</td>
      <td>7</td>
      <td>2013-08-31 02:59:28</td>
      <td>Venezuela</td>
      <td>Condiments</td>
      <td>Grandma's Boysenberry Spread</td>
    </tr>
    <tr>
      <th>2013-08-31 02:59:28</th>
      <td>Davolio</td>
      <td>21.05</td>
      <td>27</td>
      <td>2013-08-31 02:59:28</td>
      <td>Venezuela</td>
      <td>Condiments</td>
      <td>Louisiana Fiery Hot Pepper Sauce</td>
    </tr>
  </tbody>
</table>
<p>621883 rows × 7 columns</p>
</div></div></div>
</div>
<p>We still need to order the index.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">query_df</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s calculate the total number of orders for different product categories.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">query_df</span><span class="p">[</span><span class="s1">&#39;CategoryName&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">bar</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:&gt;
</pre></div>
</div>
<img alt="_images/c591a5b5a82a3b0373a44753d53c864ae9e68092e2e7ac0483e2c97cc010152f.png" src="_images/c591a5b5a82a3b0373a44753d53c864ae9e68092e2e7ac0483e2c97cc010152f.png" />
</div>
</div>
<p>Let’s check next, to which country the company is selling the most. The following command is quite long! First, it groups values by <strong>ShipCountry</strong>, then counts values and sorts them in a descending order by <strong>Quantity</strong>, and finally selects only <strong>Quantity</strong> -column.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">query_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;ShipCountry&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;Quantity&#39;</span><span class="p">,</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">&#39;Quantity&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ShipCountry
USA            89059
Germany        85923
France         67314
Brazil         60663
UK             50162
Mexico         34979
Venezuela      29128
Spain          26270
Argentina      21233
Italy          19952
Canada         19652
Finland        14661
Belgium        14505
Sweden         14147
Switzerland    14049
Denmark        13764
Austria        13669
Portugal       12684
Poland          6756
Ireland         6688
Norway          6625
Name: Quantity, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>A nice thing in Python (and Pandas) is that we change the previous to a bar chart just by adding <strong>plot.bar()</strong> to the end of the command.</p>
<p>Let’s first load Matplotlib to make our plots prettier.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;fivethirtyeight&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">query_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;ShipCountry&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;Quantity&#39;</span><span class="p">,</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">&#39;Quantity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/d5ffea8a36e26aed1cd7970d3269bd539e631ac9a26faa3dc548ebe003fea9ee.png" src="_images/d5ffea8a36e26aed1cd7970d3269bd539e631ac9a26faa3dc548ebe003fea9ee.png" />
</div>
</div>
<p>With pivot tables, we can do a 2-way grouping.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">query_df</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">&#39;LastName&#39;</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="s1">&#39;ShipCountry&#39;</span><span class="p">,</span><span class="n">values</span><span class="o">=</span><span class="s1">&#39;Quantity&#39;</span><span class="p">,</span><span class="n">aggfunc</span><span class="o">=</span><span class="nb">sum</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>ShipCountry</th>
      <th>Argentina</th>
      <th>Austria</th>
      <th>Belgium</th>
      <th>Brazil</th>
      <th>Canada</th>
      <th>Denmark</th>
      <th>Finland</th>
      <th>France</th>
      <th>Germany</th>
      <th>Ireland</th>
      <th>...</th>
      <th>Mexico</th>
      <th>Norway</th>
      <th>Poland</th>
      <th>Portugal</th>
      <th>Spain</th>
      <th>Sweden</th>
      <th>Switzerland</th>
      <th>UK</th>
      <th>USA</th>
      <th>Venezuela</th>
    </tr>
    <tr>
      <th>LastName</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Buchanan</th>
      <td>68252</td>
      <td>40687</td>
      <td>45468</td>
      <td>182595</td>
      <td>55898</td>
      <td>47414</td>
      <td>40935</td>
      <td>169200</td>
      <td>265031</td>
      <td>21996</td>
      <td>...</td>
      <td>103888</td>
      <td>18487</td>
      <td>19077</td>
      <td>34787</td>
      <td>76052</td>
      <td>46805</td>
      <td>39866</td>
      <td>123721</td>
      <td>263998</td>
      <td>95810</td>
    </tr>
    <tr>
      <th>Callahan</th>
      <td>50977</td>
      <td>46506</td>
      <td>21741</td>
      <td>201153</td>
      <td>58506</td>
      <td>42306</td>
      <td>27732</td>
      <td>192488</td>
      <td>237532</td>
      <td>16133</td>
      <td>...</td>
      <td>86354</td>
      <td>12045</td>
      <td>19728</td>
      <td>31522</td>
      <td>73022</td>
      <td>40745</td>
      <td>34171</td>
      <td>155124</td>
      <td>250614</td>
      <td>62389</td>
    </tr>
    <tr>
      <th>Davolio</th>
      <td>66186</td>
      <td>44332</td>
      <td>47841</td>
      <td>150727</td>
      <td>50957</td>
      <td>42275</td>
      <td>47406</td>
      <td>186479</td>
      <td>229137</td>
      <td>16471</td>
      <td>...</td>
      <td>105282</td>
      <td>9071</td>
      <td>22855</td>
      <td>31563</td>
      <td>61587</td>
      <td>33431</td>
      <td>38221</td>
      <td>149707</td>
      <td>258013</td>
      <td>73040</td>
    </tr>
    <tr>
      <th>Dodsworth</th>
      <td>48936</td>
      <td>42499</td>
      <td>45385</td>
      <td>173881</td>
      <td>58663</td>
      <td>29649</td>
      <td>38434</td>
      <td>218987</td>
      <td>239419</td>
      <td>23881</td>
      <td>...</td>
      <td>91115</td>
      <td>16886</td>
      <td>19259</td>
      <td>43262</td>
      <td>69528</td>
      <td>36657</td>
      <td>50513</td>
      <td>146315</td>
      <td>207208</td>
      <td>105907</td>
    </tr>
    <tr>
      <th>Fuller</th>
      <td>61848</td>
      <td>25092</td>
      <td>46255</td>
      <td>155750</td>
      <td>55919</td>
      <td>29790</td>
      <td>30799</td>
      <td>184553</td>
      <td>228026</td>
      <td>20975</td>
      <td>...</td>
      <td>119410</td>
      <td>22544</td>
      <td>21392</td>
      <td>30644</td>
      <td>69067</td>
      <td>31062</td>
      <td>31412</td>
      <td>130891</td>
      <td>250988</td>
      <td>86679</td>
    </tr>
    <tr>
      <th>King</th>
      <td>45559</td>
      <td>39419</td>
      <td>41950</td>
      <td>166678</td>
      <td>45888</td>
      <td>31635</td>
      <td>56539</td>
      <td>194100</td>
      <td>258696</td>
      <td>15336</td>
      <td>...</td>
      <td>94927</td>
      <td>35009</td>
      <td>16933</td>
      <td>28930</td>
      <td>62777</td>
      <td>46751</td>
      <td>43769</td>
      <td>162153</td>
      <td>240532</td>
      <td>74124</td>
    </tr>
    <tr>
      <th>Leverling</th>
      <td>64409</td>
      <td>38191</td>
      <td>35325</td>
      <td>188315</td>
      <td>74915</td>
      <td>36741</td>
      <td>42688</td>
      <td>204843</td>
      <td>243401</td>
      <td>22365</td>
      <td>...</td>
      <td>82019</td>
      <td>21029</td>
      <td>13554</td>
      <td>39832</td>
      <td>82488</td>
      <td>46028</td>
      <td>44096</td>
      <td>146039</td>
      <td>305553</td>
      <td>66031</td>
    </tr>
    <tr>
      <th>Peacock</th>
      <td>62869</td>
      <td>28476</td>
      <td>52329</td>
      <td>171980</td>
      <td>56217</td>
      <td>46333</td>
      <td>50386</td>
      <td>172114</td>
      <td>244482</td>
      <td>12059</td>
      <td>...</td>
      <td>89564</td>
      <td>18977</td>
      <td>12986</td>
      <td>44000</td>
      <td>92110</td>
      <td>40524</td>
      <td>44052</td>
      <td>132325</td>
      <td>252295</td>
      <td>90487</td>
    </tr>
    <tr>
      <th>Suyama</th>
      <td>69697</td>
      <td>44687</td>
      <td>35595</td>
      <td>148480</td>
      <td>45064</td>
      <td>43631</td>
      <td>39998</td>
      <td>193725</td>
      <td>246849</td>
      <td>22518</td>
      <td>...</td>
      <td>123194</td>
      <td>14638</td>
      <td>24995</td>
      <td>37539</td>
      <td>82311</td>
      <td>38743</td>
      <td>31109</td>
      <td>134042</td>
      <td>246389</td>
      <td>87347</td>
    </tr>
  </tbody>
</table>
<p>9 rows × 21 columns</p>
</div></div></div>
</div>
<p>With <strong>Quantity</strong> and <strong>OrderPrice</strong>, we can calculate the total price of the orders. Using * for multiplication, Python/Pandas makes the multiplication element-wise.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">query_df</span><span class="p">[</span><span class="s1">&#39;TotalPrice&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">query_df</span><span class="p">[</span><span class="s1">&#39;Quantity&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">query_df</span><span class="p">[</span><span class="s1">&#39;UnitPrice&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>There is too much information to one plot, so let’s resample the data before plotting (<strong>‘M’</strong> means monthly).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">query_df</span><span class="p">[</span><span class="s1">&#39;TotalPrice&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;M&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;r--&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:xlabel=&#39;OrderDate&#39;&gt;
</pre></div>
</div>
<img alt="_images/f98902bd86e21bcad8046b7b1af948158285278dbf8e0ce290ebaffc2c2de391.png" src="_images/f98902bd86e21bcad8046b7b1af948158285278dbf8e0ce290ebaffc2c2de391.png" />
</div>
</div>
<p>Let’s plot how the sales of different salesperson have progressed. The <strong>for</strong> loop in the command goes through all the salesperson and draws their performance to the same chart. With <strong>set</strong>, we can pick from the <strong>LastName</strong> column unique values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="n">query_df</span><span class="p">[</span><span class="s1">&#39;LastName&#39;</span><span class="p">]):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">query_df</span><span class="p">[</span><span class="s1">&#39;TotalPrice&#39;</span><span class="p">][</span><span class="n">query_df</span><span class="p">[</span><span class="s1">&#39;LastName&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;Q&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">query_df</span><span class="p">[</span><span class="s1">&#39;LastName&#39;</span><span class="p">]))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/851aaf1a4b01978e369b29c25e73ce53cc95a1493db8ace98daeb869c6c89b30.png" src="_images/851aaf1a4b01978e369b29c25e73ce53cc95a1493db8ace98daeb869c6c89b30.png" />
</div>
</div>
<p>We can also use bar charts. Here are the sales of different salesperson and product categories. We first do a two-level grouping, sum the values in those groups, and pick <strong>TotalPrice</strong>. Adding <strong>plot.barh()</strong> to the end turns the 2-level grouping table into a bar chart.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">query_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;LastName&#39;</span><span class="p">,</span><span class="s1">&#39;CategoryName&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()[</span><span class="s1">&#39;TotalPrice&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">15</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/e1b7121727c5e08a17bf3eb94a29cf9bd1bab44964e319414b39f6a7879fe2ca.png" src="_images/e1b7121727c5e08a17bf3eb94a29cf9bd1bab44964e319414b39f6a7879fe2ca.png" />
</div>
</div>
<p>We can also use percentage values in tables. (I admit, the following command is a mess!). It divides the values of a <strong>LastName/CategoryName</strong> -pivot table with the row sums of that table. Then, it multiplies these numbers by hundred. <strong>style.format</strong> is used to decrease the number of decimals to 2 <strong>2f</strong>, and to add <strong>%</strong> to the end.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">query_df</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">values</span> <span class="o">=</span> <span class="s1">&#39;TotalPrice&#39;</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="s1">&#39;LastName&#39;</span><span class="p">,</span>
                      <span class="n">columns</span> <span class="o">=</span> <span class="s1">&#39;CategoryName&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="n">query_df</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">values</span> <span class="o">=</span> <span class="s1">&#39;TotalPrice&#39;</span><span class="p">,</span>
                    <span class="n">index</span> <span class="o">=</span> <span class="s1">&#39;LastName&#39;</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="s1">&#39;CategoryName&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:.2f}</span><span class="s1"> %&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style  type="text/css" >
</style><table id="T_fd4ba002_23f4_11eb_82c7_472f2f362698" ><thead>    <tr>        <th class="index_name level0" >CategoryName</th>        <th class="col_heading level0 col0" >Beverages</th>        <th class="col_heading level0 col1" >Condiments</th>        <th class="col_heading level0 col2" >Confections</th>        <th class="col_heading level0 col3" >Dairy Products</th>        <th class="col_heading level0 col4" >Grains/Cereals</th>        <th class="col_heading level0 col5" >Meat/Poultry</th>        <th class="col_heading level0 col6" >Produce</th>        <th class="col_heading level0 col7" >Seafood</th>    </tr>    <tr>        <th class="index_name level0" >LastName</th>        <th class="blank" ></th>        <th class="blank" ></th>        <th class="blank" ></th>        <th class="blank" ></th>        <th class="blank" ></th>        <th class="blank" ></th>        <th class="blank" ></th>        <th class="blank" ></th>    </tr></thead><tbody>
                <tr>
                        <th id="T_fd4ba002_23f4_11eb_82c7_472f2f362698level0_row0" class="row_heading level0 row0" >Buchanan</th>
                        <td id="T_fd4ba002_23f4_11eb_82c7_472f2f362698row0_col0" class="data row0 col0" >15.70 %</td>
                        <td id="T_fd4ba002_23f4_11eb_82c7_472f2f362698row0_col1" class="data row0 col1" >9.51 %</td>
                        <td id="T_fd4ba002_23f4_11eb_82c7_472f2f362698row0_col2" class="data row0 col2" >10.41 %</td>
                        <td id="T_fd4ba002_23f4_11eb_82c7_472f2f362698row0_col3" class="data row0 col3" >11.92 %</td>
                        <td id="T_fd4ba002_23f4_11eb_82c7_472f2f362698row0_col4" class="data row0 col4" >8.35 %</td>
                        <td id="T_fd4ba002_23f4_11eb_82c7_472f2f362698row0_col5" class="data row0 col5" >22.39 %</td>
                        <td id="T_fd4ba002_23f4_11eb_82c7_472f2f362698row0_col6" class="data row0 col6" >13.14 %</td>
                        <td id="T_fd4ba002_23f4_11eb_82c7_472f2f362698row0_col7" class="data row0 col7" >8.58 %</td>
            </tr>
            <tr>
                        <th id="T_fd4ba002_23f4_11eb_82c7_472f2f362698level0_row1" class="row_heading level0 row1" >Callahan</th>
                        <td id="T_fd4ba002_23f4_11eb_82c7_472f2f362698row1_col0" class="data row1 col0" >15.71 %</td>
                        <td id="T_fd4ba002_23f4_11eb_82c7_472f2f362698row1_col1" class="data row1 col1" >9.52 %</td>
                        <td id="T_fd4ba002_23f4_11eb_82c7_472f2f362698row1_col2" class="data row1 col2" >10.41 %</td>
                        <td id="T_fd4ba002_23f4_11eb_82c7_472f2f362698row1_col3" class="data row1 col3" >11.84 %</td>
                        <td id="T_fd4ba002_23f4_11eb_82c7_472f2f362698row1_col4" class="data row1 col4" >8.18 %</td>
                        <td id="T_fd4ba002_23f4_11eb_82c7_472f2f362698row1_col5" class="data row1 col5" >22.45 %</td>
                        <td id="T_fd4ba002_23f4_11eb_82c7_472f2f362698row1_col6" class="data row1 col6" >13.44 %</td>
                        <td id="T_fd4ba002_23f4_11eb_82c7_472f2f362698row1_col7" class="data row1 col7" >8.45 %</td>
            </tr>
            <tr>
                        <th id="T_fd4ba002_23f4_11eb_82c7_472f2f362698level0_row2" class="row_heading level0 row2" >Davolio</th>
                        <td id="T_fd4ba002_23f4_11eb_82c7_472f2f362698row2_col0" class="data row2 col0" >15.45 %</td>
                        <td id="T_fd4ba002_23f4_11eb_82c7_472f2f362698row2_col1" class="data row2 col1" >9.46 %</td>
                        <td id="T_fd4ba002_23f4_11eb_82c7_472f2f362698row2_col2" class="data row2 col2" >10.37 %</td>
                        <td id="T_fd4ba002_23f4_11eb_82c7_472f2f362698row2_col3" class="data row2 col3" >11.89 %</td>
                        <td id="T_fd4ba002_23f4_11eb_82c7_472f2f362698row2_col4" class="data row2 col4" >8.34 %</td>
                        <td id="T_fd4ba002_23f4_11eb_82c7_472f2f362698row2_col5" class="data row2 col5" >22.36 %</td>
                        <td id="T_fd4ba002_23f4_11eb_82c7_472f2f362698row2_col6" class="data row2 col6" >13.70 %</td>
                        <td id="T_fd4ba002_23f4_11eb_82c7_472f2f362698row2_col7" class="data row2 col7" >8.43 %</td>
            </tr>
            <tr>
                        <th id="T_fd4ba002_23f4_11eb_82c7_472f2f362698level0_row3" class="row_heading level0 row3" >Dodsworth</th>
                        <td id="T_fd4ba002_23f4_11eb_82c7_472f2f362698row3_col0" class="data row3 col0" >15.65 %</td>
                        <td id="T_fd4ba002_23f4_11eb_82c7_472f2f362698row3_col1" class="data row3 col1" >9.64 %</td>
                        <td id="T_fd4ba002_23f4_11eb_82c7_472f2f362698row3_col2" class="data row3 col2" >10.32 %</td>
                        <td id="T_fd4ba002_23f4_11eb_82c7_472f2f362698row3_col3" class="data row3 col3" >11.91 %</td>
                        <td id="T_fd4ba002_23f4_11eb_82c7_472f2f362698row3_col4" class="data row3 col4" >8.38 %</td>
                        <td id="T_fd4ba002_23f4_11eb_82c7_472f2f362698row3_col5" class="data row3 col5" >22.36 %</td>
                        <td id="T_fd4ba002_23f4_11eb_82c7_472f2f362698row3_col6" class="data row3 col6" >13.06 %</td>
                        <td id="T_fd4ba002_23f4_11eb_82c7_472f2f362698row3_col7" class="data row3 col7" >8.67 %</td>
            </tr>
            <tr>
                        <th id="T_fd4ba002_23f4_11eb_82c7_472f2f362698level0_row4" class="row_heading level0 row4" >Fuller</th>
                        <td id="T_fd4ba002_23f4_11eb_82c7_472f2f362698row4_col0" class="data row4 col0" >15.73 %</td>
                        <td id="T_fd4ba002_23f4_11eb_82c7_472f2f362698row4_col1" class="data row4 col1" >9.45 %</td>
                        <td id="T_fd4ba002_23f4_11eb_82c7_472f2f362698row4_col2" class="data row4 col2" >10.39 %</td>
                        <td id="T_fd4ba002_23f4_11eb_82c7_472f2f362698row4_col3" class="data row4 col3" >11.87 %</td>
                        <td id="T_fd4ba002_23f4_11eb_82c7_472f2f362698row4_col4" class="data row4 col4" >8.39 %</td>
                        <td id="T_fd4ba002_23f4_11eb_82c7_472f2f362698row4_col5" class="data row4 col5" >22.35 %</td>
                        <td id="T_fd4ba002_23f4_11eb_82c7_472f2f362698row4_col6" class="data row4 col6" >13.28 %</td>
                        <td id="T_fd4ba002_23f4_11eb_82c7_472f2f362698row4_col7" class="data row4 col7" >8.53 %</td>
            </tr>
            <tr>
                        <th id="T_fd4ba002_23f4_11eb_82c7_472f2f362698level0_row5" class="row_heading level0 row5" >King</th>
                        <td id="T_fd4ba002_23f4_11eb_82c7_472f2f362698row5_col0" class="data row5 col0" >15.59 %</td>
                        <td id="T_fd4ba002_23f4_11eb_82c7_472f2f362698row5_col1" class="data row5 col1" >9.59 %</td>
                        <td id="T_fd4ba002_23f4_11eb_82c7_472f2f362698row5_col2" class="data row5 col2" >10.56 %</td>
                        <td id="T_fd4ba002_23f4_11eb_82c7_472f2f362698row5_col3" class="data row5 col3" >11.94 %</td>
                        <td id="T_fd4ba002_23f4_11eb_82c7_472f2f362698row5_col4" class="data row5 col4" >8.36 %</td>
                        <td id="T_fd4ba002_23f4_11eb_82c7_472f2f362698row5_col5" class="data row5 col5" >21.95 %</td>
                        <td id="T_fd4ba002_23f4_11eb_82c7_472f2f362698row5_col6" class="data row5 col6" >13.49 %</td>
                        <td id="T_fd4ba002_23f4_11eb_82c7_472f2f362698row5_col7" class="data row5 col7" >8.53 %</td>
            </tr>
            <tr>
                        <th id="T_fd4ba002_23f4_11eb_82c7_472f2f362698level0_row6" class="row_heading level0 row6" >Leverling</th>
                        <td id="T_fd4ba002_23f4_11eb_82c7_472f2f362698row6_col0" class="data row6 col0" >15.69 %</td>
                        <td id="T_fd4ba002_23f4_11eb_82c7_472f2f362698row6_col1" class="data row6 col1" >9.58 %</td>
                        <td id="T_fd4ba002_23f4_11eb_82c7_472f2f362698row6_col2" class="data row6 col2" >10.42 %</td>
                        <td id="T_fd4ba002_23f4_11eb_82c7_472f2f362698row6_col3" class="data row6 col3" >11.98 %</td>
                        <td id="T_fd4ba002_23f4_11eb_82c7_472f2f362698row6_col4" class="data row6 col4" >8.37 %</td>
                        <td id="T_fd4ba002_23f4_11eb_82c7_472f2f362698row6_col5" class="data row6 col5" >22.31 %</td>
                        <td id="T_fd4ba002_23f4_11eb_82c7_472f2f362698row6_col6" class="data row6 col6" >13.08 %</td>
                        <td id="T_fd4ba002_23f4_11eb_82c7_472f2f362698row6_col7" class="data row6 col7" >8.58 %</td>
            </tr>
            <tr>
                        <th id="T_fd4ba002_23f4_11eb_82c7_472f2f362698level0_row7" class="row_heading level0 row7" >Peacock</th>
                        <td id="T_fd4ba002_23f4_11eb_82c7_472f2f362698row7_col0" class="data row7 col0" >15.41 %</td>
                        <td id="T_fd4ba002_23f4_11eb_82c7_472f2f362698row7_col1" class="data row7 col1" >9.50 %</td>
                        <td id="T_fd4ba002_23f4_11eb_82c7_472f2f362698row7_col2" class="data row7 col2" >10.44 %</td>
                        <td id="T_fd4ba002_23f4_11eb_82c7_472f2f362698row7_col3" class="data row7 col3" >11.83 %</td>
                        <td id="T_fd4ba002_23f4_11eb_82c7_472f2f362698row7_col4" class="data row7 col4" >8.33 %</td>
                        <td id="T_fd4ba002_23f4_11eb_82c7_472f2f362698row7_col5" class="data row7 col5" >22.27 %</td>
                        <td id="T_fd4ba002_23f4_11eb_82c7_472f2f362698row7_col6" class="data row7 col6" >13.61 %</td>
                        <td id="T_fd4ba002_23f4_11eb_82c7_472f2f362698row7_col7" class="data row7 col7" >8.60 %</td>
            </tr>
            <tr>
                        <th id="T_fd4ba002_23f4_11eb_82c7_472f2f362698level0_row8" class="row_heading level0 row8" >Suyama</th>
                        <td id="T_fd4ba002_23f4_11eb_82c7_472f2f362698row8_col0" class="data row8 col0" >15.63 %</td>
                        <td id="T_fd4ba002_23f4_11eb_82c7_472f2f362698row8_col1" class="data row8 col1" >9.52 %</td>
                        <td id="T_fd4ba002_23f4_11eb_82c7_472f2f362698row8_col2" class="data row8 col2" >10.36 %</td>
                        <td id="T_fd4ba002_23f4_11eb_82c7_472f2f362698row8_col3" class="data row8 col3" >11.86 %</td>
                        <td id="T_fd4ba002_23f4_11eb_82c7_472f2f362698row8_col4" class="data row8 col4" >8.34 %</td>
                        <td id="T_fd4ba002_23f4_11eb_82c7_472f2f362698row8_col5" class="data row8 col5" >22.40 %</td>
                        <td id="T_fd4ba002_23f4_11eb_82c7_472f2f362698row8_col6" class="data row8 col6" >13.38 %</td>
                        <td id="T_fd4ba002_23f4_11eb_82c7_472f2f362698row8_col7" class="data row8 col7" >8.52 %</td>
            </tr>
    </tbody></table></div></div>
</div>
</section>
<section id="other-sources-of-accounting-data">
<h2><span class="section-number">5.4. </span>Other sources of accounting data<a class="headerlink" href="#other-sources-of-accounting-data" title="Permalink to this heading">#</a></h2>
<p>Google Dataset Search is an excellent source of datasets, including interesting accounting datasets: <a class="reference external" href="https://datasetsearch.research.google.com/">datasetsearch.research.google.com/</a></p>
<p>Quandl is another interesting source of data. They have some free datasets, but you need to register to get an api key before you can download any data. Quandl offers a library that you can use to download datasets directly in Python: <a class="reference external" href="https://www.quandl.com/">www.quandl.com/</a></p>
<section id="pandas-datareader">
<h3><span class="section-number">5.4.1. </span>Pandas Datareader<a class="headerlink" href="#pandas-datareader" title="Permalink to this heading">#</a></h3>
<p>Pandas Datareader is a library that can be used to download external datasets to Pandas dataframes. <a class="reference external" href="https://pandas-datareader.readthedocs.io/en/latest/">pandas-datareader.readthedocs.io/en/latest/</a></p>
<p>Currently, the following sources are supported in Pandas Datareader</p>
<ul class="simple">
<li><p>Tiingo</p></li>
<li><p>IEX</p></li>
<li><p>Alpha Vantage</p></li>
<li><p>Enigma</p></li>
<li><p>EconDB</p></li>
<li><p>Quandl</p></li>
<li><p>St.Louis FED (FRED)</p></li>
<li><p>Kenneth French’s data library</p></li>
<li><p>World Bank</p></li>
<li><p>OECD</p></li>
<li><p>Eurostat</p></li>
<li><p>Thrift Savings Plan</p></li>
<li><p>Nasdaq Trader symbol definitions</p></li>
<li><p>Stooq</p></li>
<li><p>MOEX</p></li>
<li><p>Naver Finance</p></li>
</ul>
<p>For most of these, free registration is required to get an API key.</p>
<p>You need to install Datareader first. It is included in Anaconda and can also be installed with Pip using a command <strong>pip install pandas-datareader</strong>.</p>
<p>Let’s import the library</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas_datareader</span> <span class="k">as</span> <span class="nn">pdr</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s use in our example EconDB (<a class="reference external" href="https://www.econdb.com/">www.econdb.com/</a>). In the following code, we load the quarterly values of Finland’s gross domectic product from the year 1999 to the most recent value.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pdr</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataReader</span><span class="p">(</span><span class="s1">&#39;ticker=RGDPFI&#39;</span><span class="p">,</span><span class="s1">&#39;econdb&#39;</span><span class="p">,</span><span class="n">start</span><span class="o">=</span><span class="mi">1999</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>It returns a Pandas dataframe, to which we can apply all the Pandas functions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/8c8b779eb0abe35dd52bb4984d33d8b9ccf75edb312a1506ba8fae7f09c3c32c.png" src="_images/8c8b779eb0abe35dd52bb4984d33d8b9ccf75edb312a1506ba8fae7f09c3c32c.png" />
</div>
</div>
<p>Fama/French data library is also very interesting for accounting research. <a class="reference external" href="http://mba.tuck.dartmouth.edu/pages/faculty/ken.french/data_library.html">mba.tuck.dartmouth.edu/pages/faculty/ken.french/data_library.html</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas_datareader.famafrench</span> <span class="k">as</span> <span class="nn">fama</span>
</pre></div>
</div>
</div>
</div>
<p>There are 297 datasets available.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">fama</span><span class="o">.</span><span class="n">get_available_datasets</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>297
</pre></div>
</div>
</div>
</div>
<p>Let’s load an industry portfolio return data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data2</span> <span class="o">=</span> <span class="n">pdr</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataReader</span><span class="p">(</span><span class="s1">&#39;10_Industry_Portfolios&#39;</span><span class="p">,</span> <span class="s1">&#39;famafrench&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>This time, it returns a dictionary. The items of the dictionary are dataframes with different data. <strong>DESCR</strong> can be used to get information about the data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">data2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>dict
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data2</span><span class="p">[</span><span class="s1">&#39;DESCR&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;10 Industry Portfolios\n----------------------\n\nThis file was created by CMPT_IND_RETS using the 202009 CRSP database. It contains value- and equal-weighted returns for 10 industry portfolios. The portfolios are constructed at the end of June. The annual returns are from January to December. Missing data are indicated by -99.99 or -999. Copyright 2020 Kenneth R. French\n\n  0 : Average Value Weighted Returns -- Monthly (59 rows x 10 cols)\n  1 : Average Equal Weighted Returns -- Monthly (59 rows x 10 cols)\n  2 : Average Value Weighted Returns -- Annual (5 rows x 10 cols)\n  3 : Average Equal Weighted Returns -- Annual (5 rows x 10 cols)\n  4 : Number of Firms in Portfolios (59 rows x 10 cols)\n  5 : Average Firm Size (59 rows x 10 cols)\n  6 : Sum of BE / Sum of ME (6 rows x 10 cols)\n  7 : Value-Weighted Average of BE/ME (6 rows x 10 cols)&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:xlabel=&#39;Date&#39;&gt;
</pre></div>
</div>
<img alt="_images/b1c13bea2aa29c590ed40c0e9c6cd3732f0252a6da83f38beecb14cba1fcf6f7.png" src="_images/b1c13bea2aa29c590ed40c0e9c6cd3732f0252a6da83f38beecb14cba1fcf6f7.png" />
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="3_Pandas_data_preprocessing.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">4. </span>Pandas Data preprocessing</p>
      </div>
    </a>
    <a class="right-next"
       href="5_Visualisation_with_Python.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">6. </span>Visualisations with Python</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#power-bi">5.1. Power BI</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mysql-sap-and-others">5.2. MySQL, SAP and others</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sqlite">5.3. Sqlite</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#other-sources-of-accounting-data">5.4. Other sources of accounting data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pandas-datareader">5.4.1. Pandas Datareader</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Mikko Ranta
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=ac02cc09edc035673794"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=ac02cc09edc035673794"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>